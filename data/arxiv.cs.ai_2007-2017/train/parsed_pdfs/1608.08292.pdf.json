{
  "name" : "1608.08292.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Robust Energy Storage Scheduling for Imbalance Reduction of Strategically Formed Energy Balancing Groups",
    "authors" : [ "Shantanu Chakrabortya", "Toshiya Okabe" ],
    "emails" : [ "s-chakraborty@cp.jp.nec.com" ],
    "sections" : [ {
      "heading" : null,
      "text" : "Imbalance (on-line energy gap between contracted supply and actual demand, and associated cost) reduction is going to be a crucial service for a Power Producer and Supplier (PPS) in the deregulated energy market. PPS requires forward market interactions to procure energy as precisely as possible in order to reduce imbalance energy. This paper presents, 1) (off-line) an effective demand aggregation based strategy for creating a number of balancing groups that leads to higher predictability of group-wise aggregated demand, 2) (on-line) a robust energy storage scheduling that minimizes the imbalance for a particular balancing group considering the demand prediction uncertainty. The group formation is performed by a Probabilistic Programming approach using Bayesian Markov Chain Monte Carlo (MCMC) method after applied on the historical demand statistics. Apart from the group formation, the aggregation strategy (with the help of Bayesian Inference) also clears out the upper-limit of the required storage capacity for a formed group, fraction of which is to be utilized in on-line operation. For on-line operation, a robust energy storage scheduling method is proposed that minimizes expected imbalance energy and cost (a non-linear function of imbalance energy) while incorporating the demand uncertainty of a particular group. The proposed methods are applied on the real apartment buildings’ demand data in Tokyo, Japan. Simulation results are presented to verify the effectiveness of the proposed methods.\nKeywords: Robust Energy Storage Scheduling, Balancing Groups, Stochastic Optimization, Mixed Integer Linear Programming, On-line Resource Scheduling, Bayesian Markov Chain Monte Carlo.\n∗Corresponding author Email address: s-chakraborty@cp.jp.nec.com (Shantanu Chakraborty)\nPreprint submitted to arxiv September 3, 2016\nar X\niv :1\n60 8.\n08 29\n2v 1\n[ cs\n.S Y\n] 3\n0 A"
    }, {
      "heading" : "1. Introduction",
      "text" : "The number of Power Producer and Supplier (PPS) in the power and energy market is increasing rapidly due to the liberalization in power market in Japan [1]. With the increase in market share of PPSs, the potential of demand-centric business opportunity increases. As of 2014, the electricity market in Japan is dominated by regional monopolies, where 85% of the installed generating capacity is produced by 10 privately owned companies. However, the rising of Power Producer and Supplier (PPS) (i.e. Electric Power Retailer) in the electricity market is inevitable due to the full-fledged deregulation [1] that will eventually break the monopolies. PPPs face challenge while keeping the on-line supply and demand matched with the highest precision, and thus reducing the imbalance (gap between contracted supply and demand) in demand side low-voltage network. In off-line, the PPS can intelligently group the customers to increase the demand predictability of each group and procures volume of energy (utilizing day-ahead energy prediction). The procured energy refers as the supply contract for each group. Flexible power distribution as such is attainable through Digital grid architecture [2]. In ideal world, the contracted supply matches with actual demand at each granular (typically, 30-minutes). However, due to the uncertainty in on-line energy consumption as well as energy supply, the gap between supply and demand is highly likely to occur. The current practice is to buy (in case of demand is higher than the supply) or sell (in case of supply is higher than the demand) energy from/to Energy Imbalance Market (EIM) (EIM can be a part of Utility or be an independent body or the Utility itself, [3]). The EIM mitigates such mismatch between on-line supply and demand by transacting necessary energy with the PPS. The involvement of EIM goes higher with the increasing gap between the supply and the demand. The price setting of EIM, on the other hand, is significantly higher compared to the conventional energy tariff ([3], page 4). Therefore, the reduction of imbalance cost casts itself as one of the important problems to tackle for demand side based energy service of PPS.\nTwo fundamental yet interconnected problems are, therefore, identified for a PPS, 1) strategic demand aggregation for balancing group creation, and 2) on-line imbalance energy and cost reduction for formed balancing groups. A PPS serves multiple commercial settings (e.g. apartment buildings, commercial buildings, shopping mall, factory, etc.). Therefore, it is essential for the PPS to effectively and strategically identify the customers’ demand based grouping for energy balancing purpose, i.e. balancing group. Groupings as such are also necessary for service and price differentiations. In case of the imbalance energy reduction service, it is critically important for the PPS to define appropriate demand aggregation criterion and demand aggregation strategy so that it can effectively identify clusters of similar customers (e.g. buildings), the associated aggregated demand with reduced variance and potential imbalance energy bound. In this paper, we present a probabilistic programming [4] approach that utilizes a Bayesian Markov Chain Monte Carlo (MCMC) sampling method [5] [6] in order to form multiple balancing groups. Initially, a demand aggregation\ncriterion is identified as a statistical observation, then a probabilistic model of the observation is devised and finally posteriors of the model parameters are determined through Bayesian MCMC. The process is recursively conducted, which divides a parent observation into two based on the posterior analysis of the model parameters. Therefore, a divide-and-conquer approach is designed to solve balancing group formation problem.\nAs for the on-line operation, the reduction of the group-wise imbalance cost can be realized by the effective on-line energy storage management; more particularly, the on-line charge/discharge (CD) scheduling of energy storage. However, since the imbalance energy tariff is non-linear to the imbalance energy, typical straight-forward method of CD scheduling leads to an inefficient solution. Therefore, we present an efficient CD scheduling for multiple spatially distributed energy storages where the schedule is robust against demand prediction uncertainty. The robust scheduling method essentially minimizes the expected imbalance energy and imbalance cost considering a number of demand prediction scenarios. Battery storage system is utilized as the energy storage system. The designed scheduling approach first performs a short-term demand prediction, then generates a number of statistical scenarios of the predicted demands utilizing a joint distribution of probability density function (PDF) of prediction error with the PDF of variability of preceding periods; and finally solves a multi-objective optimization problem that decides the CD scheduling (with power dispatch) of batteries while minimizing both imbalance energy and cost. The required aggregated battery power-rating information is drawn from the posterior distribution knowledge that had been conducted while forming groups. The problem in hand is non-linear due to the imbalance pricing scheme, storage dynamics and associated non-linear constraints. The optimization problem is, therefore, transformed into an equivalent Mixed Integer Linear Programming (MILP) problem [7] followed by an additional transformation to Mixed Logical Dynamical (MLD) System [8], and finally solved by a branch-and-cut linear solver [9]."
    }, {
      "heading" : "1.1. Related Works",
      "text" : "Clustering has been a useful analytical and operational tool in energy domain (e.g. energy market, [10]). Applications of clustering methods in high- and medium-voltage power networks for large scale integration of customers have been reported in articles like [11] and [12]. In [11], a comprehensive overview of clustering methods are presented and the necessity of these methods while identifying effective customer grouping are highlighted (from the perspective of an Energy Supplier). The supervised clustering algorithms (e.g. Hierarchical clustering, K-means, Fuzzy K-means) are discussed [12] that analyzes the similarity within customers. Meanwhile, at the low-voltage network, energy based clustering for planning and operation (from the perspective of market operators such as Distribution Network Operators, DNOs) is reported in [13]. In [13], household smart-meter data are analyzed for demand variability and a finite mixture model based clustering algorithm is proposed that discovers a number of distinctive behavior groups. Therefore, it is evident that clustering methods play\nimportant roles for planning and operation of market operators such as energy suppliers, DNOs and PPSs. We employed a Bayesian inference coupled with MCMC method to determine the energy balancing groups based on a statistical demand measurement. The Bayesian MCMC is chosen over other clustering methods due to its advantages of accounting the uncertainty presented in the models and parameters as well as its ability to present useful insights regarding the model (inferred from the posterior distribution of model’s parameters). For example, the applied Bayesian MCMC method provides an upper-bound of required group-wise energy storage aggregated power-rating (and consequently energy capacity rating).\nFor on-line operation, which requires fast solution, it has been widely advised by the experts to deploy advanced mathematical optimization algorithms that accounts for system uncertainty and predictability of future states or conditions [14]. The working mechanism of the proposed CD scheduling method, therefore, aligns with that of Model Predictive Control (MPC), which measures up to the aforementioned requirements. MPC (and its variants) has been an active research area in the power system arena. In [15], an energy management system for Microgrid operation considering PV, Diesel Generators, and energy storage is presented. A stochastic MPC for solving Unit Commitment with wind power is documented in [16]. Robust scheduling of resources is critically important when the optimization model is exposed to various uncertainties presented in the model states. For example, in [17], a robust cost optimization method is presented that essentially schedules of renewable energy generators with combined heat and power (CHP) generators considering the uncertainty in net energy demand and electricity price. Another stream of research has been conducted on stochastic MPC considering the uncertainty in the model. For example, in [18], a stochastic MPC is presented for efficient controlling in building’s HVAC system while focusing on energy minimization. On the other hand, MILP based mathematical optimization is the current industry trend of operation research oriented towards resource scheduling and optimization. For instance, in the arena of Unit Commitment (one of the important problems in Power System Planning and Operation), MILP provides efficient, fast and scalable solutions [19] [20]. These outstanding researches create platform for applying robust MILP based optimization algorithm, which minimizes the expected imbalance energy and cost over a set predicted demand scenarios, as a core optimizer of the proposed on-line CD scheduling method."
    }, {
      "heading" : "2. Forming Energy Balancing Groups",
      "text" : "An energy balancing group contains a number of customers1 sharing similarity in their demand profiles where their aggregated demand profile exhibits higher predictability. It is, therefore, essential to identify appropriate criterion\n1Being specific to this manuscript, the customers are the apartments buildings (or simply buildings).\nbased on which such aggregation and group formation will be performed. The following is one such criterion.\n2.0.1. Maximum Demand Standard Deviation of Periodic Demand\nThis measure is defined as the maximum of demand standard deviation (DSD), MDSD of a particular customer. The DSD tells how the demand of a particular period deviates from the average demand of that period over a range of sampling days. For example, if the demand is sampled over January (containing 31 days), the DSD of 10 AM is the statistical standard deviation over all the demands at 10AM accumulated in January. The MDSD is thus defined as the following\nMDSD = max {σt(Di(t))} . (1)\nwhere t = 1, ..., N (N is the number of periods in a day, e.g. N = 48 for a day of 30-minutes granularity) and i = 1, ..., ND (ND is the total number of sampling days). MDSD is an absolute (demand) measure that stems from the in-period demand variations over different days.\nFrom a PPS’s perspective, the customers that lower the accumulatedMDSD are desirable, since those customers have similarities in demand pattern as well as higher predictability in their aggregated demand2. MDSDc is, therefore, identified as the demand aggregation criterion DACc, for a particular customer c. MDSD is considered to be an extremely important criterion since it can provide insights regarding potential imbalance that might occur in real-time. More specifically, MDSD says about the worst deviation (from the average demand) that likely to occur over a particular day, consequently, the maximum power required to nullify the deviation. As batteries are deployed to countermeasure the imbalance, certain insights regarding the required battery power is essential. Therefore, MDSD seems to be a better choice over other criteria as far as imbalance reduction is concerned. Other criteria, such as medians of daily load factor, total periodical demand, daily average demand, etc. could also be utilized (either stand-alone or in combination) as DACc depending on the goal of the design. In this paper, therefore, we limit the DAC only to MDSD."
    }, {
      "heading" : "2.1. Demand Aggregation Strategy",
      "text" : "The demand aggregation strategy performs a demand grouping scheme that provides several effective balancing groups of customers. The strategy first determines the DACs for all customers using their historical demand profiles. The strategy then applies a divide and conquer algorithm that recursively utilizes a Probabilistic Programming on the DACs. The Bayesian MCMC sampling method is chosen as the Probabilistic Programming. The Probabilistic Programming approach basically designs a probabilistic model for observing the DACs (referred as observation) by utilizing statistical knowledge regarding model parameters (such as, when and how the observation changes with the arrival of new\n2So called Laws of Large Numbers.\ncustomer), represented by associated probability distributions and later utilizes Bayesian inference to generate posterior distributions of the model parameters (by sampling through MCMC).\nFigure 1: Flow-chart of a divide and conquer based group formation (demand aggregation strategy).\nFigure 2: Flow-chart of the Bayesian MCMC sampling method generating posterior distributions of the model parameters.\nThe process of Demand Aggregation Strategy (i.e. demand based energy balancing group formation) is depicted in Figure 1. In the flowchart, NC is number of individual customers. Note that, the method divides a group into two and recursively solves the sub-group formation problem. The output of the process is a list of group information where each item in the list represents the range of the group (start and end). In detail, as depicted in Fig 1, the customers are organized in ascending order according to their DACs. The initial balancing group contains all of the customers (i.e. a single group). The initial observation contains the DAC values of all customers. The next step is to build the probabilistic model and use Bayesian MCMC sampling method to generate posterior distributions of model parameters. Fig 2 shows the flow-chart of the group partition process. Basically, the observation is where the model trying to fit-in by varying the model parameters. At first the hyper-parameter (the parameter that controls the other parameters) α is determined. The parameter α (Eq. 2, where NO is number of observations) is set as the inverse of the expected observations and is used to parameterize the prior distributions of λ1 and λ2 (Eq. 3). What follows are the key features of the process.\n1. Uniform distribution for the articulated customers3; parameter, τ (Eq. 4).\n2. Exponential Distributions of DAC before and after the articulated customers; parameters, λ1 and λ2; which in turn parameterized by α (Eq 3).\n3. λ is formed deterministically by combining λ1 and λ2 where the merging point is determined by distribution τ and customer identifier c (Eq. 5).\n4. The DAC values are hypothesized by a Poisson Distribution4 with λ as expected value (Eq. 6).\nFigure 3: Model parameters and internal dependencies.\n3The term “articulated customers” is defined as the customers whose DAC differs ‘significantly’ with the same of preceding customers when the customers are ordered ascending-ly according to their DACs. In other words, an articulated customer defines the boundary of potential energy balancing groups. Every customer is equally likely to be an articulated customer (prior belief; before an observation of DAC is made). Therefore, the probability (parameter τ) of a particular customer to be an articulated customer is uniformly distributed over the number of customers\n4The distribution of DAC is chosen to be a Poisson Distribution, since the DAC of a customer is independent of each other and can be treated as a form of count data occurred in a discrete time event.\nThe probabilistic model with parameters and dependencies is plotted in Figure 3. The following equations mathematically show the definitions of distributions and associated parameters.\nα =\n[ 1\nNO E∑ c=S DACc\n]−1 (2)\nλ1 ∼ Exp(α) (3) λ2 ∼ Exp(α)\nτ ∼ DiscreteUniform(1, NO) (4)\nλ = { λ1 if c ≤ τ λ2 if c > τ\n(5)\nDACc ∼ Poisson(λ) (6)\nEDACc = 1\nNO ∑ ∀τi>c λ1,i + ∑ ∀τj≤c λ2,j  (7) ∆dac = β ×\nEDACE EDACS\n(8)\nUtilizing Bayesian MCMC method, the created probabilistic model is conditioned to fit the observed DAC into a Poisson Distribution. The posterior distributions of the model parameters (τ and λs) are resulted from the method. The process (Fig 2), after determining the posterior distributions of the statistical parameters, calculates the expected DAC (EDAC), according to Eq. 7. The group partition criteria is then determined by the change in DAC (∆DAC , Eq. 8). The group formation method (Fig 1) utilizes ∆DAC (with a threshold T ) to divide a single group into two and recursively works on each of the groups to identify a number of energy balancing groups. The MCMC process utilizes the Metropolis-Hastings algorithm [5] [6] while fitting the probabilistic model to the target distribution (i.e. observation). The details of the algorithm and underlying theory can be found at [6]."
    }, {
      "heading" : "3. On-line Storage Scheduling for Imbalance Reduction",
      "text" : "In this section, an on-line stochastic scenario based robust storage scheduling method is proposed that reduces the imbalance energy and imbalance cost of a particular balancing group. Even, the balancing groups are formed strategically in order to maximize the aggregated demand predictability (which is utilized\nin the forward and day-ahead market to determine supply contract), in realtime, the imbalance of energy is still inevitable due to the prediction error. The PPS, therefore, interacts with the Energy Imbalance Market (EIM) to nullify the imbalance (by purchasing in case of demand is higher than the contracted supply or by selling otherwise). The price setting of EIM is considerably higher compared with conventional energy tariff. Exemplary imbalance pricing scheme is shown in Figure 4 [3]. The pricing scheme follows a nonlinear curve where a higher penalty has to be paid by PPS if the imbalance energy goes beyond a threshold (in Fig. 4 the threshold is set as 50kWh), in case of buying from EIM. On the other hand, PPS will receive no additional revenue if the energy to be sold is higher than the threshold (-50kWh). The threshold is set as 3% of the monthly peak supply, according to [3].\nFigure 4: Non-linear convex imbalance pricing scheme. Therefore, reducing imbalance energy and cost are narrowed down to optimizing the non-linear convex imbalance pricing curve by controlling storage charge/discharge power. To this end, we propose a stochastic sliding window based charge/discharge (CD) algorithm (that is designed based on the concept of MPC), which will reduce the imbalance energy (with imbalance cost) by intelligently charging/discharging spatially distributed energy storages (e.g. battery). We refer the method as Stochastic Sliding Window based CD algorithm (S-SWCD). The system outline for S-SWCD is described in Figure 5. The system receives (at a particular period t) contracted supply for a short window (let’s say for next w periods), aggregated demand of recent past, and current measured status of the batteries (state-of-charge, SOC) and produces an optimal CD schedule for a number of batteries that eventually reduce the imbalance energy and imbalance cost and are robust against the demand uncertainty. The Optimization Module consists of an MILP solver that is responsible for producing robust CD scheduling after minimizing the expected imbalance energy and imbalance cost. Although, the module produces CD scheduling for the next w periods, only the 1st CD schedule (which is for period t) is applied to the battery system and the rest of the schedules are discarded. S-SWCD provides a closed loop solution since a feedback policy is implemented to compensate the demand variability and uncertainty. The subsequent sections will describe the components of the system.\nFigure 5: Outline of S-SWCD algorithm with components."
    }, {
      "heading" : "3.1. Short-term Demand Predictor",
      "text" : "A Support Vector Machine (SVM) [21] based time series prediction methodology is applied in order to predict the demand by utilizing the historic demand information. The demand signal is a time series, which follows a certain trend line (regulated by e.g. periods, weekdays, holidays, etc.). SVM finds optimal regression (Support Vector Regression, SVR) models while minimizing the training error and model complexity. The developed SVR based demand prediction engine models the (recent) past demand patterns to predict demand for a short window (for a window size of w, typically for next 4-hours). At a certain pe-\nriod t, the predictor produces the estimated demand D̃mt to D̃mt+w−1 using\nthe historical demand till t − 1. This expression can be written as D̃mt+i|t−1, i = 0, ..., w − 1. The predictor creates w separate models for each of the lagged periods. For example, while predicting demand D̃mt|t−1, SVR engine creates and trains the model (of lag 1) by fitting a particular demand Dmi with a nonlinear mapping of its previous demands, starting from demand at t− 1 down to demand at a particular training horizon. Note that, the training data set only considers the recent demand set (instead of the whole data set) to avoid overtraining the model by seasonally differed demand data. SVR tries to generate the non-linear model as the following function f lmodel for lag l (l = 0, ..., w− 1),\nf lmodel : [Dmi−l−1, Dmi−l−2, ..., Dmi−NP−1, Fi] 7→ Dmi (9)\nwhere i = t− TH − 1, ..., t− 1, TH is the training horizon, NP is the number of past periods, Fi is additional feature vector containing influential temporal information such as, holiday/weekend indicator, time of the day, and day of the week. The radial basis function is used as SVM kernel that transforms the data into a higher dimensional space while performing the regression. The hyper-parameters for creating the appropriate model are fixed by performing appropriate number of cross-validations within fractions of training data (socalled through grid-search).\nHowever, the predicted demand for a particular period tends to change due to uncertainty. For example, D̃mt+2|t is not necessarily similar to D̃mt+2|t+1. That is, the predicted demand at 12:00 when predicting at 11:00 is not necessarily same as when predicting at 11:30. Which is why, a deterministic objective function is not capable of handling the uncertainty imposed by the demand predictor. Therefore, a stochastic scenario based optimization approach is undertaken that minimizes the expected imbalance energy and imbalance cost. The next section focuses on the Scenario Generator."
    }, {
      "heading" : "3.2. Scenario Generator",
      "text" : "A scenario, in this context, is actually a randomized snapshot of a predicted demand signal. The scenario is generated by utilizing the demand prediction error information coupled with the variability from the demand of preceding period. The system gradually learns the prediction errors (that are realized so far) for each of the lagged periods, l and determines the probability density function, PDF of the prediction error. The PDF of the prediction errors is a Gaussian Distribution with almost zero mean and a specific standard deviation (let’s call it the error PDF ; N (µl, σl)). On the other hand, the PDF of the demand variability from the preceding period follows the Gaussian Distribution as well, as shown in Figure 6 (let’s call it the variability PDF; N (µp, σp)). Therefore, the predicted demand scenarios are generated by collecting samples in a Bivariate Gaussian Distribution of error PDF and variability PDF. There are several ways to generate statistical scenarios, such as utilizing nonlinear programming for multi-stage decision problem [22]). However, sophisticated method as as requires higher computational power which goes against the speed requirement for an on-line operation. Therefore, we adopted a simpler yet effective ways to\ngenerate scenarios. Initially, a large scenario space is generated utilizing the aforementioned Bivariate Gaussian Distribution. The distribution is shown in the following equation\ndl(s ∈ S) ∼ N (µ,Σ) (10)\nwhere µ contains the 2D-vector of means containing the µl and µp, and Σ is the covariance matrix containing the variances, shown as\nΣ =\n[ σ2l σ 2 p\nσ2p σ 2 l\n] (11)\nTherefore, the predicted demand for scenario s ∈ S is determined as following\nD̃mt+l|t−1,s = D̃mt+l|t−1 + dl(s) (12)\nFigure 6: Distribution of demand variability from preceding period with PDF.\nwhere D̃mt+l|t−1,s is the predicted demand scenario for lag l and D̃mt+l|t−1 is the predicted demand (from Demand Predictor module) at period t+ l, predicted at period t − 1. However, the scenario space too large to be integrated into the optimization. Therefore, the space must be reduced (the so-called scenario reduction). The reduction process is conducted by taking a subset of the scenario space, S ⊂ S. The elements D̃mt+l|t−1,s for s ∈ S are chosen by considering the sum-of-squared distance from the baseline predicted demand signals, D̃mt+l|t−1. Figure 7 shows a case of scenario generation for a particular predicted demand signal (considering w = 8, number of scenarios = 57 and a 30-minutes granularity) with associated scenario space.\nFigure 7: Scenario generation (of 57 scenarios out of a scenario space of 5000 scenarios) for window size 8."
    }, {
      "heading" : "3.3. Optimization Module",
      "text" : "The optimization module reduces the imbalance energy and imbalance cost for a particular window (utilizing the predicted demand signals and scenarios) while deciding the storage charge/discharge schedule and associated power dispatch. The module however, utilizes the decision regarding CD schedule and dispatch for the current period while discarding the rest. At the next cycle, the module slides the window one time step and repeats the process (so called, closed-loop system)."
    }, {
      "heading" : "3.3.1. Objective Function with Constraints",
      "text" : "The problem is a multi-objective (due to imbalance energy and imbalance cost minimization) and stochastic optimization problem. The imbalance energy and imbalance cost need to be optimized separately due to non-linearity in the cost function (Figure 4). The scalarized version of the stochastic optimization problem is described in Eq. 13. The 1st part of the objective function describes the absolute reduction of imbalance energy (weighted by c0) while the 2nd part is about reduction of associated imbalance cost (weighted by c1). Utilizing only\nimbalance cost as the objective will make the PPS intentionally increase the imbalance energy (by deliberately charging the battery up) so that it can sell the energy in later time, thereby, staying at the left side of the imbalance pricing curve. By incorporating the imbalance energy separately and performing the multi-objective optimization (with a small scaler weight given to the imbalance energy reduction), the system sustains a certain regulations on the energy and price trade-off. However, the system can always perform a single objective (only the imbalance cost, for instance) if it is the expected behavior by setting the corresponding weight as zero.\nminimize Xi,b,Pi,b\nE[FC(X,P )]\n:= ∑ s∈S Pr(s)×  c0 × t+w−1∑ i=t |Imi,s|+\nc1 × t+w−1∑ i=t IC(Imi,s)\n (13)\nwhere FC is the cost function comprising the weighted imbalance energy and cost, S is the predicted demand scenario set and Pr(s) is the probability assigned to scenario s (is set as 1/|S|). The imbalance energy for a scenario s ∈ S is formulated as (Eq. 14).\nImi,s = Spi − D̃mi,s − ∑ b∈B Pi,b (14)\nwhere Spi is the contracted supply at period i and D̃mi,s is the predicted demand at period i for scenario s. The imbalance cost function, IC is a convex and non-linear function that can be presented by Figure 4. The IC contains both cost part (when demand is higher than the supply) and revenue part (when supply is higher than the demand). Pi,b is the power dispatch (+ve for charging, -ve for discharging) from/to a battery b over a set of batteries B. The storage dynamics are presented as the following constraint.\nXi,b = Xi−1,b + ηb × Pi,b (15) Xb,min ≤ Xi,b ≤ Xb,max (16)\n−pd,b ≤ Pi,b ≤ pc,b (17)\nEq. 13 is the discrete time energy status (state-of-charge, SOC) of b at period i (considering ∆t = 15), where the efficiency ηb is composed of charging efficiency ηcb and discharging efficiency η d b (as shown in Eq. 18).\nηb =\n{ ηcb , if Pi,b ≥ 0\n1/ηdb , otherwise (18)\n5thereby making Pi,b as energy dispatch at period i (done for simplification)\nEq. 14 bounds the SOC within a particular limit while Eq. 15 shows the power charging/discharging limit (pc,b and pd,b, respectively). Due to the non-linearity in objective function (Eq. 13) and constraints (e.g. conditional CD efficiency at Eq. 18), the optimization problem needs to be (equivalently) transformed into an MILP problem. The section to come describes the equivalent MILP formation of the above optimization problem."
    }, {
      "heading" : "3.3.2. MILP Transformation",
      "text" : "In this section, the transformation of objective function (Eq. 13) and constraints to facilitate MILP formulations are presented. The storage dynamics appeared in Eq. (13-15) can be effectively transformed into a linear formulation by introducing the following additional variables\nSi,b = { 1 if Pi,b ≥ 0 0 otherwise\n(19)\nAxi,b = Si,b × Pi,b (20)\nTherefore, utilizing MLD system formulation of converting logical dynamics to MILP [8], the storage SOC dynamics can be transformed to\nXi,b = Xi−1,b + (η c b − 1/ηdb )×Axi,b − 1/ηdb × Pbi,b (21)\nThe non-linear logical constraints in Eq. (17-18) are equivalently casted to linear constraints [7] and handled together with charging/discharging power limit of storage (Eq. 15). The followings shows the casted linear equations.\npd,b × Si,b − Pi,b − pd,b ≤ 0 (22) −pd,b × Si,b + Pi,b ≤ 0 (23)\npd,b × Si,b +Axi,b − Pi,b − pd,b ≤ 0 (24) pd,b × Si,b −Axi,b + Pi,b − pd,b ≤ 0 (25)\n−pc,b × Si,b +Axi,b ≤ 0 (26) −pc,b × Si,b −Axi,b ≤ 0 (27)\nThe non-linear and convex cost function requires to be linearized to be fitted into the MILP formulation. The transformation is conducted by introducing additional mixed-integer variables. For the sake of simplicity, we remove the scenario s notation of original equations. The imbalance cost is equivalently transformed into a segmented combination of sub-costs (for a particular period i, as shown in below)\nICi = IC(Imib) = NPS∑ k=1 PSk × Zi,k (28)\nwhere PSk, k = 1, ..., NPS is the k-th imbalance unit price and NPS is the number of price segments6. The imbalance energy is constrained to be the sum\n6As of Figure 4, the pricing scheme has 4 unit price segments activated by an energy threshold (i.e. ±50 kWh). There, PS1 = 45.7, PS2 = 15.0, PS3 = 10.48, and PS4 = 0\nof segmented energies, i.e.\nImi = NPS∑ k=1 Zi,k (29)\nThe activation of Zi,k is controlled by binary variables Y . Considering Th (as imbalance energy threshold, e.g. 50 kWh as of Figure 4), a big number M = 1e+7 and NPS = 4; the following constraints are added to the formulation as a measure of activating appropriate Zi,k (avoiding the subscript i)\n(Th−M)× Y1 ≤ Z1 ≤ (Th−M)× Y0 −Th ≤ Z2\nTh× Y3 ≤ Z3 ≤ Th× Y2 0 ≤ Z4 ≤M × Y3\nNote that, the above equations can be generalized to work with any value of NPS. Some additional constraints are required to limit the activation in one of the halves of the pricing curve. The absolute value in the imbalance energy in Eq. 13 is transformed into an equivalent function by introducing the lower- and upper-bound variables (since absolute value imposes non-linearity and cannot be readily solvable by MILP)."
    }, {
      "heading" : "4. Numerical Simulations and Discussions",
      "text" : "This section presents the numerical simulations, analysis, results and discussions associated with formation of balancing groups and robust CD scheduling. A total of 103 apartments building in Tokyo are taken as customers and their demand data are utilized for the analysis. More particularly, the demand data of January and February, 2013 are taken and broken down to two phases\n1. Analysis and training phase: Data from January 1st to January 20th are utilized to perform the balancing group formation and train the initial prediction (SVR) model.\n2. Optimization and simulation phase: Data from January 21st to February 28th are utilized to perform simulation regarding robust and on-line CD scheduling. Note that, although the initial SVR model is trained utilizing demand data from Jan. 1st to Jan. 20th (i.e. 20 days), the SVR model is kept updated using the immediate past 20-days demand data (from the simulation day). For example, while performing simulation for Jan. 25th, the demand data from Jan. 5th to Jan. 24th are utilized.\nThe algorithms are implemented in Python programming language. The Bayesian MCMC based group formation algorithm is implemented in conjunction with PyMC package [23], an open-source Python package to perform Bayesian\n(JPY/kWh)[3].\nanalysis. The open-source solver [9] is used to solve the MILP in robust CD scheduling."
    }, {
      "heading" : "4.1. Formation of Balancing Groups",
      "text" : "The 1st part of this section describes the analysis and results regarding energy balancing group formation. The demand data has a 30-minutes granularity. The MDSD (i.e. DAC) of each customer are determined according to Eq. 1 considering demands from January 1st, 2013 to January 20th, 2013.\nFigure 8: Divide-and-conquer process of group formation: Status of dacVector.\nThe divide-and-conquer process of group formation with associated dacV ector (Figure 1) range is shown in Figure 8. The corresponding articulated customers at each stage of division are also pointed out in the figure. For example, initially the dacV ector contains customers from 1 to 103, [1, 103]. After performing the Bayesian MCMC sampling method on dacV ector, customer 84 is selected as articulated customer (AC) and hence serves as the dividing point (1st Phase). The posterior distributions of the model parameters τ and λs at 1st Phase are plotted in Figure 9. The distributions of τ identifies customer 84 as AC since it is highly likely to be one. Note that, the prior of τ was a uniform distribution, which is changed after performing the Bayesian MCMC sampling process and provides a posterior that correctly maps to the target true distribution (i.e. observation). The distributions of DACs (i.e. λs, before and after τ , respectively) are shown in the figure as well. Although, the λs were set as Exponential Distributions as priors, the posteriors come out as Normal Distributions through the Bayesian inference. In the process of MCMC, a total number of 80,000 random samples are generated utilizing the prior distributions of model parameters. Among them 25% of the samples are discarded (so called burn-in [5] of samples since the convergence of the Markov Chain is not fully known) while tracing the posterior samples. Referring back to Figure 8, at the next phase, the dacV ector is divided into two child vectors of [1, 84] and [85, 103], each of which will go through the Bayesian MCMC process.The process is repeated until the vector is not further divisible (i.e. ∆dac is below a point, T ), and thereby forming balancing groups. Finally, the process settles down forming 4 balancing groups.\nFigure 10 shows the result of Bayesian MCMC based demand aggregation and resultant balancing groups (the customers are already ordered according to their DSD). At the same time, the figure points out the expected DSD per customer in a group. For example, Group 1 (G1), that contains 57 customers, has an expected DSD of 7.83kWh per customer. As a by-product of Bayesian MCMC method, the posterior distribution of DSD over the customers in G1 is evaluated, which is also printed in Figure 10 as a Normal Distribution. The periodical (half-hourly) aggregated DSD for each group is shown in Figure 11. Evidently, the Bayesian MCMC based demand aggregation strategy forms groups whose DSDs are close to each other even when the group sizes are different. That establishes the proposed demand aggregation strategy is an effective clustering strategy of relatively heterogeneous demand signals.\nFigure 9: The posterior distributions of τ and λs after performing Bayesian MCMC at 1st Phase .\nFigure 10: Group formation using Bayesian MCMC based aggregation strategy.\nFigure 11: Resultant (periodical) demand standard deviation for each group."
    }, {
      "heading" : "4.2. Robust CD Scheduling of Energy Storage",
      "text" : "At the 2nd part, we will investigate the on-line robust energy storage scheduling (S-SWCD) to reduce imbalance energy and cost for Group 1 (G1). The G1 contains 57 customers. The first 20 days’ (January 1 to 20) demand data is utilized to train the initial demand predictor model, which gives us 38 days (approximately) to perform the on-line CD scheduling algorithm and evaluate the performance. The peak demand (kWh/30-minutes) for the first 20-days is recorded as 2,500kWh/30-minutes.\nIn order to perform the short-term demand prediction, prediction window size, w is set as 8. The initial scenario space, S contains 5000 scenarios. Finally, the number of scenarios in the reduced scenario set, S is set as 57. The values of w and |S| are settled to 8 and 57, respectively based on the sensitivity analysis of these parameters on the imbalance cost reduction while keeping the battery capacity fixed. As an energy storage, Lithium-ion Battery is utilized. The size of the battery (power rating and consequently energy capacity) are determined by analyzing the DAC distribution (e.g. as in Figure 10), since DAC is essentially MDSD which in turn represents the peak potential deviation that requires to be minimized by battery. The expected DAC for G1, 7.83kWh/customer, can be utilized as battery size (that makes an approximated 445kWh of aggregated battery capacity for G1). However, due to higher accuracy in day-ahead prediction, the aggregated DAC (i.e. potential battery capacity) of 445kWh can be treated as an upper-bound. In the experiment, we present the results considering aggregated battery capacity of 320kWh. At the same time, the power rating of the aggregated batteries is considered as 640 kW (i.e. the batteries are of 2E ratings). A total of 50 batteries (of rating 6.4kWh/12.8kW, SOC limit of 1% to 96% and C/D round-trip efficiency of 95%) are assumed to be installed at G1. These batteries are operated and controlled (via PPS’s SCADA system) synchronously. Therefore, the simulations are performed considering aggregated battery capacity and aggregated SOC. We assume a day-ahead prediction error (i.e. the basic imbalance due to deviation between contracted supply and actual demand) Normally Distributed around 0 mean and having 10% (of demand) as a standard deviation. The imbalance energy threshold beyond which the penalty tariff is applied is set as 93kWh (3% of the maximum contracted supply)[3].\nThe performance of SVR based short-term demand predictor is described in Figure 12. The lag-wise error distributions (standard deviations) follow a pattern where the errors are relatively lower in smaller lags. The accumulated error distribution over all lags are depicted in the lower right corner of the figure. The errors are normally distributed (N (−0.59, 125.25kWh)) with a Mean Absolute Percent Error (MAPE) of 6.27%. The prediction accuracy is therefore good enough to be utilized at the on-line optimization. In order to generate\nscenarios, the lag-based error statistics (mean and standard deviation, as of Eq. 12) is utilized. The generated scenarios are referred back to Figure 7.\nFigure 12: Prediction error statistics (lag-based) with combined error distribution.\nFigure 13: Battery CD scheduling with S-SWCD and resultant imbalance energy pattern and cost comparison [1-day].\nFigure 14: Cumulative imbalance cost reduction pattern using S-SWCD with a deterministic equivalent algorithm [accumulated over 38-days].\nThe half-hourly battery scheduling, imbalance energy reduction, and imbalance cost reduction patterns (operated for 1-day) utilizing S-SWCD method (with aggregated battery capacity of 320kWh) are plotted in Figure 13. The battery CD schedule with power dispatch (-ve for discharge and +ve for charging) and associated SOC is drawn in the top figure. The resultant imbalance (energy) reduction is shown in middle figure. Evidently, the S-SWCD tries to keep the imbalance energy within the limit of imbalance threshold (i.e. ±93kWh), if not zero, by intelligently scheduling and dispatching the energy from/to the batteries. The consequent (cumulative) imbalance cost reduction pattern (compared to basic imbalance cost without deploying batteries plus S-SWCD) is plotted as the bottom figure. Clearly, the imbalance cost is significantly reduced by applying batteries with S-SWCD controlling algorithm. Note that, at certain period, the cumulative cost goes down because, at that period, PPS makes revenue by selling energy back to EIM (as the supply is higher than the demand).\nThe 38-days imbalance cost reduction pattern is shown in Figure 14. In order to compare the performance of S-SWCD, we have implemented an equivalent intelligent algorithm that utilizes the deterministic (non-stochastic) predicted demand signal (i.e. considering only 1 scenario, which is the predicted signal) and applied the same amount of battery storages (320kWh). As seen in the Figure 14, S-SWCD outperforms its non-stochastic counter part by a good margin (almost 23% reduction in imbalance cost after the end of 38-days). Initially, both of these algorithms attain approximately similar imbalance cost reduction. However, from the periods 1500 onwards, a significant jump in cumulative imbalance cost is experienced by the deterministic algorithm, where the jump in corresponding S-SWCD is relatively lower. Such improvement in S-SWCD is realized by better planning and scheduling of battery storage so that in the critical moments (period 1500 and such) the battery storage is able to deliver appropriate energy that avoids costly EIM interactions. The basic imbalance cost (without battery) for 38-days is reported as 1,852,266 JPY where the cost incurred via S-SWCD is approximately 372,860 JPY (i.e. an 80% reduction in imbalance cost).\nFigure 15: Imbalance cost reduction pattern (via S-SWCD) with increasing battery capacity.\nThe cost reduction, however, depends on the size of battery storage. To this end, Figure 15 is presented to show the effect of storage capacity with imbalance cost reduction (as a percentile of basic imbalance cost incurred without any storage). The figure points interesting insights such as, no matter how large the aggregated capacity is, full reduction of imbalance cost is never pos-\nsible. Moreover, imbalance cost tends to decrease faster with relatively lower battery capacity. A trade-off therefore exists between battery cost and imbalance cost where PPS needs to decide the target line of imbalance cost without investing too much on battery. A target line (of 20% of basic imbalance cost) is drawn to notice the required battery capacity to reach the line. The equivalent curve generated by the deterministic scheduler is plotted to compare with the S-SWCD. S-SWCD requires 320kWh of storage while the deterministic scheduler requires 400kWh (i.e. S-SWCD requires 20% less battery capacity to reach a target of 20% of basic imbalance cost). Depending on the target line settings, the performance of S-SWCD (as far as storage capacity is concerned) varies. For example, S-SWCD takes 14% less battery (compared to the deterministic scheduler) when the target line is set as 30% of the basic imbalance cost.\nFinally, it is worthy to mention that, the energy balancing group formation effectively provides stable grouping, since the MDSD of a customer does not change significantly. Therefore, the group formation can be done in off-line planning stage, which is perfect for a day- or week-ahead energy procurement process. However, in case of significant change in a customer’s MDSD (that results group reformation), certain re-planning might require."
    }, {
      "heading" : "5. Conclusion",
      "text" : "In this paper, we propose novel solution strategies for two of the fundamental yet interconnected problems of PPS. The 1st problem deals with formation of energy based balancing groups within a particular class of customers. In this paper, apartment buildings are taken as customers. To solve the group formation problem, we apply a Bayesian MCMC based divide-and-conquer strategy that takes a statistical measure (periodical demand standard deviation of each customer) and produces a number of balancing groups. The purpose of creating balancing group is to choose similar customers whose aggregated demand has higher predictability, which helps PPS to plan the supply contract. Bayesian MCMC is proven to be an effective aggregation strategy that not only identifies appropriate grouping but also provides important demand centric insights regarding each group (e.g. the upper-bound of required storage capacity for imbalance reduction). However, due to the uncertainty in actual demand, the imbalance occurrence is inevitable. This brings us to the 2nd problem of online imbalance energy and cost reduction on the face of demand uncertainty. We propose a robust on-line CD scheduling for energy storage (batteries) that reduces the expected imbalance energy and cost (solving a multi-objective optimization problem) by incorporating the non-linearity in imbalance tariff, storage dynamics and associated non-linear constraints. The experimental results prove that the proposed scheduling method is robust against demand prediction uncertainty and is capable of lowering imbalance cost with minimized storage capacity. At the same time, we provide insights regarding the trade-off between imbalance reduction and storage capacity which tend to stimulate the investment related issue for a PPS. Although, the problems addressed in this paper focus on Japanese power market, the solutions can be effectively utilized in\nother markets as well by making appropriate assumptions. For example, in Europe, Balance Responsible Parties (BRPs) are market participants, consisting of controllable and uncontrollable generators and loads, that are legally entitled to trade electricity on the various power markets (forward, day-ahead, ancillary services, intra-day, imbalance markets) in order to satisfy loads within their control area, earn profit and contribute to the preservation of power balance in the power grid. Therefore, the proposed methodology can be plugged-in into the European energy market with minimal changes that align with regularity and policy. Possible future research avenue will be analyzing the effects of supply uncertainty as well as dynamic imbalance tariff."
    }, {
      "heading" : "Acknowledgement",
      "text" : "The authors would like to thank Digital Grid Co., Ltd. and the University of Tokyo. This work is a part of collaborative research program with these entities."
    } ],
    "references" : [ {
      "title" : "Energy",
      "author" : [ "A.N. Resources" ],
      "venue" : "Electricity market reform in japan, Tech. rep., Ministry of Economy, Trade and Industry ",
      "citeRegEx" : "1",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Digital grid: Communicative electrical grids of the future",
      "author" : [ "R. Abe", "H. Taoka", "D. McQuilkin" ],
      "venue" : "Smart Grid, IEEE Transactions on 2 (2) ",
      "citeRegEx" : "2",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Electric power industry reform",
      "author" : [ "P. Study-group" ],
      "venue" : "Tech. rep., International Environment and Economy Institute ",
      "citeRegEx" : "3",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "Probabilistic programming",
      "author" : [ "A.D. Gordon", "T.A. Henzinger", "A.V. Nori", "S.K. Rajamani" ],
      "venue" : "in: Proceedings of the on Future of Software Engineering, ACM",
      "citeRegEx" : "4",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Introduction to markov chain monte carlo",
      "author" : [ "C. Geyer" ],
      "venue" : "Handbook of Markov Chain Monte Carlo ",
      "citeRegEx" : "5",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "Bayesian data analysis",
      "author" : [ "A. Gelman", "J.B. Carlin", "H.S. Stern", "D.B. Rubin" ],
      "venue" : "Vol. 2, Taylor & Francis",
      "citeRegEx" : "6",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Convex Optimization",
      "author" : [ "S. Boyd", "L. Vandenberghe" ],
      "venue" : "Cambridge University Press, New York, NY, USA",
      "citeRegEx" : "7",
      "shortCiteRegEx" : null,
      "year" : 2004
    }, {
      "title" : "Control of systems integrating logic",
      "author" : [ "A. Bemporad", "M. Morari" ],
      "venue" : "dynamics, and constraints, Automatica 35 (3) ",
      "citeRegEx" : "8",
      "shortCiteRegEx" : null,
      "year" : 1999
    }, {
      "title" : "Cbc",
      "author" : [ "P. Coin-OR" ],
      "venue" : "coin-or branch and cut ",
      "citeRegEx" : "9",
      "shortCiteRegEx" : null,
      "year" : 2010
    }, {
      "title" : "Dynamic clustering of energy markets: An extended hidden markov approach",
      "author" : [ "J.G. Dias", "S.B. Ramos" ],
      "venue" : "Expert Systems with Applications 41 (17) ",
      "citeRegEx" : "10",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "Overview and performance assessment of the clustering methods for electrical load pattern grouping",
      "author" : [ "G. Chicco" ],
      "venue" : "Energy 42 (1) ",
      "citeRegEx" : "11",
      "shortCiteRegEx" : null,
      "year" : 2012
    }, {
      "title" : "Comparisons among clustering techniques for electricity customer classification",
      "author" : [ "G. Chicco", "R. Napoli", "F. Piglione" ],
      "venue" : "IEEE Transactions on Power Systems 21 (2) ",
      "citeRegEx" : "12",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "Analysis and clustering of residential customers energy behavioral demand using smart meter data",
      "author" : [ "S. Haben", "C. Singleton", "P. Grindrod" ],
      "venue" : "Smart Grid, IEEE Transactions on 7 (1) ",
      "citeRegEx" : "13",
      "shortCiteRegEx" : null,
      "year" : 2016
    }, {
      "title" : "A microgrid energy management system based on the rolling horizon strategy",
      "author" : [ "R. Palma-Behnke", "C. Benavides", "F. Lanas", "B. Severino", "L. Reyes", "J. Llanos", "D. Saez" ],
      "venue" : "Smart Grid, IEEE Transactions on 4 (2) ",
      "citeRegEx" : "15",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "M",
      "author" : [ "P. Meibom", "R. Barth", "B. Hasche", "H. Brand", "C. Weber" ],
      "venue" : "O’Malley, Stochastic optimization model to study the operational impacts of high wind penetrations in ireland, Power Systems, IEEE Transactions on 26 (3) ",
      "citeRegEx" : "16",
      "shortCiteRegEx" : null,
      "year" : 2011
    }, {
      "title" : "A robust optimization approach for energy generation scheduling in microgrids",
      "author" : [ "R. Wang", "P. Wang", "G. Xiao" ],
      "venue" : "Energy Conversion and Management 106 ",
      "citeRegEx" : "17",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Stochastic model predictive control for building hvac systems: Complexity and conservatism",
      "author" : [ "Y. Ma", "J. Matuko", "F. Borrelli" ],
      "venue" : "IEEE Transactions on Control Systems Technology 23 (1) ",
      "citeRegEx" : "18",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "A new milp-based approach for unit commitment in power production planning",
      "author" : [ "A. Viana", "J.P. Pedroso" ],
      "venue" : "International Journal of Electrical Power & Energy Systems 44 (1) ",
      "citeRegEx" : "19",
      "shortCiteRegEx" : null,
      "year" : 2013
    }, {
      "title" : "A computationally efficient mixed-integer linear formulation for the thermal unit commitment problem",
      "author" : [ "M. Carrion", "J.M. Arroyo" ],
      "venue" : "IEEE Transactions on Power Systems 21 (3) ",
      "citeRegEx" : "20",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "A tutorial on support vector machines for pattern recognition",
      "author" : [ "C.J. Burges" ],
      "venue" : "Data mining and knowledge discovery 2 (2) ",
      "citeRegEx" : "21",
      "shortCiteRegEx" : null,
      "year" : 1998
    }, {
      "title" : "Generating scenario trees for multistage decision problems",
      "author" : [ "K. Høyland", "S.W. Wallace" ],
      "venue" : "Management Science 47 (2) ",
      "citeRegEx" : "22",
      "shortCiteRegEx" : null,
      "year" : 2001
    } ],
    "referenceMentions" : [ {
      "referenceID" : 0,
      "context" : "The number of Power Producer and Supplier (PPS) in the power and energy market is increasing rapidly due to the liberalization in power market in Japan [1].",
      "startOffset" : 152,
      "endOffset" : 155
    }, {
      "referenceID" : 0,
      "context" : "Electric Power Retailer) in the electricity market is inevitable due to the full-fledged deregulation [1] that will eventually break the monopolies.",
      "startOffset" : 102,
      "endOffset" : 105
    }, {
      "referenceID" : 1,
      "context" : "Flexible power distribution as such is attainable through Digital grid architecture [2].",
      "startOffset" : 84,
      "endOffset" : 87
    }, {
      "referenceID" : 2,
      "context" : "The current practice is to buy (in case of demand is higher than the supply) or sell (in case of supply is higher than the demand) energy from/to Energy Imbalance Market (EIM) (EIM can be a part of Utility or be an independent body or the Utility itself, [3]).",
      "startOffset" : 255,
      "endOffset" : 258
    }, {
      "referenceID" : 2,
      "context" : "The price setting of EIM, on the other hand, is significantly higher compared to the conventional energy tariff ([3], page 4).",
      "startOffset" : 113,
      "endOffset" : 116
    }, {
      "referenceID" : 3,
      "context" : "In this paper, we present a probabilistic programming [4] approach that utilizes a Bayesian Markov Chain Monte Carlo (MCMC) sampling method [5] [6] in order to form multiple balancing groups.",
      "startOffset" : 54,
      "endOffset" : 57
    }, {
      "referenceID" : 4,
      "context" : "In this paper, we present a probabilistic programming [4] approach that utilizes a Bayesian Markov Chain Monte Carlo (MCMC) sampling method [5] [6] in order to form multiple balancing groups.",
      "startOffset" : 140,
      "endOffset" : 143
    }, {
      "referenceID" : 5,
      "context" : "In this paper, we present a probabilistic programming [4] approach that utilizes a Bayesian Markov Chain Monte Carlo (MCMC) sampling method [5] [6] in order to form multiple balancing groups.",
      "startOffset" : 144,
      "endOffset" : 147
    }, {
      "referenceID" : 6,
      "context" : "The optimization problem is, therefore, transformed into an equivalent Mixed Integer Linear Programming (MILP) problem [7] followed by an additional transformation to Mixed Logical Dynamical (MLD) System [8], and finally solved by a branch-and-cut linear solver [9].",
      "startOffset" : 119,
      "endOffset" : 122
    }, {
      "referenceID" : 7,
      "context" : "The optimization problem is, therefore, transformed into an equivalent Mixed Integer Linear Programming (MILP) problem [7] followed by an additional transformation to Mixed Logical Dynamical (MLD) System [8], and finally solved by a branch-and-cut linear solver [9].",
      "startOffset" : 204,
      "endOffset" : 207
    }, {
      "referenceID" : 8,
      "context" : "The optimization problem is, therefore, transformed into an equivalent Mixed Integer Linear Programming (MILP) problem [7] followed by an additional transformation to Mixed Logical Dynamical (MLD) System [8], and finally solved by a branch-and-cut linear solver [9].",
      "startOffset" : 262,
      "endOffset" : 265
    }, {
      "referenceID" : 9,
      "context" : "energy market, [10]).",
      "startOffset" : 15,
      "endOffset" : 19
    }, {
      "referenceID" : 10,
      "context" : "Applications of clustering methods in high- and medium-voltage power networks for large scale integration of customers have been reported in articles like [11] and [12].",
      "startOffset" : 155,
      "endOffset" : 159
    }, {
      "referenceID" : 11,
      "context" : "Applications of clustering methods in high- and medium-voltage power networks for large scale integration of customers have been reported in articles like [11] and [12].",
      "startOffset" : 164,
      "endOffset" : 168
    }, {
      "referenceID" : 10,
      "context" : "In [11], a comprehensive overview of clustering methods are presented and the necessity of these methods while identifying effective customer grouping are highlighted (from the perspective of an Energy Supplier).",
      "startOffset" : 3,
      "endOffset" : 7
    }, {
      "referenceID" : 11,
      "context" : "Hierarchical clustering, K-means, Fuzzy K-means) are discussed [12] that analyzes the similarity within customers.",
      "startOffset" : 63,
      "endOffset" : 67
    }, {
      "referenceID" : 12,
      "context" : "Meanwhile, at the low-voltage network, energy based clustering for planning and operation (from the perspective of market operators such as Distribution Network Operators, DNOs) is reported in [13].",
      "startOffset" : 193,
      "endOffset" : 197
    }, {
      "referenceID" : 12,
      "context" : "In [13], household smart-meter data are analyzed for demand variability and a finite mixture model based clustering algorithm is proposed that discovers a number of distinctive behavior groups.",
      "startOffset" : 3,
      "endOffset" : 7
    }, {
      "referenceID" : 13,
      "context" : "In [15], an energy management system for Microgrid operation considering PV, Diesel Generators, and energy storage is presented.",
      "startOffset" : 3,
      "endOffset" : 7
    }, {
      "referenceID" : 14,
      "context" : "A stochastic MPC for solving Unit Commitment with wind power is documented in [16].",
      "startOffset" : 78,
      "endOffset" : 82
    }, {
      "referenceID" : 15,
      "context" : "For example, in [17], a robust cost optimization method is presented that essentially schedules of renewable energy generators with combined heat and power (CHP) generators considering the uncertainty in net energy demand and electricity price.",
      "startOffset" : 16,
      "endOffset" : 20
    }, {
      "referenceID" : 16,
      "context" : "For example, in [18], a stochastic MPC is presented for efficient controlling in building’s HVAC system while focusing on energy minimization.",
      "startOffset" : 16,
      "endOffset" : 20
    }, {
      "referenceID" : 17,
      "context" : "For instance, in the arena of Unit Commitment (one of the important problems in Power System Planning and Operation), MILP provides efficient, fast and scalable solutions [19] [20].",
      "startOffset" : 171,
      "endOffset" : 175
    }, {
      "referenceID" : 18,
      "context" : "For instance, in the arena of Unit Commitment (one of the important problems in Power System Planning and Operation), MILP provides efficient, fast and scalable solutions [19] [20].",
      "startOffset" : 176,
      "endOffset" : 180
    }, {
      "referenceID" : 4,
      "context" : "The MCMC process utilizes the Metropolis-Hastings algorithm [5] [6] while fitting the probabilistic model to the target distribution (i.",
      "startOffset" : 60,
      "endOffset" : 63
    }, {
      "referenceID" : 5,
      "context" : "The MCMC process utilizes the Metropolis-Hastings algorithm [5] [6] while fitting the probabilistic model to the target distribution (i.",
      "startOffset" : 64,
      "endOffset" : 67
    }, {
      "referenceID" : 5,
      "context" : "The details of the algorithm and underlying theory can be found at [6].",
      "startOffset" : 67,
      "endOffset" : 70
    }, {
      "referenceID" : 2,
      "context" : "Exemplary imbalance pricing scheme is shown in Figure 4 [3].",
      "startOffset" : 56,
      "endOffset" : 59
    }, {
      "referenceID" : 2,
      "context" : "The threshold is set as 3% of the monthly peak supply, according to [3].",
      "startOffset" : 68,
      "endOffset" : 71
    }, {
      "referenceID" : 19,
      "context" : "A Support Vector Machine (SVM) [21] based time series prediction methodology is applied in order to predict the demand by utilizing the historic demand information.",
      "startOffset" : 31,
      "endOffset" : 35
    }, {
      "referenceID" : 20,
      "context" : "There are several ways to generate statistical scenarios, such as utilizing nonlinear programming for multi-stage decision problem [22]).",
      "startOffset" : 131,
      "endOffset" : 135
    }, {
      "referenceID" : 7,
      "context" : "Therefore, utilizing MLD system formulation of converting logical dynamics to MILP [8], the storage SOC dynamics can be transformed to",
      "startOffset" : 83,
      "endOffset" : 86
    }, {
      "referenceID" : 6,
      "context" : "(17-18) are equivalently casted to linear constraints [7] and handled together with charging/discharging power limit of storage (Eq.",
      "startOffset" : 54,
      "endOffset" : 57
    }, {
      "referenceID" : 2,
      "context" : "(JPY/kWh)[3].",
      "startOffset" : 9,
      "endOffset" : 12
    }, {
      "referenceID" : 8,
      "context" : "The open-source solver [9] is used to solve the MILP in robust CD scheduling.",
      "startOffset" : 23,
      "endOffset" : 26
    }, {
      "referenceID" : 0,
      "context" : "For example, initially the dacV ector contains customers from 1 to 103, [1, 103].",
      "startOffset" : 72,
      "endOffset" : 80
    }, {
      "referenceID" : 4,
      "context" : "Among them 25% of the samples are discarded (so called burn-in [5] of samples since the convergence of the Markov Chain is not fully known) while tracing the posterior samples.",
      "startOffset" : 63,
      "endOffset" : 66
    }, {
      "referenceID" : 0,
      "context" : "Referring back to Figure 8, at the next phase, the dacV ector is divided into two child vectors of [1, 84] and [85, 103], each of which will go through the Bayesian MCMC process.",
      "startOffset" : 99,
      "endOffset" : 106
    }, {
      "referenceID" : 2,
      "context" : "The imbalance energy threshold beyond which the penalty tariff is applied is set as 93kWh (3% of the maximum contracted supply)[3].",
      "startOffset" : 127,
      "endOffset" : 130
    } ],
    "year" : 2016,
    "abstractText" : "Imbalance (on-line energy gap between contracted supply and actual demand, and associated cost) reduction is going to be a crucial service for a Power Producer and Supplier (PPS) in the deregulated energy market. PPS requires forward market interactions to procure energy as precisely as possible in order to reduce imbalance energy. This paper presents, 1) (off-line) an effective demand aggregation based strategy for creating a number of balancing groups that leads to higher predictability of group-wise aggregated demand, 2) (on-line) a robust energy storage scheduling that minimizes the imbalance for a particular balancing group considering the demand prediction uncertainty. The group formation is performed by a Probabilistic Programming approach using Bayesian Markov Chain Monte Carlo (MCMC) method after applied on the historical demand statistics. Apart from the group formation, the aggregation strategy (with the help of Bayesian Inference) also clears out the upper-limit of the required storage capacity for a formed group, fraction of which is to be utilized in on-line operation. For on-line operation, a robust energy storage scheduling method is proposed that minimizes expected imbalance energy and cost (a non-linear function of imbalance energy) while incorporating the demand uncertainty of a particular group. The proposed methods are applied on the real apartment buildings’ demand data in Tokyo, Japan. Simulation results are presented to verify the effectiveness of the proposed methods.",
    "creator" : "LaTeX with hyperref package"
  }
}