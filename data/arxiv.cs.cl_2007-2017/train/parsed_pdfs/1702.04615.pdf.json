{
  "name" : "1702.04615.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Automated Identification of Drug-Drug Interactions in Pediatric Congestive Heart Failure Patients",
    "authors" : [ "Daniel Miller" ],
    "emails" : [ "danielrm@stanford.edu," ],
    "sections" : [ {
      "heading" : null,
      "text" : "Automated Identification of Drug-Drug Interactions in Pediatric Congestive Heart Failure Patients\nDaniel Miller Final Report\nCS 221, Stanford University Email: danielrm@stanford.edu, SUNet ID: 005579372\nI. INTRODUCTION\nCongestive Heart Failure, or CHF, is a serious medical condition that can result in fluid buildup in the body as a result of a weak heart. When the heart can’t pump enough blood to efficiently deliver nutrients and oxygen to the body, kidney function may be impaired, resulting in fluid retention. CHF patients require a broad drug regimen to maintain the delicate system balance, particularly between their heart and kidneys. These drugs include ACE inhibitors and Beta Blockers to control blood pressure, anticoagulants to prevent blood clots, and diuretics to reduce fluid overload. Many of these drugs may interact, and potential effects of these interactions must be weighed against their benefits.\nFor this project, we consider a set of 44 drugs identified as specifically relevant for treating CHF by pediatric cardiologists at Lucile Packard Children’s Hospital. This list was generated as part of our current work at the LPCH Heart Center.\nThe goal of this project is to identify and evaluate potentially harmful drug-drug interactions (DDIs) within pediatric patients with Congestive Heart Failure. This identification will be done autonomously, so that it may continuously update by evaluating newly published literature."
    }, {
      "heading" : "II. GOALS AND DATA",
      "text" : ""
    }, {
      "heading" : "A. Automated Literature Analysis",
      "text" : "In the first stage, I will use natural language processing to extract drug interactions from medical research paper abstracts. The input to this stage will be raw abstract texts related to a DDI, like the one shown in Figure 1.\nAs an initial evaluation metric (labels), I have used DrugBank, an established resource for drug data, which includes drug-drug interaction and much more. DrugBank was assembled over several years by a team of archivists and annotators that included two accredited pharmacists, a physician and three bioinformaticians with dual training in computing science and molecular biology/chemistry [2]. One goal of my project is to design a automated system capable of replicating, and extending the DDI component of this work.\nAll abstracts used in this project come from the PubMed Central Open Access Subset [3]. These data are all openly available in .xml format via FTP, and currently (as of November 2016) include a total of 663,597 papers. These abstracts required significant filtering to narrow down to only those\npapers concerned with drug-drug interactions, specifically for drugs relevant to the cardiac patient population. To perform this filtering, I fist considered the set of 44 cardiac drugs. Using the DrugBank database, I identified a superset of 1781 drugs known to have interactions with at least one of the cardiac drugs. Any abstract that contained mention of at least one of these 1781 drugs is defined as a “Cardiac Abstract” and included in the analysis.\nThis filtering process left 69,713 remaining abstracts, roughly 10% of the initial total. I used the PubMed Parser tookit to extract the abstracts from the xml formatted dataset [4].\nar X\niv :1\n70 2.\n04 61\n5v 1\n[ cs\n.C L\n] 1\n1 Fe\nb 20\n17"
    }, {
      "heading" : "B. Patient Analysis",
      "text" : "The second goal of my project is to identify potential drug interactions for a sample Congestive Heart Failure patient population, based on the output from the previous stage. For this project, I will be using an anonymized extract of the full Medical Administration Record (MAR) for 60 current and former CHF patients at the Lucile Packard Children’s Hospital (LPCH). The specific inputs to this stage are:\n1) The drug interactions generated by the previous stage 2) The Medical Administration Record (MAR) for the CHF\npatients (drug name and admin time).\nAn example of a single patient’s Furosemide and Bumetanide administration records is shown in Figure 2. As we can see from the plot, these drug administrations overlap, creating time windows where the patient might experience detrimental DDI effects.\nThe output of this stage is a set of time-ranges where we predict potential DDIs. For example, from the record shown in Figure 2, we see that Patient 1 received Furosemide and Bumatenide in July 2015, with potential effect of decrease kidney function, and generate the following coded output:\n• ((Furosemide, Bumatenide), (”2015-07-15”, ”2015-07-19”), ”Reduced Kidney Function”)\nThe evaluation metric for this stage is not yet clearly defined. Once the system has generated specific output hypotheses like the one shown above, I will request specific clinician feedback from the LPCH cardiologists. Ideally, we would be able to tie each effect to a known measurable symptom. Continuing the example, reduced kidney function is often recognized by an increase in creatinine in the kidneys. Creatinine labs are taken frequently for the CHF patients.\nThis section of the project is beyond the scope of this class, and has been deferred pending improvements in the algorithm performance for the automated literature analysis. Future work will include implementation of DDI identification for current LPCH patients, and automated warning messages to physicians when a clearly defined risk is achieved. One significant issue to be tackled is properly balancing the false negative vs false positive rate to suppress false alarms, and maintain sensitivity."
    }, {
      "heading" : "III. MODEL",
      "text" : "For the time being, we consider only part A, the automated literature analysis. The general use case of the proposed model may be summarized as follows:\n1) The user submits a query of the following form: “Do the drugs A and B have any potentially harmful interactions, and if so, how may they interact?” 2) A large set of medical publication abstracts are provided, with each related to either drug A, B, or both. 3) Our model runs on these inputs, and returns the drugdrug interactions, if any exist.\nTo generate a model fulfilling this form, we take the following steps."
    }, {
      "heading" : "A. Labeling",
      "text" : "To begin, we generate all pairwise drug combinations. We begin by considering the 44 pediatric cardiology drugs Dcardiac. For each cardiac drug dc ∈ Dcardiac, we extract all pairwise drug interactions (dc, d) from the DrugBank database Ddrugbank. The union of all considered drugs d forms the set of all drugs Dall considered in this analysis.\nFor each cardiac drug dc ∈ Dcardiac, we create a sample for every other drug in do ∈ Dall. We assign a indicator label if two drugs interact as follows:\nlabel ((dc, do)) = {\n1 if (dc, do) ∈ Ddrugbank 0 otherwise\nThis label is used for the binary classification supervised learning problem, in which we predict whether two drugs interact, but not the nature of their interaction. We also consider the type of interaction, which is also provided by the DrugBank database. By replacing the drug names in each interaction, we obtain 53 interaction types i ∈ Idrugbank of the following form:\nEx: ”The serum concentration of ( drug ) can be increased when it is combined with ( drug ).”\nThese interaction types will be used to label the supervised multiclass classification problem in which we will predict the actual type of interaction between two drugs, if any exists."
    }, {
      "heading" : "B. Test/Train/Validation Split",
      "text" : "For this particular problem, a particularly careful definition of the validation splits is worth examination. Because each abstract may consider one or more drugs (see Table I), we would like to use the information each abstract for more than one interaction (sample). Therefore, our samples will not be independent, so a validation set randomly sampled from the interactions could be highly correlated with the training set. We therefore take precautions to eliminate this dependence by splitting on interactions via the following procedure:\nAlgorithm 1 Train/Test/Validation Split Algorithm 1: Split all abstracts into training (80%) and testing (20%)\nsets. 2: Split all interactions into training (80%) and testing (20%)\nsets. 3: Split training set into training (80%) and validation/dev\n(20%) sets. 4: for split in (train, test, validation) do 5: for each pairwise interaction (d1, d2) in split do 6: for each abstract in split do 7: if d1 or d2 in abstract then 8: Assign abstract to the interaction (d1, d2)\nIn this way, DDI’s in the training set may share abstracts, but not with any DDI’s in the test or validation set."
    }, {
      "heading" : "C. Feature Extraction",
      "text" : "We next extract features for each DDI from the abstracts. So far, we have considered two methods for performing feature extraction.\n1) Word Counts: For the moment, we are simply using a sparse vector word counter for each abstract assigned to an interactions, and summing over all abstract counters to get a single feature vector for each interaction. Refer to Table I for summary information on the counts of words in the abstracts.\nThe current model limitation is rooted in the scaling. Many abstracts are hundreds of words long, and make mention of dozens of drugs. Our final sparse word counter considers 53338 words across 63450 interaction samples. To allow some methods to run, it was necessary to drop all but the 100 most common words to allow for a reasonable runtime.\n2) GloVe: To address the scaling issue, I have also made use of GloVe: Global Vectors for Word Representation [5]. This implementation is in the very early stages, and thus far has not demonstrated notable accuracy. In the interest of time, we used the Wikipedia 2014 + Gigaword 5 pre-trained word vectorizations. This contained vectorizations for 31774 of the words across all cardiac abstracts, but did not contain pretrained vectors for 21560 of the words, most of which were medically-specific. In the future, I will re-build a medicallyspecific GloVe vectorization from the entire PubMed OA subset, including both abstract and paper body test.\nTo move from word to sentence and full abstract vectors, I simply used a sum over the words in the abstracts, dropping\nall stop words, and weighted by term frequency. This is clearly non-ideal, as it does not take into account word order or semantics/context, but was done in the interest of time. Even this simple method took nearly a day of computation time on a personal machine. Fortunately, using pre-trained word vectors to analyze each abstract is a fully parallelizable procedure, which will be taken advantage of going forward. I am currently researching possible algorithms to handle a highly variable collection of abstracts, each of variable length. One option is to pre-process using Fixed-size Ordinally-Forgetting Encoding (FOFE) [6].\nIn the future, we will consider more sophisticated features, including pairwise indicators, n-grams, and adjacent pairs."
    }, {
      "heading" : "D. Supervised Learning: Evaluation and Model Selection",
      "text" : "Thus far, I have implemented a variety of distinct supervised learning algorithms. Each is trained exclusively on the training split, and all model tuning is performed by splitting the training set into further validation sets and cross-validation folds. Each model’s performace is evaluated and compared on the validation set. As more methods are considered, and further tuning is performed, this pattern will continue. The final model selection will be based on performance on the validation/dev set. This final model will be re-tuned on the combined train/validation sets, and only then will the final performance metrics be evaluated on the test set.\nThe first model considered was a linear SVM using the word count features, due to its convenient scalability, and allowance for cheap feature extensions via kernel methods. I implemented this model using the e1071 package in R, since it supports sparse predictor matrices. This allowed me to consider all 53338 word counts. Initial results followed the typical result for SVM classifiers on high-dimensional imbalanced-label datasets. Somewhat unsurprisingly, the SVM model classified all samples to the most common class (0 – no interaction), as this yielded a relatively high accuracy.\nTo counteract the imbalancing, I tried undersampling the training set to a balanced number of each label. This led to minor improvements as seen in Table II. I expect further improvements to come from tuning and kernel selection, but I am not convinced that SVM is an appropriate model for this problem.\nThe second model considered was a convolutional neural network implemented in TensorFlow with a re-purposed fork of the Convolutional Neural Networks for Sentence Classification toolkit written and published by Yoon Kim [7]. As CNNs do not scale as nicely as SVMs, it was necessary to reduce the extremely large feature set. As a preliminary selection, I just selected out the counts of the 100 most common words.\nThis model also initially experienced the same issues that SVM had with the imbalanced labels. However, using the same undersampling trick yielded much better results, leading to the promising, if not immediate useful metrics seen in Table II. One advantage of this model is the ability to continuously tune over time. Figure 3 shows how the training accuracy of the CNN increases as we continue to iterate the model.\nI next tried to directly address the feature set size and enforced sparsity by introducing L1 regularization via the Lasso method. Thus far, this method has been the most successful by a significant margin. The full sensitivity-specificity curve is shown in Figure 4. The regularization parameter was tuned via cross-validation with the reward function being area-underthe-curve (AUC).\nThe final methods both used the GloVe vectorizations rather than the word counts. While performing better than random, neither method approached the results of the wordcount Lasso implementation. The first method, shown in Figure 5 is a simple logistic regression applied to the GloVe vectors. The second method, shown in Figure 6 is a Lasso classifier applied to the GloVe vectors, again tuned via cross-validation for AUC."
    }, {
      "heading" : "IV. FUTURE WORK AND CONCLUSIONS",
      "text" : "The preliminary methods and results presented in this paper demonstrate the viability of the goals of this project. In particular, the Lasso method on word counts points towards\nusing feature selection in conjunction with a broad, automatically generated feature space. The primary limitation of the project thus far has been scalability. Fortunately, these issues are focused around highly parallelizable algorithms, and may be addressed going forward by GPU implementation. In the same vein, more efficient implementations will allow for more sophisticated NLP algorithms to perform feature extraction from the set of abstracts associated with each drugdrug interaction.\nIn summary, our results indicate that there is a useful information about drug-drug interactions for congestive heart failure patients that may be extracted autonomously from the medical literature, with no external clinical knowledge."
    } ],
    "references" : [ {
      "title" : "Bumetanide and furosemide in heart failure",
      "author" : [ "D.C. Brater", "B. Day", "A. Burdette", "S. Anderson" ],
      "venue" : "Kidney international, vol. 26, no. 2, pp. 183–189, 1984.",
      "citeRegEx" : "1",
      "shortCiteRegEx" : null,
      "year" : 1984
    }, {
      "title" : "Drugbank: a comprehensive resource for in silico drug discovery and exploration",
      "author" : [ "D.S. Wishart", "C. Knox", "A.C. Guo", "S. Shrivastava", "M. Hassanali", "P. Stothard", "Z. Chang", "J. Woolsey" ],
      "venue" : "Nucleic acids research, vol. 34, no. suppl 1, pp. D668–D672, 2006.",
      "citeRegEx" : "2",
      "shortCiteRegEx" : null,
      "year" : 2006
    }, {
      "title" : "PubMed Parser",
      "author" : [ "T. Achakulvisut", "D.E. Acuna" ],
      "venue" : "http://github.com/ titipata/pubmed parser. http://doi.org/10.5281/zenodo.159504, 2015, [Online; accessed 16-November-2016].",
      "citeRegEx" : "4",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Glove: Global vectors for word representation",
      "author" : [ "J. Pennington", "R. Socher", "C.D. Manning" ],
      "venue" : "Empirical Methods in Natural Language Processing (EMNLP), 2014, pp. 1532–1543. [Online]. Available: http://www.aclweb.org/anthology/D14-1162",
      "citeRegEx" : "5",
      "shortCiteRegEx" : null,
      "year" : 2014
    }, {
      "title" : "The fixed-size ordinallyforgetting encoding method for neural network language models",
      "author" : [ "S. Zhang", "H. Jiang", "M. Xu", "J. Hou", "L. Dai" ],
      "venue" : "Proceedings of ACL, 2015.",
      "citeRegEx" : "6",
      "shortCiteRegEx" : null,
      "year" : 2015
    }, {
      "title" : "Convolutional neural networks for sentence classification",
      "author" : [ "Y. Kim" ],
      "venue" : "CoRR, vol. abs/1408.5882, 2014. [Online]. Available: http://arxiv.org/ abs/1408.5882",
      "citeRegEx" : "7",
      "shortCiteRegEx" : null,
      "year" : 2014
    } ],
    "referenceMentions" : [ {
      "referenceID" : 1,
      "context" : "DrugBank was assembled over several years by a team of archivists and annotators that included two accredited pharmacists, a physician and three bioinformaticians with dual training in computing science and molecular biology/chemistry [2].",
      "startOffset" : 235,
      "endOffset" : 238
    }, {
      "referenceID" : 0,
      "context" : "1: An example drug-drug interaction abstract [1].",
      "startOffset" : 45,
      "endOffset" : 48
    }, {
      "referenceID" : 2,
      "context" : "I used the PubMed Parser tookit to extract the abstracts from the xml formatted dataset [4].",
      "startOffset" : 88,
      "endOffset" : 91
    }, {
      "referenceID" : 3,
      "context" : "2) GloVe: To address the scaling issue, I have also made use of GloVe: Global Vectors for Word Representation [5].",
      "startOffset" : 110,
      "endOffset" : 113
    }, {
      "referenceID" : 4,
      "context" : "One option is to pre-process using Fixed-size Ordinally-Forgetting Encoding (FOFE) [6].",
      "startOffset" : 83,
      "endOffset" : 86
    }, {
      "referenceID" : 5,
      "context" : "The second model considered was a convolutional neural network implemented in TensorFlow with a re-purposed fork of the Convolutional Neural Networks for Sentence Classification toolkit written and published by Yoon Kim [7].",
      "startOffset" : 220,
      "endOffset" : 223
    } ],
    "year" : 2017,
    "abstractText" : "Congestive Heart Failure, or CHF, is a serious medical condition that can result in fluid buildup in the body as a result of a weak heart. When the heart can’t pump enough blood to efficiently deliver nutrients and oxygen to the body, kidney function may be impaired, resulting in fluid retention. CHF patients require a broad drug regimen to maintain the delicate system balance, particularly between their heart and kidneys. These drugs include ACE inhibitors and Beta Blockers to control blood pressure, anticoagulants to prevent blood clots, and diuretics to reduce fluid overload. Many of these drugs may interact, and potential effects of these interactions must be weighed against their benefits. For this project, we consider a set of 44 drugs identified as specifically relevant for treating CHF by pediatric cardiologists at Lucile Packard Children’s Hospital. This list was generated as part of our current work at the LPCH Heart Center. The goal of this project is to identify and evaluate potentially harmful drug-drug interactions (DDIs) within pediatric patients with Congestive Heart Failure. This identification will be done autonomously, so that it may continuously update by evaluating newly published literature.",
    "creator" : "LaTeX with hyperref package"
  }
}