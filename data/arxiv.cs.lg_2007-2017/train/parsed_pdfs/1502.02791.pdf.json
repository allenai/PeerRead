{
  "name" : "1502.02791.pdf",
  "metadata" : {
    "source" : "META",
    "title" : "Learning Transferable Features with Deep Adaptation Networks",
    "authors" : [ "Mingsheng Long", "Yue Cao", "Jianmin Wang", "Michael I. Jordan" ],
    "emails" : [ "MINGSHENG@TSINGHUA.EDU.CN", "YUE-CAO14@MAILS.TSINGHUA.EDU.CN", "JIMWANG@TSINGHUA.EDU.CN", "JORDAN@BERKELEY.EDU" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n50 2.\n02 79\n1v 2\n[ cs\n.L G\n] 2\n7 M\nay 2"
    }, {
      "heading" : "1. Introduction",
      "text" : "The generalization error of supervised learning machines with limited training samples will be unsatisfactorily large, while manual labeling of sufficient training data for diverse application domains may be prohibitive. Therefore, there is incentive to establishing effective algorithms to reduce the labeling cost, typically by leveraging off-the-shelf labeled\nProceedings of the 32nd International Conference on Machine Learning, Lille, France, 2015. JMLR: W&CP volume 37. Copyright 2015 by the author(s).\ndata from relevant source domains to the target domains. Domain adaptation addresses the problem that we have data from two related domains but under different distributions. The domain discrepancy poses a major obstacle in adapting predictive models across domains. For example, an object recognition model trained on manually annotated images may not generalize well on testing images under substantial variations in the pose, occlusion, or illumination. Domain adaptation establishes knowledge transfer from the labeled source domain to the unlabeled target domain by exploring domain-invariant structures that bridge different domains of substantial distribution discrepancy (Pan & Yang, 2010).\nOne of the main approaches to establishing knowledge transfer is to learn domain-invariant models from data, which can bridge the source and target domains in an isomorphic latent feature space. In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014). However, recent studies have shown that deep neural networks can learn more transferable features for domain adaptation (Glorot et al., 2011; Donahue et al., 2014; Yosinski et al., 2014), which produce breakthrough results on some domain adaptation datasets. Deep neural networks are able to disentangle exploratory factors of variations underlying the data samples, and group features hierarchically in accordance with their relatedness to invariant factors, making representations robust to noise.\nWhile deep neural networks are more powerful for learning general and transferable features, the latest findings also reveal that the deep features must eventually transition from general to specific along the network, and feature transferability drops significantly in higher layers with increasing domain discrepancy. In other words, the features computed in higher layers of the network must depend greatly on the specific dataset and task (Yosinski et al., 2014), which are task-specific features and are not safely transferable to\nnovel tasks. Another curious phenomenon is that disentangling the variational factors in higher layers of the network may enlarge the domain discrepancy, as different domains with the new deep representations become more “compact” and are more mutually distinguishable (Glorot et al., 2011). Although deep features are salient for discrimination, enlarged dataset bias may deteriorate domain adaptation performance, resulting in statistically unbounded risk for the target tasks (Mansour et al., 2009; Ben-David et al., 2010).\nInspired by the literature’s latest understanding about the transferability of deep neural networks, we propose in this paper a new Deep Adaptation Network (DAN) architecture, which generalizes deep convolutional neural network to the domain adaptation scenario. The main idea of this work is to enhance the feature transferability in the task-specific layers of the deep neural network by explicitly reducing the domain discrepancy. To establish this goal, the hidden representations of all the task-specific layers are embedded to a reproducing kernel Hilbert space where the mean embeddings of different domain distributions can be explicitly matched. As mean embedding matching is sensitive to the kernel choices, an optimal multi-kernel selection procedure is devised to further reduce the domain discrepancy. In addition, we implement a linear-time unbiased estimate of the kernel mean embedding to enable scalable training, which is very desirable for deep learning. Finally, as deep models pre-trained with large-scale repositories such as ImageNet (Russakovsky et al., 2014) are representative for generalpurpose tasks (Yosinski et al., 2014; Hoffman et al., 2014), the proposed DAN model is trained by fine-tuning from the AlexNet model (Krizhevsky et al., 2012) pre-trained on ImageNet, which is implemented in Caffe (Jia et al., 2014). Comprehensive empirical evidence demonstrates that the proposed architecture outperforms state-of-the-art results evaluated on the standard domain adaptation benchmarks.\nThe contributions of this paper are summarized as follows. (1) We propose a novel deep neural network architecture for domain adaptation, in which all the layers corresponding to task-specific features are adapted in a layerwise manner, hence benefiting from “deep adaptation.” (2) We explore multiple kernels for adapting deep representations, which substantially enhances adaptation effectiveness compared to single kernel methods. Our model can yield unbiased deep features with statistical guarantees."
    }, {
      "heading" : "2. Related Work",
      "text" : "A related literature is transfer learning (Pan & Yang, 2010), which builds models that bridge different domains or tasks, explicitly taking domain discrepancy into consideration. Transfer learning aims to mitigate the effort of manual labeling for machine learning (Pan et al., 2011; Gong et al., 2013; Zhang et al., 2013; Wang & Schneider, 2014) and\ncomputer vision (Saenko et al., 2010; Gong et al., 2012; Baktashmotlagh et al., 2013; Long et al., 2013), etc. It is widely recognized that the domain discrepancy in the probability distributions of different domains should be formally measured and reduced. The major bottleneck is how to match different domain distributions effectively. Most existing methods learn a new shallow representation model in which the domain discrepancy can be explicitly reduced. However, without learning deep features which can suppress domain-specific factors, the transferability of shallow features could be limited by the task-specific variability.\nDeep neural networks learn nonlinear representations that disentangle and hide different explanatory factors of variation behind data samples (Bengio et al., 2013). The learned deep representations manifest invariant factors underlying different populations and are transferable from the original tasks to similar novel tasks (Yosinski et al., 2014). Hence, deep neural networks have been explored for domain adaptation (Glorot et al., 2011; Chen et al., 2012), multimodal and multi-source learning problems (Ngiam et al., 2011; Ge et al., 2013), where significant performance gains have been obtained. However, all these methods depend on the assumption that deep neural networks can learn invariant representations that are transferable across different tasks. In reality, the domain discrepancy can be alleviated, but not removed, by deep neural networks (Glorot et al., 2011). Dataset shift has posed a bottleneck to the transferability of deep networks, resulting in statistically unbounded risk for target tasks (Mansour et al., 2009; Ben-David et al., 2010).\nOur work is primarily motivated by Yosinski et al. (2014), which comprehensively explores feature transferability of deep convolutional neural networks. The method focuses on a different scenario where the learning tasks are different across domains, hence it requires sufficient target labeled examples such that the source network can be finetuned to the target task. In many real problems, labeled data is usually limited especially for a novel target task, hence the method cannot be directly applicable to domain adaptation. There are several very recent efforts in learning domain-invariant features in the context of shallow neural networks (Ajakan et al., 2014; Ghifary et al., 2014). Due to the limited capacity of shallow architectures, the performance of these proposals does not surpass deep CNN (Krizhevsky et al., 2012). Tzeng et al. (2014) proposed a DDC model that adds an adaptation layer and a dataset shift loss to the deep CNN for learning a domain-invariant representation. While performance was improved, DDC only adapts a single layer of the network, which may be restrictive in that there are multiple layers where the hidden features are not transferable (Yosinski et al., 2014). DDC is also limited by suboptimal kernel matching of probability distributions (Gretton et al., 2012b) and its quadratic computational cost that restricts transferability and scalability."
    }, {
      "heading" : "3. Deep Adaptation Networks",
      "text" : "In unsupervised domain adaptation, we are given a source domainDs = {(xsi , y s i )} ns i=1 with ns labeled examples, and a target domain Dt = {xtj} nt j=1 with nt unlabeled examples. The source domain and target domain are characterized by probability distributions p and q, respectively. We aim to construct a deep neural network which is able to learn transferable features that bridge the cross-domain discrepancy, and build a classifier y = θ(x) which can minimize target risk ǫt (θ) = Pr(x,y)∼q [θ (x) 6= y] using source supervision. In semi-supervised adaptation where the target has a small number of labeled examples, we denote by Da = {(xai , y a i )} the na annotated examples of source and target domains."
    }, {
      "heading" : "3.1. Model",
      "text" : "MK-MMD Domain adaptation is challenging in that the target domain has no (or only limited) labeled information. To approach this problem, many existing methods aim to bound the target error by the source error plus a discrepancy metric between the source and the target (Ben-David et al., 2010). Two classes of statistics have been explored for the two-sample testing, where acceptance or rejection decisions are made for a null hypothesis p = q, given samples generated respectively from p and q: energy distances and maximum mean discrepancies (MMD) (Sejdinovic et al., 2013). In this paper, we focus on the multiple kernel variant of MMD (MK-MMD) proposed by Gretton et al. (2012b), which is formalized to jointly maximize the two-sample test power and minimize the Type II error, i.e., the failure of rejecting a false null hypothesis.\nDenote by Hk be the reproducing kernel Hilbert space (RKHS) endowed with a characteristic kernel k. The mean embedding of distribution p in Hk is a unique element µk(p) such that Ex∼pf (x) = 〈f (x) , µk (p)〉Hk for all f ∈ Hk. The MK-MMD dk (p, q) between probability distributions p and q is defined as the RKHS distance between the mean embeddings of p and q. The squared formulation of MK-MMD is defined as\nd2k (p, q) , ∥ ∥Ep [φ (x s)]−Eq [ φ ( xt )] ∥ ∥ 2\nHk . (1)\nThe most important property is that p = q iff d2k (p, q) = 0 (Gretton et al., 2012a). The characteristic kernel associated with the feature map φ, k (xs,xt) = 〈φ (xs) , φ (xt)〉, is defined as the convex combination of m PSD kernels {ku},\nK ,\n{\nk =\nm ∑\nu=1\nβuku :\nm ∑\nu=1\nβu = 1, βu > 0, ∀u\n}\n, (2)\nwhere the constraints on coefficients {βu} are imposed to guarantee that the derived multi-kernel k is characteristic. As studied theoretically in Gretton et al. (2012b), the kernel\nadopted for the mean embeddings of p and q is critical to ensure the test power and low test error. The multi-kernel k can leverage different kernels to enhance MK-MMD test, leading to a principled method for optimal kernel selection.\nOne of the feasible strategies for controlling the domain discrepancy is to find an abstract feature representation through which the source and target domains are similar (Ben-David et al., 2010). Although this idea has been explored in several papers (Pan et al., 2011; Zhang et al., 2013; Wang & Schneider, 2014), to date there has been no attempt to enhance the transferability of feature representation via MK-MMD in deep neural networks.\nDeep Adaptation Networks (DAN) In this paper, we explore the idea of MK-MMD-based adaptation for learning transferable features in deep networks. We start with deep convolutional neural networks (CNN) (Krizhevsky et al., 2012), a strong model when it is adapted to novel tasks (Donahue et al., 2014; Hoffman et al., 2014). The main challenge is that the target domain has no or just limited labeled information, hence directly adapting CNN to the target domain via fine-tuning is impossible or is prone to over-fitting. With the idea of domain adaptation, we are targeting a deep adaptation network (DAN) that can exploit both source-labeled data and target-unlabeled data. Figure 1 gives an illustration of the proposed DAN model.\nWe extend the AlexNet architecture (Krizhevsky et al., 2012), which is comprised of five convolutional layers (conv1–conv5) and three fully connected layers (fc6– fc8). Each fc layer ℓ learns a nonlinear mapping hℓi = f ℓ (\nWℓhℓ−1i + b ℓ ) , where hℓi is the ℓth layer hidden representation of point xi, Wℓ and bℓ are the weights and bias of the ℓth layer, and f ℓ is the activation, taking as rectifier units f ℓ(x) = max(0,x) for hidden layers or softmax units f ℓ (x) = ex/\n∑|x| j=1 e xj for the output layer. Letting\nΘ = { Wℓ,bℓ }l\nℓ=1 denote the set of all CNN parameters,\nthe empirical risk of CNN is\nmin Θ\n1\nna\nna ∑\ni=1\nJ (θ (xai ) , y a i ), (3)\nwhere J is the cross-entropy loss function, and θ (xai ) is the conditional probability that the CNN assigns xai to label yai . We will not discuss how to compute the convolutional layers as we will not impose distribution-adaptation regularization in those layers, given that the convolutional layers can learn generic features that tend to be transferable in layers conv1–conv3 and are slightly domain-biased in conv4–conv5 (Yosinski et al., 2014). Hence, when adapting the pre-trained AlexNet to the target, we opt to freeze conv1–conv3 and fine-tune conv4–conv5 to preserve the efficacy of fragile co-adaptation (Hinton et al., 2012).\nIn standard CNNs, deep features must eventually transition from general to specific by the last layer of the network, and the transferability gap grows with the domain discrepancy and becomes particularly large when transferring the higher layers fc6–fc8 (Yosinski et al., 2014). In other words, the fc layers are tailored to their original task at the expense of degraded performance on the target task, hence they cannot be directly transferred to the target domain via fine-tuning with limited target supervision. In this paper, we fine-tune CNN on the source labeled examples and require the distributions of the source and target to become similar under the hidden representations of fully connected layers fc6– fc8. This can be realized by adding an MK-MMD-based multi-layer adaptation regularizer (1) to the CNN risk (3):\nmin Θ\n1\nna\nna ∑\ni=1\nJ (θ (xai ) , y a i ) + λ\nl2 ∑\nℓ=l1\nd2k ( Dℓs,D ℓ t ) , (4)\nwhere λ > 0 is a penalty parameter, l1 and l2 are layer indices between which the regularizer is effective. In our implementation of DAN, we set l1 = 6 and l2 = 8, although different configurations are also possible, depending on the size of the labeled source dataset and the number of parameters in the layers that are to be fine-tuned. Dℓ∗ = { h∗ℓi }\nis the ℓth layer hidden representation for the source and target examples, and d2k ( Dℓs,D ℓ t )\nis the MK-MMD between the source and target evaluated on the ℓth layer representation.\nTraining a deep CNN requires a large amount of labeled data, which is prohibitive for many domain adaptation problems, hence we start with an AlexNet model pretrained on ImageNet 2012 and fine-tune it as in Yosinski et al. (2014). With the proposed DAN optimization framework (4), we are able to learn transferable features from a source domain to a related target domain. The learned representation can both be salient benefiting from CNN, and unbiased thanks to MK-MMD. Two important advantages\nthat distinguish DAN from relevant literature are: (1) multilayer adaptation. As revealed by (Yosinski et al., 2014), feature transferability gets worse on conv4–conv5 and significantly drops on fc6–fc8, hence it is critical to adapt multiple layers instead of only one layer. In other words, adapting a single layer cannot undo the dataset bias between the source and the target, since there are other layers that are not transferable. Another benefit of multi-layer adaptation is that by jointly adapting the representation layers and the classifier layer, we could essentially bridge the domain discrepancy underlying both the marginal distribution and the conditional distribution, which is crucial for domain adaptation (Zhang et al., 2013). (2) multi-kernel adaptation. As pointed out by Gretton et al. (2012b), kernel choice is critical to the testing power of MMD since different kernels may embed probability distributions in different RKHSs where different orders of sufficient statistics can be emphasized. This is crucial for moment matching, which is not well explored by previous domain adaptation methods."
    }, {
      "heading" : "3.2. Algorithm",
      "text" : "Learning Θ Using the kernel trick, MK-MMD (1) can be computed as the expectation of kernel functions d2k (p, q) = Exsx′sk(x s,x′ s ) + Extx′tk(x t,x′ t ) − 2Exsxtk(x s,xt), where xs,x′s iid ∼ p, xt,x′t iid ∼ q, and k ∈ K. However, this computation incurs a complexity of O(n2), which is rather undesirable for deep CNNs, as the power of deep neural networks largely derives from learning with large-scale datasets. Moreover, the summation over pairwise similarities between data points makes mini-batch stochastic gradient descent (SGD) more difficult, whereas mini-batch SGD is crucial to the training effectiveness of deep networks. While prior work based on MMD (Pan et al., 2011; Tzeng et al., 2014) rarely addresses this issue, we believe it is critical in the context of deep learning. In this paper, we adopt the unbiased estimate of MK-MMD (Gretton et al., 2012b) which can be computed with linear complexity. More specifically, d2k (p, q) = 2 ns ∑ns/2 i=1 gk (zi), where we denote quad-tuple zi , (xs2i−1,x s 2i,x t 2i−1,x t 2i), and evaluate multi-kernel function k on each quad-tuple zi by gk (zi) , k(x s 2i−1,x s 2i)+k(x t 2i−1,x t 2i)−k(x s 2i−1,x t 2i)− k(xs2i,x t 2i−1). This approach computes an expectation of independent variables as in (1) with cost O(n).\nWhen we train deep CNN by mini-batch SGD, we only need to consider the gradient of objective (4) with respect to each data point xi. Since the linear-time MK-MMD takes a nice summation form that can be readily decoupled into the sum of gk(zi)’s, we only need to compute the gradients ∂gk(z ℓ i)\n∂Θℓ for the quad-tuple z ℓ i =\n(\nhsℓ2i−1,h sℓ 2i,h tℓ 2i−1,h tℓ 2i\n)\nof the ℓth layer hidden representation. To be consistent with the gradient of MK-MMD, we need to compute the corresponding gradient of CNN risk ∂J(zi)\n∂Θℓ , where J (zi) =\n∑\ni′ J (θ (x a i′ ) , y a i′), and {(x a i′ , y a i′)} indicates the labeled examples in quad-tuple zi—for instance, in unsupervised adaptation where the target domain has no labeled data, we have {(xai′ , y a i′)} = {(x s 2i−1, y s 2i−1), (x s 2i, y s 2i)}. To perform a mini-batch update, we compute the gradient of objective (4) with respect to the ℓth layer parameter Θℓ as\n∇Θℓ = ∂J (zi)\n∂Θℓ + λ\n∂gk ( zℓi )\n∂Θℓ . (5)\nSuch a mini-batch SGD can be easily implemented within the Caffe framework for CNNs (Jia et al., 2014). Given kernel k as the linear combination of m Gaussian kernels\n{ku (xi,xj) = e −‖xi−xj‖ 2/γu}, the gradient ∂gk(zℓi) ∂Θℓ\ncan be readily computed using the chain rule. For instance,\n∂k(hsℓ2i−1,h tℓ 2i)\n∂Wℓ = −\nm ∑\nu=1\n2βu γu ku ( hsℓ2i−1,h tℓ 2i )\n× ( hsℓ2i−1 − h tℓ 2i )\n× ( I [\nh s(ℓ−1) 2i−1\n] − I [\nh t(ℓ−1) 2i\n])T\n,\n(6)\nwhere the last row computes the gradient of the ℓth layer rectifier units, with I being defined as an indicator such that I [\nhℓ−1ji ] = hℓ−1ji if W ℓ j·h ℓ−1 i +b ℓ j > 0, else I [ hℓ−1ji ] = 0.\nLearning β The proposed multi-layer adaptation regularizer performs layerwise matching by MK-MMD, hence we seek to learn optimal kernel parameter β for MK-MMD by jointly maximizing the test power and minimizing the Type II error (Gretton et al., 2012b), leading to the optimization\nmax k∈K\nd2k ( Dℓs,D ℓ t ) σ−2k , (7)\nwhere σ2k = Ezg 2 k (z)− [Ezgk (z)] 2 is estimation variance. Lettingd = (d1, d2, . . . , dm)T, each du is MMD via kernel ku. Covariance Q = cov (gk) ∈ Rm×m can be computed in O(m2n) cost, i.e. Quu′ = 4ns ∑ns/4 i=1 g ∆ ku (z̄i) g ∆ ku′ (z̄i), where z̄i , (z2i−1, z2i) and g∆ku (z̄i) , gku (z2i−1) − gku (z2i). Hence (7) reduces to a quadratic program (QP),\nmin dTβ=1,β>0\nβT (Q+ εI)β, (8)\nwhere ε = 10−3 is a small regularizer to make the problem well-defined. By solving (8), we obtain a multi-kernel k =\n∑m u=1 βuku that jointly maximizes the test power and\nminimizes the Type II error.\nWe note that the DAN objective (4) is essentially a minimax problem; i.e., we compute min\nΘ max K\nd2k ( Dℓs,D ℓ t ) σ−2k . The\nCNN parameter Θ is learned by minimizing MK-MMD as a domain discrepancy, while the MK-MMD parameter β is learned by minimizing the Type II error. Both criteria are dedicated to an effective adaptation of domain discrepancy,\naiming to consolidate the transferability of DAN features. We accordingly adopt an alternating optimization that updates Θ by mini-batch SGD (5) and β by QP (8) iteratively. Both updates cost O(n) and are scalable to large datasets."
    }, {
      "heading" : "3.3. Analysis",
      "text" : "We provide an analysis of the expected target-domain risk of our approach, making use of the theory of domain adaptation (Ben-David et al., 2007; 2010; Mansour et al., 2009) and the theory of kernel embedding of probability distributions (Sriperumbudur et al., 2009; Gretton et al., 2012a;b).\nTheorem 1 Let θ ∈ H be a hypothesis, ǫs(θ) and ǫt(θ) be the expected risks of source and target respectively, then\nǫt(θ) 6 ǫs(θ) + 2dk(p, q) + C, (9)\nwhere C is a constant for the complexity of hypothesis space and the risk of an ideal hypothesis for both domains.\nProof sketch: A result from Ben-David et al. (2007) shows that ǫt(θ) 6 ǫs(θ) + dH(p, q) + C0, where dH(p, q) is the H-divergence between p and q, which is defined as\ndH(p, q) , 2 sup η∈H\n∣ ∣ ∣ ∣\nPr xs∼p [η(xs) = 1]− Pr xt∼q\n[ η(xt) = 1 ]\n∣ ∣ ∣ ∣ .\n(10) The H-divergence relies on the capacity of the hypothesis space H to distinguish distributions p from q, and η ∈ H can be viewed as a two-sample classifier. By choosing η as a (kernel) Parzen window classifier (Sriperumbudur et al., 2009), dH(p, q) can be bounded by the empirical estimate\ndH(p, q) 6 d̂H(Ds,Dt) + C1\n6 2 (\n1− inf η∈H\n[\nns ∑\ni=1\nL[η(xsi )=1] ns + nt ∑\nj=1\nL[η(xtj )=−1] nt\n])\n+C1\n= 2 (1 + dk(p, q)) + C1, (11)\nwhere L(·) is the linear loss function of the Parzen window classifier η, L[η = 1] , −η, L[η = −1] , η. By explicitly minimizing MK-MMD in multiple layers, the features and classifier learned by the proposed DAN model can decrease the upper bound on target risk. The source classifier and the two-sample classifier together provide a way to assess the adaptation performance, and can facilitate model selection. Note that we maximize MK-MMD w.r.t. β (7) to minimize Type II test error, and to help the Parzen window classifier achieve minimal risk of two-sample discrimination in (11)."
    }, {
      "heading" : "4. Experiments",
      "text" : "We compare the DAN model to state-of-the-art transfer learning and deep learning methods on both unsupervised and semi-supervised adaptation problems, focusing on the efficacy of multi-layer adaptation with multi-kernel MMD."
    }, {
      "heading" : "4.1. Setup",
      "text" : "Office-31 (Saenko et al., 2010) This dataset is a standard benchmark for domain adaptation. It consists of 4,652 images within 31 categories collected from three distinct domains: Amazon (A), which contains images downloaded from amazon.com, Webcam (W) and DSLR (D), which are images taken by web camera and digital SLR camera in an office with different environment variation, respectively. We evaluate our method across the 3 transfer tasks, A → W, D → W and W → D, which are commonly adopted in deep learning methods (Donahue et al., 2014; Tzeng et al., 2014). For completeness, we further include the evaluation on the other 3 transfer tasks, A → D, D → A and W → A. Office-10 + Caltech-10 (Gong et al., 2012). This dataset consists of the 10 common categories shared by the Office31 and Caltech-256 (C) (Griffin et al., 2007) datasets and is widely adopted in transfer learning methods (Long et al., 2013; Baktashmotlagh et al., 2013). We can build another 6 transfer tasks: A → C, W → C, D → C, C → A, C → W, and C → D. With more transfer tasks, we are targeting an unbiased look at the dataset bias (Torralba & Efros, 2011).\nWe compare to a variety of methods: TCA (Pan et al., 2011), GFK (Gong et al., 2012), CNN (Krizhevsky et al., 2012), LapCNN (Weston et al., 2008), and DDC (Tzeng et al., 2014). Specifically, TCA is a conventional transfer learning method based on MMD-regularized PCA. GFK is a widely-adopted method for our datasets which interpolates across intermediate subspaces to bridge the source and target. CNN was the leading method in the ImageNet 2012 competition, and it turns out to be a strong model for learning transferable features (Yosinski et al., 2014). LapCNN is a semi-supervised variant of CNN based on Laplacian graph regularization. Finally, DDC is a domain adaptation variant of CNN that adds an adaptation layer between the fc7 and fc8 layers that is regularized by single-kernel MMD. We implement the CNN-based methods, i.e., CNN, LapCNN, DDC, and DAN based on the Caffe (Jia et al., 2014) implementation of AlexNet (Krizhevsky et al., 2012) trained on the ImageNet dataset. In order to study the efficacy of multi-layer adaptation and multi-kernel MMD, we evaluate several variants of DAN: (1) DAN using only one hidden layer, either fc7 or fc8 for adaptation, termed DAN7 and DAN8 respectively; (2) DAN using single-kernel MMD for adaptation, termed DANSK.\nWe mainly follow standard evaluation protocol for unsupervised adaptation and use all source examples with labels and all target examples without labels (Gong et al., 2013). To make our results directly comparable to most published results, we report a classical protocol (Saenko et al., 2010) in that we randomly down-sample the source examples, and further require 3 labeled target examples per category\nfor semi-supervised adaptation. We compare the averages and standard errors of classification accuracy for each task. For baseline methods, we follow the standard procedures for model selection as explained in their respective papers. For MMD-based methods (i.e., TCA, DDC, and DAN), we use a Gaussian kernel k (xi,xj) = e−‖xi−xj‖ 2/γ with the bandwidth γ set to the median pairwise distances on the training data—the median heuristic (Gretton et al., 2012b). We use multi-kernel MMD for DAN, and consider a family of m Gaussian kernels {ku}mu=1 by varying bandwidth γu between 2−8γ and 28γ with a multiplicative step-size of 21/2 (Gretton et al., 2012b). As minimizing MMD is equivalent to maximizing the error of classifying the source from the target (two-sample classifier) (Sriperumbudur et al., 2009), we can automatically select the MMD penalty parameter λ on a validation set (comprised of source-labeled instances and target-unlabeled instances) by jointly assessing the test errors of the source classifier and the two-sample classifier. We use the finetuning architecture (Yosinski et al., 2014), however, due to limited training examples in our datasets, we fix convolutional layers conv1–conv3 that were copied from pretrained model, fine-tune conv4–conv5 and fully connected layers fc6–fc7, and train classifier layer fc8, both via back propagation. As the classifier is trained from scratch, we set its learning rate to be 10 times that of the lower layers. We use stochastic gradient descent (SGD) with 0.9 momentum and the learning rate annealing strategy implemented in Caffe, and cross-validate base learning rate between 10−5 and 10−2 with a multiplicative step-size 101/2."
    }, {
      "heading" : "4.2. Results and Discussion",
      "text" : "The unsupervised adaptation results on the first six Office31 transfer tasks are shown in Table 1, and the results on the other six Office-10 + Caltech-10 transfer tasks are shown in Table 2. To directly compare with DDC, we report semi-supervised adaptation results of the same tasks used by DDC in Table 3. We can observe that DAN significantly outperforms the comparison methods on most transfer tasks, and achieves comparable performance on the easy transfer tasks, D → W and W → D, where source and target are similar (Saenko et al., 2010). This is reasonable as the adaptability may vary across different transfer tasks. The performance boost demonstrates that our architecture of multi-layer adaptation via multi-kernel MMD is able to transfer pre-trained deep models across different domains.\nFrom the experimental results, we can make the following observations. (1) Deep learning based methods significantly outperform conventional shallow transfer learning methods by a large margin. (2) Among the deep learning methods, the semi-supervised LapCNN provides no improvement over CNN, suggesting that the challenge of domain discrepancy cannot be readily bridged by semi-\nsupervised learning. (3) DDC, a cross-domain variant of CNN with single-layer adaptation via single-kernel MMD, generally outperforms CNN, confirming its effectiveness in learning transferable features using domain-adaptive deep models. Note that while DDC based on Caffe AlexNet was shown to significantly outperform DeCAF (Donahue et al., 2014) in which fine-tuning was not carried out, it does not yield a large gain over Caffe AlexNet using fine-tuning. This shows the limitation of single-layer adaptation via single-kernel MMD, which cannot explore the strengths of deep networks and multiple kernels for domain adaptation.\nTo dive deeper into DAN, we present the results of three variants of DAN: (1) DAN7 and DAN8 achieve better accuracy than DDC, which highlights that multi-kernel MMD can bridge the domain discrepancy more effectively than single-kernel MMD. The reason is that multiple kernels with different bandwidths can match both the low-order moments and high-order moments to minimize the Type II\nerror (Gretton et al., 2012b). (2) DANSK also attains higher accuracy than DDC, which confirms the capability of deep architecture for distribution adaptation. The rationale is similar to that of deep networks: each layer of deep network is intended to extract features at a different abstraction level, and hence we need to match the distributions at each task-specific layer to consolidate the adaptation quality at all levels. The multi-layer architecture is one of the most critical contributors to the efficacy of deep learning, and we believe it is also important for MMD-based adaptation. The evidence of comparable performance between the multilayer variant DANSK and multi-kernel variants DAN7 and DAN8 shows their equal importance for domain adaptation. As expected, DAN obtains the best performance by jointly exploring multi-layer adaptation with multi-kernel MMD. Another benefit of DAN is that it uses a linear-time unbiased estimate of the kernel embedding, which makes it an order more efficient than existing methods TCA and DDC. Though Tzeng et al. (2014) speed up DDC by computing the MMD within each mini-batch of the SGD, this leads to a biased estimate of MMD and lower adaptation accuracy."
    }, {
      "heading" : "4.3. Empirical Analysis",
      "text" : "Feature Visualization To demonstrate the transferability of the DAN learned features, we follow Donahue et al. (2014) and Tzeng et al. (2014) and plot in Figures 2(a)– 2(b) and 2(c)–2(d) the t-SNE embeddings of the images\nin task C → W with DDC features and DAN features, respectively. We make the following observations: (1) With DDC features, the target points are not discriminated very well, while with DAN features, the points are discriminated much better. (2) With DDC features, the categories between the source and the target are not aligned very well, while with DAN features, the categories are aligned much better between domains. Both these observations can explain the superior performance of DAN over DDC: (1) implies that the target points are more easily discriminated with DAN features, and (2) implies that the target points can be better discriminated with the source classifier. DAN can learn more transferable features for effective domain adaptation.\nA-Distance A theoretical result in Ben-David et al. (2010) suggests A-distance as a measure of domain discrepancy. As computing the exact A-distance is intractable, an approximate distance is defined as d̂A = 2 (1− 2ǫ), where ǫ is the generalization error of a two-sample classifier (kernel SVM in our case) trained on the binary problem to distinguish input samples between the source and target domains. Figure 3(a) displays d̂A on transfer tasks A → W and C → W using Raw features, CNN features, and DAN features, respectively. It reveals a surprising observation that the d̂A on both CNN and DAN features are larger than the d̂A on Raw features. This implies that ab-\nstract deep features can be salient both for discriminating different categories and different domains, which is consistent with Glorot et al. (2011). However, domain adaptation may be deteriorated by the enlarged domain discrepancy (Ben-David et al., 2010). It is desirable that d̂A on DAN feature is smaller than d̂A on CNN feature, which guarantees more transferable features.\nParameter Sensitivity We investigate the effects of the parameter λ. Figure 3(b) gives an illustration of the variation of transfer classification performance as λ ∈ {0.1, 0.4, 0.7, 1, 1.4, 1.7, 2} on tasks A → W and C → W. We can observe that the DAN accuracy first increases and then decreases as λ varies and demonstrates a bell-shaped curve. This confirms the motivation of jointly learning deep features and adapting distribution discrepancy, since a good trade-off between them can enhance feature transferability."
    }, {
      "heading" : "5. Conclusion",
      "text" : "In this paper, we have proposed a novel Deep Adaptation Network (DAN) architecture to enhance the transferability of features from task-specific layers of the neural network. We confirm that while general features can generalize well to a novel task, specific features tailored to an original task cannot bridge the domain discrepancy effectively. We show that feature transferability can be enhanced substantially by mean-embedding matching of the multi-layer representations across domains in a reproducing kernel Hilbert space. An optimal multi-kernel selection strategy further improves the embedding matching effectiveness, while an unbiased estimate of the mean embedding naturally leads to a lineartime algorithm that is very desirable for deep learning from large-scale datasets. An extensive empirical evaluation on standard domain adaptation benchmarks demonstrates the efficacy of the proposed model against previous methods.\nAs deep features transition from general to specific along the network, it is interesting to study the principled way of deciding the boundary of generality and specificity, and the application of distribution adaptation to the convolutional layers of CNN to further enhance the feature transferability."
    }, {
      "heading" : "Acknowledgments",
      "text" : "This work was supported by the National Science Funds for Distinguished Young Scholars (No. 613250154), National Science and Technology Supporting Program Project (No. 2015BAH14F02), and Tsinghua TNList Fund for Big Data Science and Technology."
    } ],
    "references" : [ {
      "title" : "Domain-adversarial neural networks",
      "author" : [ "H. Ajakan", "P. Germain", "H. Larochelle", "F. Laviolette", "M. Marchand" ],
      "venue" : "In NIPS 2014 Workshop on Transfer and Multi-task learning: Theory Meets Practice,",
      "citeRegEx" : "Ajakan et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Ajakan et al\\.",
      "year" : 2014
    }, {
      "title" : "Unsupervised domain adaptation by domain invariant projection",
      "author" : [ "M. Baktashmotlagh", "M.T. Harandi", "B.C. Lovell", "M. Salzmann" ],
      "venue" : "In ICCV,",
      "citeRegEx" : "Baktashmotlagh et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Baktashmotlagh et al\\.",
      "year" : 2013
    }, {
      "title" : "Analysis of representations for domain adaptation",
      "author" : [ "S. Ben-David", "J. Blitzer", "K. Crammer", "F. Pereira" ],
      "venue" : null,
      "citeRegEx" : "Ben.David et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Ben.David et al\\.",
      "year" : 2007
    }, {
      "title" : "A theory of learning from different domains",
      "author" : [ "S. Ben-David", "J. Blitzer", "K. Crammer", "A. Kulesza", "F. Pereira", "J.W. Vaughan" ],
      "venue" : "Machine Learning,",
      "citeRegEx" : "Ben.David et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Ben.David et al\\.",
      "year" : 2010
    }, {
      "title" : "Representation learning: A review and new perspectives",
      "author" : [ "Y. Bengio", "A. Courville", "P. Vincent" ],
      "venue" : "IEEE Transactions on Pattern Analysis and Machine Intelligence,",
      "citeRegEx" : "Bengio et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Bengio et al\\.",
      "year" : 2013
    }, {
      "title" : "Marginalized denoising autoencoders for domain adaptation",
      "author" : [ "M. Chen", "Z. Xu", "K.Q. Weinberger", "F. Sha" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Chen et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Chen et al\\.",
      "year" : 2012
    }, {
      "title" : "Decaf: A deep convolutional activation feature for generic visual recognition",
      "author" : [ "J. Donahue", "Y. Jia", "O. Vinyals", "J. Hoffman", "N. Zhang", "E. Tzeng", "T. Darrell" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Donahue et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Donahue et al\\.",
      "year" : 2014
    }, {
      "title" : "Multi-source deep learning for information trustworthiness estimation",
      "author" : [ "L. Ge", "J. Gao", "X. Li", "A. Zhang" ],
      "venue" : "In KDD,",
      "citeRegEx" : "Ge et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Ge et al\\.",
      "year" : 2013
    }, {
      "title" : "Domain adaptive neural networks for object recognition",
      "author" : [ "M. Ghifary", "W.B. Kleijn", "M. Zhang" ],
      "venue" : "Technical report,",
      "citeRegEx" : "Ghifary et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Ghifary et al\\.",
      "year" : 2014
    }, {
      "title" : "Domain adaptation for large-scale sentiment classification: A deep learning approach",
      "author" : [ "X. Glorot", "A. Bordes", "Y. Bengio" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Glorot et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Glorot et al\\.",
      "year" : 2011
    }, {
      "title" : "Geodesic flow kernel for unsupervised domain adaptation",
      "author" : [ "B. Gong", "Y. Shi", "F. Sha", "K. Grauman" ],
      "venue" : "In CVPR,",
      "citeRegEx" : "Gong et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Gong et al\\.",
      "year" : 2012
    }, {
      "title" : "Connecting the dots with landmarks: Discriminatively learning domain-invariant features for unsupervised domain adaptation",
      "author" : [ "B. Gong", "K. Grauman", "F. Sha" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Gong et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Gong et al\\.",
      "year" : 2013
    }, {
      "title" : "A kernel two-sample test",
      "author" : [ "A. Gretton", "K. Borgwardt", "M. Rasch", "B. Schölkopf", "A. Smola" ],
      "venue" : "Journal of Machine Learning Research,",
      "citeRegEx" : "Gretton et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Gretton et al\\.",
      "year" : 2012
    }, {
      "title" : "Optimal kernel choice for large-scale two-sample tests",
      "author" : [ "A. Gretton", "B. Sriperumbudur", "D. Sejdinovic", "H. Strathmann", "S. Balakrishnan", "M. Pontil", "K. Fukumizu" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Gretton et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Gretton et al\\.",
      "year" : 2012
    }, {
      "title" : "Caltech-256 object category dataset",
      "author" : [ "G. Griffin", "A. Holub", "P. Perona" ],
      "venue" : "Technical report, California Institute of Technology,",
      "citeRegEx" : "Griffin et al\\.,? \\Q2007\\E",
      "shortCiteRegEx" : "Griffin et al\\.",
      "year" : 2007
    }, {
      "title" : "Improving neural networks by preventing co-adaptation of feature detectors",
      "author" : [ "G.E. Hinton", "N. Srivastava", "A. Krizhevsky", "I. Sutskever", "R.R. Salakhutdinov" ],
      "venue" : "Technical report,",
      "citeRegEx" : "Hinton et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Hinton et al\\.",
      "year" : 2012
    }, {
      "title" : "LSDA: Large scale detection through adaptation",
      "author" : [ "J. Hoffman", "S. Guadarrama", "E. Tzeng", "R. Hu", "J. Donahue", "R. Girshick", "T. Darrell", "K. Saenko" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Hoffman et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Hoffman et al\\.",
      "year" : 2014
    }, {
      "title" : "Caffe: Convolutional architecture for fast feature embedding",
      "author" : [ "Y. Jia", "E. Shelhamer", "J. Donahue", "S. Karayev", "J. Long", "R. Girshick", "S. Guadarrama", "T. Darrell" ],
      "venue" : "In ACM Multimedia,",
      "citeRegEx" : "Jia et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Jia et al\\.",
      "year" : 2014
    }, {
      "title" : "Imagenet classification with deep convolutional neural networks",
      "author" : [ "A. Krizhevsky", "I. Sutskever", "G.E. Hinton" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Krizhevsky et al\\.,? \\Q2012\\E",
      "shortCiteRegEx" : "Krizhevsky et al\\.",
      "year" : 2012
    }, {
      "title" : "Transfer feature learning with joint distribution adaptation",
      "author" : [ "M. Long", "J. Wang", "G. Ding", "J. Sun", "P.S. Yu" ],
      "venue" : "In ICCV,",
      "citeRegEx" : "Long et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Long et al\\.",
      "year" : 2013
    }, {
      "title" : "Domain adaptation: Learning bounds and algorithms",
      "author" : [ "Y. Mansour", "M. Mohri", "A. Rostamizadeh" ],
      "venue" : "COLT,",
      "citeRegEx" : "Mansour et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Mansour et al\\.",
      "year" : 2009
    }, {
      "title" : "Multimodal deep learning",
      "author" : [ "J. Ngiam", "A. Khosla", "M. Kim", "J. Nam", "H. Lee", "A.Y. Ng" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Ngiam et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Ngiam et al\\.",
      "year" : 2011
    }, {
      "title" : "A survey on transfer learning",
      "author" : [ "S.J. Pan", "Q. Yang" ],
      "venue" : "IEEE Transactions on Knowledge and Data Engineering,",
      "citeRegEx" : "Pan and Yang,? \\Q2010\\E",
      "shortCiteRegEx" : "Pan and Yang",
      "year" : 2010
    }, {
      "title" : "Domain adaptation via transfer component analysis",
      "author" : [ "S.J. Pan", "I.W. Tsang", "J.T. Kwok", "Q. Yang" ],
      "venue" : "IEEE Transactions on Neural Networks and Learning Systems,",
      "citeRegEx" : "Pan et al\\.,? \\Q2011\\E",
      "shortCiteRegEx" : "Pan et al\\.",
      "year" : 2011
    }, {
      "title" : "Adapting visual category models to new domains",
      "author" : [ "K. Saenko", "B. Kulis", "M. Fritz", "T. Darrell" ],
      "venue" : "In ECCV,",
      "citeRegEx" : "Saenko et al\\.,? \\Q2010\\E",
      "shortCiteRegEx" : "Saenko et al\\.",
      "year" : 2010
    }, {
      "title" : "Equivalence of distance-based and rkhs-based statistics in hypothesis testing",
      "author" : [ "D. Sejdinovic", "B. Sriperumbudur", "A. Gretton", "K. Fukumizu" ],
      "venue" : "The Annals of Statistics,",
      "citeRegEx" : "Sejdinovic et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Sejdinovic et al\\.",
      "year" : 2013
    }, {
      "title" : "Kernel choice and classifiability for rkhs embeddings of probability distributions",
      "author" : [ "B.K. Sriperumbudur", "K. Fukumizu", "A. Gretton", "G. Lanckriet", "B. Schölkopf" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Sriperumbudur et al\\.,? \\Q2009\\E",
      "shortCiteRegEx" : "Sriperumbudur et al\\.",
      "year" : 2009
    }, {
      "title" : "Unbiased look at dataset bias",
      "author" : [ "A. Torralba", "A.A. Efros" ],
      "venue" : "In CVPR,",
      "citeRegEx" : "Torralba and Efros,? \\Q2011\\E",
      "shortCiteRegEx" : "Torralba and Efros",
      "year" : 2011
    }, {
      "title" : "Deep domain confusion: Maximizing for domain invariance",
      "author" : [ "E. Tzeng", "J. Hoffman", "N. Zhang", "K. Saenko", "T. Darrell" ],
      "venue" : "Technical report,",
      "citeRegEx" : "Tzeng et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Tzeng et al\\.",
      "year" : 2014
    }, {
      "title" : "Flexible transfer learning under support and model shift",
      "author" : [ "X. Wang", "J. Schneider" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Wang and Schneider,? \\Q2014\\E",
      "shortCiteRegEx" : "Wang and Schneider",
      "year" : 2014
    }, {
      "title" : "Deep learning via semisupervised embedding",
      "author" : [ "J. Weston", "F. Rattle", "R. Collobert" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Weston et al\\.,? \\Q2008\\E",
      "shortCiteRegEx" : "Weston et al\\.",
      "year" : 2008
    }, {
      "title" : "How transferable are features in deep neural networks",
      "author" : [ "J. Yosinski", "J. Clune", "Y. Bengio", "H. Lipson" ],
      "venue" : "In NIPS,",
      "citeRegEx" : "Yosinski et al\\.,? \\Q2014\\E",
      "shortCiteRegEx" : "Yosinski et al\\.",
      "year" : 2014
    }, {
      "title" : "Domain adaptation under target and conditional shift",
      "author" : [ "K. Zhang", "B. Schölkopf", "K. Muandet", "Z. Wang" ],
      "venue" : "In ICML,",
      "citeRegEx" : "Zhang et al\\.,? \\Q2013\\E",
      "shortCiteRegEx" : "Zhang et al\\.",
      "year" : 2013
    } ],
    "referenceMentions" : [ {
      "referenceID" : 23,
      "context" : "In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014).",
      "startOffset" : 152,
      "endOffset" : 303
    }, {
      "referenceID" : 19,
      "context" : "In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014).",
      "startOffset" : 152,
      "endOffset" : 303
    }, {
      "referenceID" : 1,
      "context" : "In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014).",
      "startOffset" : 152,
      "endOffset" : 303
    }, {
      "referenceID" : 11,
      "context" : "In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014).",
      "startOffset" : 152,
      "endOffset" : 303
    }, {
      "referenceID" : 32,
      "context" : "In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014).",
      "startOffset" : 152,
      "endOffset" : 303
    }, {
      "referenceID" : 8,
      "context" : "In this direction, a fruitful line of prior work has focused on learning shallow features by jointly minimizing a distance metric of domain discrepancy (Pan et al., 2011; Long et al., 2013; Baktashmotlagh et al., 2013; Gong et al., 2013; Zhang et al., 2013; Ghifary et al., 2014; Wang & Schneider, 2014).",
      "startOffset" : 152,
      "endOffset" : 303
    }, {
      "referenceID" : 9,
      "context" : "However, recent studies have shown that deep neural networks can learn more transferable features for domain adaptation (Glorot et al., 2011; Donahue et al., 2014; Yosinski et al., 2014), which produce breakthrough results on some domain adaptation datasets.",
      "startOffset" : 120,
      "endOffset" : 186
    }, {
      "referenceID" : 6,
      "context" : "However, recent studies have shown that deep neural networks can learn more transferable features for domain adaptation (Glorot et al., 2011; Donahue et al., 2014; Yosinski et al., 2014), which produce breakthrough results on some domain adaptation datasets.",
      "startOffset" : 120,
      "endOffset" : 186
    }, {
      "referenceID" : 31,
      "context" : "However, recent studies have shown that deep neural networks can learn more transferable features for domain adaptation (Glorot et al., 2011; Donahue et al., 2014; Yosinski et al., 2014), which produce breakthrough results on some domain adaptation datasets.",
      "startOffset" : 120,
      "endOffset" : 186
    }, {
      "referenceID" : 31,
      "context" : "In other words, the features computed in higher layers of the network must depend greatly on the specific dataset and task (Yosinski et al., 2014), which are task-specific features and are not safely transferable to",
      "startOffset" : 123,
      "endOffset" : 146
    }, {
      "referenceID" : 9,
      "context" : "Another curious phenomenon is that disentangling the variational factors in higher layers of the network may enlarge the domain discrepancy, as different domains with the new deep representations become more “compact” and are more mutually distinguishable (Glorot et al., 2011).",
      "startOffset" : 256,
      "endOffset" : 277
    }, {
      "referenceID" : 20,
      "context" : "Although deep features are salient for discrimination, enlarged dataset bias may deteriorate domain adaptation performance, resulting in statistically unbounded risk for the target tasks (Mansour et al., 2009; Ben-David et al., 2010).",
      "startOffset" : 187,
      "endOffset" : 233
    }, {
      "referenceID" : 3,
      "context" : "Although deep features are salient for discrimination, enlarged dataset bias may deteriorate domain adaptation performance, resulting in statistically unbounded risk for the target tasks (Mansour et al., 2009; Ben-David et al., 2010).",
      "startOffset" : 187,
      "endOffset" : 233
    }, {
      "referenceID" : 31,
      "context" : ", 2014) are representative for generalpurpose tasks (Yosinski et al., 2014; Hoffman et al., 2014), the proposed DAN model is trained by fine-tuning from the AlexNet model (Krizhevsky et al.",
      "startOffset" : 52,
      "endOffset" : 97
    }, {
      "referenceID" : 16,
      "context" : ", 2014) are representative for generalpurpose tasks (Yosinski et al., 2014; Hoffman et al., 2014), the proposed DAN model is trained by fine-tuning from the AlexNet model (Krizhevsky et al.",
      "startOffset" : 52,
      "endOffset" : 97
    }, {
      "referenceID" : 18,
      "context" : ", 2014), the proposed DAN model is trained by fine-tuning from the AlexNet model (Krizhevsky et al., 2012) pre-trained on ImageNet, which is implemented in Caffe (Jia et al.",
      "startOffset" : 81,
      "endOffset" : 106
    }, {
      "referenceID" : 17,
      "context" : ", 2012) pre-trained on ImageNet, which is implemented in Caffe (Jia et al., 2014).",
      "startOffset" : 63,
      "endOffset" : 81
    }, {
      "referenceID" : 23,
      "context" : "Transfer learning aims to mitigate the effort of manual labeling for machine learning (Pan et al., 2011; Gong et al., 2013; Zhang et al., 2013; Wang & Schneider, 2014) and computer vision (Saenko et al.",
      "startOffset" : 86,
      "endOffset" : 167
    }, {
      "referenceID" : 11,
      "context" : "Transfer learning aims to mitigate the effort of manual labeling for machine learning (Pan et al., 2011; Gong et al., 2013; Zhang et al., 2013; Wang & Schneider, 2014) and computer vision (Saenko et al.",
      "startOffset" : 86,
      "endOffset" : 167
    }, {
      "referenceID" : 32,
      "context" : "Transfer learning aims to mitigate the effort of manual labeling for machine learning (Pan et al., 2011; Gong et al., 2013; Zhang et al., 2013; Wang & Schneider, 2014) and computer vision (Saenko et al.",
      "startOffset" : 86,
      "endOffset" : 167
    }, {
      "referenceID" : 24,
      "context" : ", 2013; Wang & Schneider, 2014) and computer vision (Saenko et al., 2010; Gong et al., 2012; Baktashmotlagh et al., 2013; Long et al., 2013), etc.",
      "startOffset" : 52,
      "endOffset" : 140
    }, {
      "referenceID" : 10,
      "context" : ", 2013; Wang & Schneider, 2014) and computer vision (Saenko et al., 2010; Gong et al., 2012; Baktashmotlagh et al., 2013; Long et al., 2013), etc.",
      "startOffset" : 52,
      "endOffset" : 140
    }, {
      "referenceID" : 1,
      "context" : ", 2013; Wang & Schneider, 2014) and computer vision (Saenko et al., 2010; Gong et al., 2012; Baktashmotlagh et al., 2013; Long et al., 2013), etc.",
      "startOffset" : 52,
      "endOffset" : 140
    }, {
      "referenceID" : 19,
      "context" : ", 2013; Wang & Schneider, 2014) and computer vision (Saenko et al., 2010; Gong et al., 2012; Baktashmotlagh et al., 2013; Long et al., 2013), etc.",
      "startOffset" : 52,
      "endOffset" : 140
    }, {
      "referenceID" : 4,
      "context" : "Deep neural networks learn nonlinear representations that disentangle and hide different explanatory factors of variation behind data samples (Bengio et al., 2013).",
      "startOffset" : 142,
      "endOffset" : 163
    }, {
      "referenceID" : 31,
      "context" : "The learned deep representations manifest invariant factors underlying different populations and are transferable from the original tasks to similar novel tasks (Yosinski et al., 2014).",
      "startOffset" : 161,
      "endOffset" : 184
    }, {
      "referenceID" : 9,
      "context" : "Hence, deep neural networks have been explored for domain adaptation (Glorot et al., 2011; Chen et al., 2012), multimodal and multi-source learning problems (Ngiam et al.",
      "startOffset" : 69,
      "endOffset" : 109
    }, {
      "referenceID" : 5,
      "context" : "Hence, deep neural networks have been explored for domain adaptation (Glorot et al., 2011; Chen et al., 2012), multimodal and multi-source learning problems (Ngiam et al.",
      "startOffset" : 69,
      "endOffset" : 109
    }, {
      "referenceID" : 21,
      "context" : ", 2012), multimodal and multi-source learning problems (Ngiam et al., 2011; Ge et al., 2013), where significant performance gains have been obtained.",
      "startOffset" : 55,
      "endOffset" : 92
    }, {
      "referenceID" : 7,
      "context" : ", 2012), multimodal and multi-source learning problems (Ngiam et al., 2011; Ge et al., 2013), where significant performance gains have been obtained.",
      "startOffset" : 55,
      "endOffset" : 92
    }, {
      "referenceID" : 9,
      "context" : "In reality, the domain discrepancy can be alleviated, but not removed, by deep neural networks (Glorot et al., 2011).",
      "startOffset" : 95,
      "endOffset" : 116
    }, {
      "referenceID" : 20,
      "context" : "Dataset shift has posed a bottleneck to the transferability of deep networks, resulting in statistically unbounded risk for target tasks (Mansour et al., 2009; Ben-David et al., 2010).",
      "startOffset" : 137,
      "endOffset" : 183
    }, {
      "referenceID" : 3,
      "context" : "Dataset shift has posed a bottleneck to the transferability of deep networks, resulting in statistically unbounded risk for target tasks (Mansour et al., 2009; Ben-David et al., 2010).",
      "startOffset" : 137,
      "endOffset" : 183
    }, {
      "referenceID" : 0,
      "context" : "There are several very recent efforts in learning domain-invariant features in the context of shallow neural networks (Ajakan et al., 2014; Ghifary et al., 2014).",
      "startOffset" : 118,
      "endOffset" : 161
    }, {
      "referenceID" : 8,
      "context" : "There are several very recent efforts in learning domain-invariant features in the context of shallow neural networks (Ajakan et al., 2014; Ghifary et al., 2014).",
      "startOffset" : 118,
      "endOffset" : 161
    }, {
      "referenceID" : 18,
      "context" : "Due to the limited capacity of shallow architectures, the performance of these proposals does not surpass deep CNN (Krizhevsky et al., 2012).",
      "startOffset" : 115,
      "endOffset" : 140
    }, {
      "referenceID" : 31,
      "context" : "While performance was improved, DDC only adapts a single layer of the network, which may be restrictive in that there are multiple layers where the hidden features are not transferable (Yosinski et al., 2014).",
      "startOffset" : 185,
      "endOffset" : 208
    }, {
      "referenceID" : 25,
      "context" : "Our work is primarily motivated by Yosinski et al. (2014), which comprehensively explores feature transferability of deep convolutional neural networks.",
      "startOffset" : 35,
      "endOffset" : 58
    }, {
      "referenceID" : 0,
      "context" : "There are several very recent efforts in learning domain-invariant features in the context of shallow neural networks (Ajakan et al., 2014; Ghifary et al., 2014). Due to the limited capacity of shallow architectures, the performance of these proposals does not surpass deep CNN (Krizhevsky et al., 2012). Tzeng et al. (2014) proposed a DDC model that adds an adaptation layer and a dataset shift loss to the deep CNN for learning a domain-invariant representation.",
      "startOffset" : 119,
      "endOffset" : 325
    }, {
      "referenceID" : 3,
      "context" : "To approach this problem, many existing methods aim to bound the target error by the source error plus a discrepancy metric between the source and the target (Ben-David et al., 2010).",
      "startOffset" : 158,
      "endOffset" : 182
    }, {
      "referenceID" : 25,
      "context" : "Two classes of statistics have been explored for the two-sample testing, where acceptance or rejection decisions are made for a null hypothesis p = q, given samples generated respectively from p and q: energy distances and maximum mean discrepancies (MMD) (Sejdinovic et al., 2013).",
      "startOffset" : 256,
      "endOffset" : 281
    }, {
      "referenceID" : 2,
      "context" : "To approach this problem, many existing methods aim to bound the target error by the source error plus a discrepancy metric between the source and the target (Ben-David et al., 2010). Two classes of statistics have been explored for the two-sample testing, where acceptance or rejection decisions are made for a null hypothesis p = q, given samples generated respectively from p and q: energy distances and maximum mean discrepancies (MMD) (Sejdinovic et al., 2013). In this paper, we focus on the multiple kernel variant of MMD (MK-MMD) proposed by Gretton et al. (2012b), which is formalized to jointly maximize the two-sample test power and minimize the Type II error, i.",
      "startOffset" : 159,
      "endOffset" : 573
    }, {
      "referenceID" : 12,
      "context" : "As studied theoretically in Gretton et al. (2012b), the kernel MK-",
      "startOffset" : 28,
      "endOffset" : 51
    }, {
      "referenceID" : 3,
      "context" : "One of the feasible strategies for controlling the domain discrepancy is to find an abstract feature representation through which the source and target domains are similar (Ben-David et al., 2010).",
      "startOffset" : 172,
      "endOffset" : 196
    }, {
      "referenceID" : 23,
      "context" : "Although this idea has been explored in several papers (Pan et al., 2011; Zhang et al., 2013; Wang & Schneider, 2014), to date there has been no attempt to enhance the transferability of feature representation via MK-MMD in deep neural networks.",
      "startOffset" : 55,
      "endOffset" : 117
    }, {
      "referenceID" : 32,
      "context" : "Although this idea has been explored in several papers (Pan et al., 2011; Zhang et al., 2013; Wang & Schneider, 2014), to date there has been no attempt to enhance the transferability of feature representation via MK-MMD in deep neural networks.",
      "startOffset" : 55,
      "endOffset" : 117
    }, {
      "referenceID" : 18,
      "context" : "We start with deep convolutional neural networks (CNN) (Krizhevsky et al., 2012), a strong model when it is adapted to novel tasks (Donahue et al.",
      "startOffset" : 55,
      "endOffset" : 80
    }, {
      "referenceID" : 6,
      "context" : ", 2012), a strong model when it is adapted to novel tasks (Donahue et al., 2014; Hoffman et al., 2014).",
      "startOffset" : 58,
      "endOffset" : 102
    }, {
      "referenceID" : 16,
      "context" : ", 2012), a strong model when it is adapted to novel tasks (Donahue et al., 2014; Hoffman et al., 2014).",
      "startOffset" : 58,
      "endOffset" : 102
    }, {
      "referenceID" : 18,
      "context" : "We extend the AlexNet architecture (Krizhevsky et al., 2012), which is comprised of five convolutional layers (conv1–conv5) and three fully connected layers (fc6– fc8).",
      "startOffset" : 35,
      "endOffset" : 60
    }, {
      "referenceID" : 31,
      "context" : "We will not discuss how to compute the convolutional layers as we will not impose distribution-adaptation regularization in those layers, given that the convolutional layers can learn generic features that tend to be transferable in layers conv1–conv3 and are slightly domain-biased in conv4–conv5 (Yosinski et al., 2014).",
      "startOffset" : 298,
      "endOffset" : 321
    }, {
      "referenceID" : 15,
      "context" : "Hence, when adapting the pre-trained AlexNet to the target, we opt to freeze conv1–conv3 and fine-tune conv4–conv5 to preserve the efficacy of fragile co-adaptation (Hinton et al., 2012).",
      "startOffset" : 165,
      "endOffset" : 186
    }, {
      "referenceID" : 31,
      "context" : "In standard CNNs, deep features must eventually transition from general to specific by the last layer of the network, and the transferability gap grows with the domain discrepancy and becomes particularly large when transferring the higher layers fc6–fc8 (Yosinski et al., 2014).",
      "startOffset" : 255,
      "endOffset" : 278
    }, {
      "referenceID" : 31,
      "context" : "As revealed by (Yosinski et al., 2014), feature transferability gets worse on conv4–conv5 and significantly drops on fc6–fc8, hence it is critical to adapt multiple layers instead of only one layer.",
      "startOffset" : 15,
      "endOffset" : 38
    }, {
      "referenceID" : 32,
      "context" : "Another benefit of multi-layer adaptation is that by jointly adapting the representation layers and the classifier layer, we could essentially bridge the domain discrepancy underlying both the marginal distribution and the conditional distribution, which is crucial for domain adaptation (Zhang et al., 2013).",
      "startOffset" : 288,
      "endOffset" : 308
    }, {
      "referenceID" : 29,
      "context" : "Training a deep CNN requires a large amount of labeled data, which is prohibitive for many domain adaptation problems, hence we start with an AlexNet model pretrained on ImageNet 2012 and fine-tune it as in Yosinski et al. (2014). With the proposed DAN optimization framework (4), we are able to learn transferable features from a source domain to a related target domain.",
      "startOffset" : 207,
      "endOffset" : 230
    }, {
      "referenceID" : 12,
      "context" : "As pointed out by Gretton et al. (2012b), kernel choice is critical to the testing power of MMD since different kernels may embed probability distributions in different RKHSs where different orders of sufficient statistics can be emphasized.",
      "startOffset" : 18,
      "endOffset" : 41
    }, {
      "referenceID" : 23,
      "context" : "While prior work based on MMD (Pan et al., 2011; Tzeng et al., 2014) rarely addresses this issue, we believe it is critical in the context of deep learning.",
      "startOffset" : 30,
      "endOffset" : 68
    }, {
      "referenceID" : 28,
      "context" : "While prior work based on MMD (Pan et al., 2011; Tzeng et al., 2014) rarely addresses this issue, we believe it is critical in the context of deep learning.",
      "startOffset" : 30,
      "endOffset" : 68
    }, {
      "referenceID" : 17,
      "context" : "Such a mini-batch SGD can be easily implemented within the Caffe framework for CNNs (Jia et al., 2014).",
      "startOffset" : 84,
      "endOffset" : 102
    }, {
      "referenceID" : 2,
      "context" : "We provide an analysis of the expected target-domain risk of our approach, making use of the theory of domain adaptation (Ben-David et al., 2007; 2010; Mansour et al., 2009) and the theory of kernel embedding of probability distributions (Sriperumbudur et al.",
      "startOffset" : 121,
      "endOffset" : 173
    }, {
      "referenceID" : 20,
      "context" : "We provide an analysis of the expected target-domain risk of our approach, making use of the theory of domain adaptation (Ben-David et al., 2007; 2010; Mansour et al., 2009) and the theory of kernel embedding of probability distributions (Sriperumbudur et al.",
      "startOffset" : 121,
      "endOffset" : 173
    }, {
      "referenceID" : 2,
      "context" : "Proof sketch: A result from Ben-David et al. (2007) shows that ǫt(θ) 6 ǫs(θ) + dH(p, q) + C0, where dH(p, q) is the H-divergence between p and q, which is defined as",
      "startOffset" : 28,
      "endOffset" : 52
    }, {
      "referenceID" : 26,
      "context" : "By choosing η as a (kernel) Parzen window classifier (Sriperumbudur et al., 2009), dH(p, q) can be bounded by the empirical estimate",
      "startOffset" : 53,
      "endOffset" : 81
    }, {
      "referenceID" : 24,
      "context" : "Office-31 (Saenko et al., 2010) This dataset is a standard benchmark for domain adaptation.",
      "startOffset" : 10,
      "endOffset" : 31
    }, {
      "referenceID" : 6,
      "context" : "We evaluate our method across the 3 transfer tasks, A → W, D → W and W → D, which are commonly adopted in deep learning methods (Donahue et al., 2014; Tzeng et al., 2014).",
      "startOffset" : 128,
      "endOffset" : 170
    }, {
      "referenceID" : 28,
      "context" : "We evaluate our method across the 3 transfer tasks, A → W, D → W and W → D, which are commonly adopted in deep learning methods (Donahue et al., 2014; Tzeng et al., 2014).",
      "startOffset" : 128,
      "endOffset" : 170
    }, {
      "referenceID" : 10,
      "context" : "Office-10 + Caltech-10 (Gong et al., 2012).",
      "startOffset" : 23,
      "endOffset" : 42
    }, {
      "referenceID" : 14,
      "context" : "This dataset consists of the 10 common categories shared by the Office31 and Caltech-256 (C) (Griffin et al., 2007) datasets and is widely adopted in transfer learning methods (Long et al.",
      "startOffset" : 93,
      "endOffset" : 115
    }, {
      "referenceID" : 19,
      "context" : ", 2007) datasets and is widely adopted in transfer learning methods (Long et al., 2013; Baktashmotlagh et al., 2013).",
      "startOffset" : 68,
      "endOffset" : 116
    }, {
      "referenceID" : 1,
      "context" : ", 2007) datasets and is widely adopted in transfer learning methods (Long et al., 2013; Baktashmotlagh et al., 2013).",
      "startOffset" : 68,
      "endOffset" : 116
    }, {
      "referenceID" : 23,
      "context" : "We compare to a variety of methods: TCA (Pan et al., 2011), GFK (Gong et al.",
      "startOffset" : 40,
      "endOffset" : 58
    }, {
      "referenceID" : 10,
      "context" : ", 2011), GFK (Gong et al., 2012), CNN (Krizhevsky et al.",
      "startOffset" : 13,
      "endOffset" : 32
    }, {
      "referenceID" : 18,
      "context" : ", 2012), CNN (Krizhevsky et al., 2012), LapCNN (Weston et al.",
      "startOffset" : 13,
      "endOffset" : 38
    }, {
      "referenceID" : 30,
      "context" : ", 2012), LapCNN (Weston et al., 2008), and DDC (Tzeng et al.",
      "startOffset" : 16,
      "endOffset" : 37
    }, {
      "referenceID" : 28,
      "context" : ", 2008), and DDC (Tzeng et al., 2014).",
      "startOffset" : 17,
      "endOffset" : 37
    }, {
      "referenceID" : 31,
      "context" : "CNN was the leading method in the ImageNet 2012 competition, and it turns out to be a strong model for learning transferable features (Yosinski et al., 2014).",
      "startOffset" : 134,
      "endOffset" : 157
    }, {
      "referenceID" : 17,
      "context" : ", CNN, LapCNN, DDC, and DAN based on the Caffe (Jia et al., 2014) implementation of AlexNet (Krizhevsky et al.",
      "startOffset" : 47,
      "endOffset" : 65
    }, {
      "referenceID" : 18,
      "context" : ", 2014) implementation of AlexNet (Krizhevsky et al., 2012) trained on the ImageNet dataset.",
      "startOffset" : 34,
      "endOffset" : 59
    }, {
      "referenceID" : 11,
      "context" : "We mainly follow standard evaluation protocol for unsupervised adaptation and use all source examples with labels and all target examples without labels (Gong et al., 2013).",
      "startOffset" : 153,
      "endOffset" : 172
    }, {
      "referenceID" : 24,
      "context" : "To make our results directly comparable to most published results, we report a classical protocol (Saenko et al., 2010) in that we randomly down-sample the source examples, and further require 3 labeled target examples per category for semi-supervised adaptation.",
      "startOffset" : 98,
      "endOffset" : 119
    }, {
      "referenceID" : 26,
      "context" : "As minimizing MMD is equivalent to maximizing the error of classifying the source from the target (two-sample classifier) (Sriperumbudur et al., 2009), we can automatically select the MMD penalty parameter λ on a validation set (comprised of source-labeled instances and target-unlabeled instances) by jointly assessing the test errors of the source classifier and the two-sample classifier.",
      "startOffset" : 122,
      "endOffset" : 150
    }, {
      "referenceID" : 31,
      "context" : "We use the finetuning architecture (Yosinski et al., 2014), however, due to limited training examples in our datasets, we fix convolutional layers conv1–conv3 that were copied from pretrained model, fine-tune conv4–conv5 and fully connected layers fc6–fc7, and train classifier layer fc8, both via back propagation.",
      "startOffset" : 35,
      "endOffset" : 58
    }, {
      "referenceID" : 24,
      "context" : "We can observe that DAN significantly outperforms the comparison methods on most transfer tasks, and achieves comparable performance on the easy transfer tasks, D → W and W → D, where source and target are similar (Saenko et al., 2010).",
      "startOffset" : 214,
      "endOffset" : 235
    }, {
      "referenceID" : 11,
      "context" : "Accuracy on Office-31 dataset with standard unsupervised adaptation protocol (Gong et al., 2013).",
      "startOffset" : 77,
      "endOffset" : 96
    }, {
      "referenceID" : 11,
      "context" : "Accuracy on Office-10 + Caltech-10 dataset with standard unsupervised adaptation protocol (Gong et al., 2013).",
      "startOffset" : 90,
      "endOffset" : 109
    }, {
      "referenceID" : 24,
      "context" : "Accuracy on Office-31 dataset with classic unsupervised and semi-supervised adaptation protocols (Saenko et al., 2010).",
      "startOffset" : 97,
      "endOffset" : 118
    }, {
      "referenceID" : 6,
      "context" : "Note that while DDC based on Caffe AlexNet was shown to significantly outperform DeCAF (Donahue et al., 2014) in which fine-tuning was not carried out, it does not yield a large gain over Caffe AlexNet using fine-tuning.",
      "startOffset" : 87,
      "endOffset" : 109
    }, {
      "referenceID" : 12,
      "context" : "The reason is that multiple kernels with different bandwidths can match both the low-order moments and high-order moments to minimize the Type II error (Gretton et al., 2012b). (2) DANSK also attains higher accuracy than DDC, which confirms the capability of deep architecture for distribution adaptation. The rationale is similar to that of deep networks: each layer of deep network is intended to extract features at a different abstraction level, and hence we need to match the distributions at each task-specific layer to consolidate the adaptation quality at all levels. The multi-layer architecture is one of the most critical contributors to the efficacy of deep learning, and we believe it is also important for MMD-based adaptation. The evidence of comparable performance between the multilayer variant DANSK and multi-kernel variants DAN7 and DAN8 shows their equal importance for domain adaptation. As expected, DAN obtains the best performance by jointly exploring multi-layer adaptation with multi-kernel MMD. Another benefit of DAN is that it uses a linear-time unbiased estimate of the kernel embedding, which makes it an order more efficient than existing methods TCA and DDC. Though Tzeng et al. (2014) speed up DDC by computing the MMD within each mini-batch of the SGD, this leads to a biased estimate of MMD and lower adaptation accuracy.",
      "startOffset" : 153,
      "endOffset" : 1220
    }, {
      "referenceID" : 6,
      "context" : "Feature Visualization To demonstrate the transferability of the DAN learned features, we follow Donahue et al. (2014) and Tzeng et al.",
      "startOffset" : 96,
      "endOffset" : 118
    }, {
      "referenceID" : 6,
      "context" : "Feature Visualization To demonstrate the transferability of the DAN learned features, we follow Donahue et al. (2014) and Tzeng et al. (2014) and plot in Figures 2(a)– 2(b) and 2(c)–2(d) the t-SNE embeddings of the images",
      "startOffset" : 96,
      "endOffset" : 142
    }, {
      "referenceID" : 3,
      "context" : "However, domain adaptation may be deteriorated by the enlarged domain discrepancy (Ben-David et al., 2010).",
      "startOffset" : 82,
      "endOffset" : 106
    }, {
      "referenceID" : 2,
      "context" : "A-Distance A theoretical result in Ben-David et al. (2010) suggests A-distance as a measure of domain discrepancy.",
      "startOffset" : 35,
      "endOffset" : 59
    }, {
      "referenceID" : 2,
      "context" : "A-Distance A theoretical result in Ben-David et al. (2010) suggests A-distance as a measure of domain discrepancy. As computing the exact A-distance is intractable, an approximate distance is defined as d̂A = 2 (1− 2ǫ), where ǫ is the generalization error of a two-sample classifier (kernel SVM in our case) trained on the binary problem to distinguish input samples between the source and target domains. Figure 3(a) displays d̂A on transfer tasks A → W and C → W using Raw features, CNN features, and DAN features, respectively. It reveals a surprising observation that the d̂A on both CNN and DAN features are larger than the d̂A on Raw features. This implies that abstract deep features can be salient both for discriminating different categories and different domains, which is consistent with Glorot et al. (2011). However, domain adaptation may be deteriorated by the enlarged domain discrepancy (Ben-David et al.",
      "startOffset" : 35,
      "endOffset" : 820
    } ],
    "year" : 2015,
    "abstractText" : "Recent studies reveal that a deep neural network can learn transferable features which generalize well to novel tasks for domain adaptation. However, as deep features eventually transition from general to specific along the network, the feature transferability drops significantly in higher layers with increasing domain discrepancy. Hence, it is important to formally reduce the dataset bias and enhance the transferability in task-specific layers. In this paper, we propose a new Deep Adaptation Network (DAN) architecture, which generalizes deep convolutional neural network to the domain adaptation scenario. In DAN, hidden representations of all task-specific layers are embedded in a reproducing kernel Hilbert space where the mean embeddings of different domain distributions can be explicitly matched. The domain discrepancy is further reduced using an optimal multi-kernel selection method for mean embedding matching. DAN can learn transferable features with statistical guarantees, and can scale linearly by unbiased estimate of kernel embedding. Extensive empirical evidence shows that the proposed architecture yields state-of-the-art image classification error rates on standard domain adaptation benchmarks.",
    "creator" : "LaTeX with hyperref package"
  }
}