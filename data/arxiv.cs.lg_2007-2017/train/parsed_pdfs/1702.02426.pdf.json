{
  "name" : "1702.02426.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Data Selection Strategies for Multi-Domain Sentiment Analysis",
    "authors" : [ "Sebastian Ruder", "Parsa Ghaffari", "John G. Breslin" ],
    "emails" : [ "sebastian.ruder@insight-centre.org", "john.breslin@insight-centre.org", "sebastian@aylien.com", "parsa@aylien.com" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "Domain adaptation is important for sentiment analysis, as sentiment-bearing words vary between domains. If two domains are similar, such as electronics and kitchen appliance reviews, adaptation is successful; in contrast, transfer is less productive for dissimilar domains, e.g. books and electronics reviews (Blitzer et al., 2007).\nConsequently, recent research has looked to the more realistic setting of multi-domain adaptation, where multiple source domains are provided and the objective is to maximize performance on the target domain. However, such approaches still\n1Link will be made available at a later date.\ntrain on samples from dissimilar domains that are not helpful for prediction in the actual target domain. To mitigate this, existing approaches (Zhou et al., 2016) use a domain similarity measure to weight the predictions of separate source domain models. However, Ruder et al. (2017) show that training one model on all source data is generally more effective.\nEven within one domain, such as a Twitter dataset, adaptation performance varies significantly depending on the choice of training samples (Hovy et al., 2014). In practice, data selection and domain adaptation approaches complement each other: data selection can be seen as weighting relevant instances more highly (Jiang and Zhai, 2007), while data selection approaches in some cases have been shown to outperform adaptation methods (Remus, 2012).\nWhen performing sentiment analysis in the real world, the domains are often unknown or not clearly separable. In this scenario, adaptation and data selection strategies are needed that do not presuppose a distinction of domains (Plank, 2016).\nData selection is also important because annotation is expensive. A large amount of unlabeled data is generally available for training, but annotation can typically only be afforded for a fraction of it. Data selection is able to guide us where to concentrate our annotation efforts.\nIn the following, we will review different strategies to select training data for multi-domain adaptation for sentiment analysis. For data selection, three factors are of importance: the representation, the similarity metric, and the level of the selection. With regard to the representation, we consider term distributions, word embeddings, and autoencoder representations2. We consider three domain similarity metrics: Jensen-Shanon diver-\n2Note that the latter two have not been used for data selection as far as we are aware.\nar X\niv :1\n70 2.\n02 42\n6v 1\n[ cs\n.C L\n] 8\nF eb\n2 01\n7\ngence, cosine similarity, and proxy A distance. We finally employ three different data selection levels: domain level, training instance level, and instance subset level.\nOur contributions are the following:\n1. We present – to our knowledge – the first extensive study of data selection strategies for the task of sentiment analysis.\n2. We consider novel representations and metrics for data selection and present strategies that consistently outperform random and balanced baselines on two large-scale multidomain sentiment analysis datasets.\n3. We propose a data selection method that is well-suited to the realistic setting of unknown or ill-defined domains and consistently outperforms instance-level selection.\n4. We present guidelines for data selection for sentiment analysis in the wild."
    }, {
      "heading" : "2 Related work",
      "text" : "Domain adaptation. Domain adaptation has a long history of research: Blitzer et al. (2006) proposed a structural correspondence learning algorithm. Daumé III (2007) introduced a kernel function that maps source and target domain data to a space that encourages in-domain similarity, while Pan et al. (2010) proposed a spectral feature alignment algorithm to align domainspecific words into meaningful clusters. Glorot et al. (2011) employed stacked Denoising Autoencoders to extract meaningful representations, which Chen et al. (2012) extended to a marginalized version to address their high computational cost. Zhuang et al. (2015) proposed to use deep auto-encoders for transfer learning, while Zhou et al. (2016) transferred the source examples to the target domain and vice versa using BiTransferring Deep Neural Networks.\nMulti-domain adaptation. For domain adaptation from multiple sources, Mansour (2009) proposed a distribution weighted hypothesis with theoretical guarantees. Duan et al. (2009) proposed a method to learn a least-squares SVM classifer by leveraging source classifiers, while (2012) Chattopadhyay et al. assign pseudo-labels to the target data. Yang and Eisenstein (2015) embed metadata attributes of domains, which, however, are not available when domains are unknown. Wu and\nHuang (2016) exploit general sentiment knowledge and word-level sentiment polarity relations for multi-source domain adaptation, while Ruder et al. (2017) use a distillation approach to adapt knowledge from source domain teachers to a target domain student.\nDomain similarity metrics. Blitzer et al. (2007) show that proxy A distance can be used to measure the adaptability between two domains in order to determine, which examples should be annotated. Van Asch and Daelemans (2010) find that Rényi divergence outperforms other metrics in predicting POS tagging accuracy on a target domain. Plank and van Noord (2011), however, find that instance-level based selection on JensenShannon divergence and topic models performs best for parsing data selection.\nIn contrast, we consider different levels of data selection and show that both selecting the most similar domain and the most similar subsets outperform instance-level selection for sentiment analysis. Remus (2012) also use Jensen-Shannon divergence to select training examples for sentiment analysis. Finally, Wu and Huang (2016) propose a domain similarity metric based on a sentiment graph. Their measure, however, is only applicable if domains are clearly defined or known in advance, which is often not the case in the real world."
    }, {
      "heading" : "3 Data selection strategies",
      "text" : ""
    }, {
      "heading" : "3.1 Representations",
      "text" : "Term distributions. The relative frequency distributions of terms in the vocabulary have been successfully used to gauge similarity with respect to a target domain (Plank and van Noord, 2011; Wu and Huang, 2016). The underlying assumption is that similar domains have more terms in common than dissimilar domains. The term distribution of a domainD is a vector t ∈ R|V | where ti is the probability of the i-th word in the vocabulary V appearing in D. Term distributions, however, only capture superficial occurrence statistics, which likely cannot express a more nuanced spectrum of domain similarity.\nWord embeddings. Word embeddings have been used to capture more fine-grained notions of similarity both of words (Mikolov et al., 2013) and of sentences (Wieting et al., 2016), but have not been considered for modeling domain similarity. In line with previous work, we use a weighted\nsum of pre-trained word embeddings to represent each document. In particular, we discount frequent words by weighting the word embedding vwi of each word wi occurring in the document d with the word’s smoothed inverse probability√\na p(wi) where p(wi) is the probability of wi appearing in domain D and a is a smoothing factor, which we set to 10−5 (Mikolov et al., 2013). The representation of a domain is then simply the mean of its document representations.\nAutoencoder representations. Denoising autoencoders have been successfully used in recent work on domain adaptation (Glorot et al., 2011; Zhuang et al., 2015). Their representations are typically created to be domain-invariant, but might still capture information that is beneficial for modeling domain similarity. We train a denoising autoencoder on the data of all domains and extract the representation for each document. To obtain the representation of a domain, we take the mean of its document representations.\nOther representations. In the past, topic distributions have also been used and been found to be successful for part-of-speech tagging (Plank and van Noord, 2011). While topic distributions have proven to be convincing features for sentiment analysis (Lu et al., 2011), in our experiments, we have found them not to be effective for selecting suitable training examples. We attribute this to the fact that topical similarity only inadequately captures the nuances that make up the notion of similarity for sentiment analysis."
    }, {
      "heading" : "3.2 Domain similarity metrics",
      "text" : "Jensen-Shannon divergence. Jensen-Shannon divergence is one of the most frequently used measures of domain similarity (Remus, 2012) and has been shown to outperform other similarity metrics (Plank and van Noord, 2011). JensenShannon divergence is a smoothed, symmetric variant of KL divergence. The Jensen-Shannon divergence between two different probability distributions P and Q can be written as DJS(P ||Q) = 1 2 [DKL(P ||M) + DKL(Q||M)] where M = 1 2(P + Q), i.e. the average distribution of P and Q, and DKL is the KL divergence:\nDKL(P ||Q) = n∑\ni=1\npi pi qi . (1)\nCosine similarity. Cosine similarity is traditionally used to measure the similarity between\nvectors, in particular word embeddings (Mikolov et al., 2013). The cosine similarity between two vectors a and b is:\ncos(a, b) = a · b ‖a‖ ‖b‖ . (2)\nProxyA distance. The A distance (Ben-David et al., 2007) aims to identify the subset A in a family of subsets A on which the source domain distribution P and the target domain distribution Q differ the most and is defined as follows:\ndA(P,Q) = 2 sup A∈A\n|P (A)−Q(A)|. (3)\nIn practice, the Huber loss is used as a proxy for the A distance (Blitzer et al., 2007) but is generally only used on a domain level to gain insights with regard to the adaptability of representations. We propose to use the proxy A distance as a data selection metric in the multi-domain setting: We first sample as many examples from the source domains as we have target domain examples. We then label all source domain examples with 0 and all target domain examples with 1 and train a logistic regression classifier on the balanced binary dataset. We then use the probability of belonging to the target domain as the similarity score for each source domain example.\nOther similarity metrics. Another similarity metric that has been successfully used in Machine Translation is a sentence’s perplexity as determined by a language model trained on the target domain (Duh et al., 2013). However, in our experiments, perplexity proved unsuitable for data selection for sentiment analysis."
    }, {
      "heading" : "3.3 Data selection level",
      "text" : "Finally, domain similarity can be measured on different levels as can be seen in Figure 1: on the level of the entire domain (1a); on the level of a single training example (1b); or on a level that mediates between the two extremes and introduces diversity in the data selection (1c).\nDomain level. Often, such as in the case of product reviews, domains are clearly delimited and documents in different domains are clearly distinct from one another. We can thus adopt these human-assigned labels and compute the similarity of each source domain with regard to the target domain. We then sample n training examples only from the most similar source domain.\nTraining instance level. In other scenarios, such as on the web, there is no clear distinction between different domains (Ruder et al., 2016). In this case, the similarity with regard to the target domain can be computed for each training instance (Plank and van Noord, 2011). Instances are then sorted by similarity and the n training examples with the highest similarity score are chosen for training.\nInstance subset level. While representations such as word embeddings have been shown to be effective at representing words or individual documents, term distributions are more apt to capture the statistics of a collection of examples, as the sparse term distribution of a single sentence or document might not contain sufficient evidence to compute an accurate notion of similarity on an instance level. To counter-act this, instead of calculating the similarity for each training instance, we propose to compute the similarities for random subsets of instances. In addition, considering a subset of examples in conjunction has the advantage of diversifying the training data and thus making the trained model more robust.\nAt each iteration, we sample m subsets of size s from all source domains X . We retain the subset with the highest similarity with regard to the target domain at each iteration and repeat the process until we have gathered n training examples. The complete procedure is shown in Algorithm 1."
    }, {
      "heading" : "4 Experiments",
      "text" : ""
    }, {
      "heading" : "4.1 Datasets and tasks",
      "text" : "As challenges for data selection methods vary depending on the nature of the domains to which they are applied, we evaluate our approaches\nAlgorithm 1 Instance subset select 1: procedure SUBSETSELECT(s, n, m, X) 2: numiter ← n/s 3: trainset← [ ] 4: for i in range(numiter) do 5: randsubsets ← sample m subsets of\nsize s from X 6: simscores ← compute similarity\nscore for randsubsets 7: sortedsimscores← sort simscores 8: bestsubset ← get subset with highest\nsimilarity score 9: trainset.append(bestsubset)\n10: examples.remove(bestsubset) 11: return trainset\non two large multi-domain sentiment analysis datasets, which seek to replicate these challenges.\nTweets+Reviews. When data selection is applied to documents on the web, methods need to be able to handle domains that are not clearly defined and inconsistent. In the extreme, domains may be unknown or non-existing. In order to emulate this diversity, we choose the data of different editions of the SemEval Twitter Sentiment Analysis task as tweets within one domain are often heterogeneous (Hovy et al., 2014). Specifically, we select the training data of SemEval2013 Task 93 (Twitter2013-Train) and the training (Twitter2016-Train) and test data of SemEval2016 Task 4 Subtask A4. We split the latter into\n3http://alt.qcri.org/semeval2014/ task9/data/uploads/semeval2013_task2_ train.zip\n4http://alt.qcri.org/semeval2016/ task4/index.php?id=data-and-tools\nits sub-domains, i.e. LiveJournal2014, SMS2013, Twitter2013, Twitter2014, Twitter2014Sarcasm, Twitter2015, Twitter2016. Furthermore, in order to gauge the methods’ aptitude to handle diverse datasets, we include the laptop and restaurant reviews of SemEval-2016 Task 55.6 Statistics of the domains can be found in Table 1.\nReviews. We furthermore consider the diametrally opposite setting of clearly distinct domains. For this scenario, we use the large version of the reviews dataset of Blitzer et al. (2006). The dataset consists of 25 different review domains with varying data sizes. To enforce realistic conditions where annotation is expensive we employ only the provided datasets with small amounts of labeled data. We show statistics in Table 2.\nTasks. We evaluate our methods on the ternary sentence-level and binary review-level sentiment analysis task on the Tweets+Reviews and Reviews dataset respectively."
    }, {
      "heading" : "4.2 Training details",
      "text" : "We pre-process tweets by replacing urls, user names, and hashtags. We remove stopwords and use a vocabulary of the 10,000 most frequent words across all domains. In line with previous work, we use the raw bag-of-words unigram/bigram features pre-processed with tf-idf as input to a linear SVM classifier (Blitzer et al., 2006). We use GloVe vectors (Pennington et al., 2014) pre-trained on 42B tokens of the Common Crawl corpus7 for our word embeddings. For the auto-encoder representations, we use a denoising auto-encoder with one hidden layer of 1000 dimensions and a masking noise with a masking probability p = 0.8, which we train for 50 epochs with the Adam optimizer (Kingma and Ba, 2015). For subset-level selection, we set the subset size s = 20 and the number of subsets m = 20000 as determined via a grid search over a range of values on Tweets+Reviews validation data.\nWe limit the number of training examples to n = 2000 and n = 1600 for Tweets+Reviews and Reviews respectively, the latter in accordance with the conventions of Bollegala et al. (2011). In all cases, we evaluate on all data in the target domain.\n5http://alt.qcri.org/semeval2016/ task5/index.php?id=data-and-tools\n6We omit sentences with conflicting sentiments. 7http://nlp.stanford.edu/projects/\nglove/"
    }, {
      "heading" : "4.3 Comparison methods",
      "text" : "Baselines. We compare against two baselines: a) We randomly sample training examples from all source domains (rand); b) we randomly sample the same number of stratified examples from all source domains (all). Since the Reviews corpus contains distinct product review domains, we also include a human-labeled baseline (H), where the model is trained on data randomly sampled from the domain that was determined most similar by 5 human annotators. We provided them with the names of the review categories and review samples and tasked them with ranking the three most similar domains for each domain, with the consensus being selected as the most similar domain.\nOur methods. For each representation, we use – due to space considerations – the similarity metric that is most commonly used in conjunction with it, i.e. term distribution and Jensen-Shannon divergence, word embeddings and cosine similarity, and autoencoder representations and cosine similarity. For each combination, we select examples based on three levels: a) We randomly sample from the most similar domain (D); b) we choose the most similar individual examples (ex); and c) we choose the most similar subsets of examples (subset). Due to space considerations, we apply proxy A distance for each representation only on the instance level, although it can be naturally combined with our subset-level selection strategy."
    }, {
      "heading" : "4.4 Results",
      "text" : "For all datasets, we report accuracy scores and the average of 10 runs. We measure statistical significance using Student’s T test. We provide results in Tables 3 and 4."
    }, {
      "heading" : "4.5 Discussion",
      "text" : "Tweets+Reviews. Most methods outperform the random and balanced baselines on average. Term-distribution based domain-level selection achieves the best performance. Even though Twitter datasets are highly heterogeneous, training and test sets of the same edition of the competition have been collected in the same time frame and thus share similar topics and characteristics that are helpful for identifying the sentiment.\nIn contrast, the scores of the other selection strategies are similar across representations. Subset-level selection generally outperforms its instance-level counterpart. Using proxy A dis-\ntance as a similarity metric generally improves upon using the default similarity metric for the given representation. Particularly for term distributions, it helps to mitigate the sparsity of the representation.\nEven though domain-level selection using word embeddings outperforms the baselines on the majority of domains, they perform – on average – more poorly. This shows the fallacy of choosing the most similar domain for training: The domain might be similar with regard to the representations of the words that are used, but the way the words are used are different, as can be seen with the sarcasm, laptops, and restaurant domains, where semantically similar domains are chosen by word embeddings that are, however, less helpful for predicting sentiment. This also reveals that the mean of document representations might not be the best way to capture all aspects of domain similarity.\nAutoencoder representations perform comparable to term distributions on the Tweets+Reviews dataset, while their domain-level selection method performs worse. We generally expected them to perform better than term distributions, but reason that this is mainly due to the scarcity of data in this multi-domain dataset.\nAs we have limited the number of training examples to 2000, we also investigate the behaviour of the different data selection strategies when the number of training examples increases. We display this exemplarily for the LiveJournal2014 domain in Figure 2. We observe that – while all selection strategies increase their performance – subset-level selection improves slightly more considerably, but note that this trend might vary depending on the domain.\nReviews. For the clearly distinct review domains, both the random and balanced baselines obtain comparatively stronger results. We attribute this to the fact that it is very difficult for a model to learn from a sentence that is not relevant to the target domain as in the Tweets+Reviews dataset, while an unhelpful review might still shed light on general sentiment words; in addition, the binary setting is easier than the ternary setting.\nDomain-level selection based on term distributions still performs strongly, but is outperformed by subset-level selection on the same representations, which significantly improves upon instancelevel selection. In comparison to the previous dataset, word embedding-based representation\noutperform term distributions, which we attribute to the fact that reviews are larger and contain more topical words with meaningful word representations in comparison to the noisy social media messages.\nEven though product review categories have natural-language names, identifying the domain that is most similar and thus most likely to help the prediction at test time is no trivial task as can be seen with the abysmal performance of our humanlabeled baseline (H) and underlines the need for automatic data selection for domain adaptation. This is most evident with regard to the music domain, which is naturally conceptually similar to the musical instruments domain, but employs an entirely different repertoire of sentiment words.\nAnother behavior that we observe is that while domain-level selection yields more often the best score for a domain compared to other selection strategies, its failure mode is equally polarized and often yields one of the worst scores for a target domain, if a source domain is matched whose examples are only peripherally relevant for the prediction.\nProxy A distance again consistently improves upon the default domain similarity metric demonstrating that domain similarity as judged by the confidence value of a liner classifier is a suitable metric for data selection. Finally, autoencoder representations outperform all other representations, while subset-level selection based on autoencoder representations performs best. The multiplicity of\ndomains compensates for the lack of data, which renders autoencoder representations more meaningful and gives them an edge over term representations."
    }, {
      "heading" : "4.6 Guidelines",
      "text" : "Finally, we propose guidelines on using data selection for sentiment analysis in the wild that might be helpful for NLP practitioners:\n• DO use term distribution-based domain-level selection with Jensen-Shannon divergence as a simple baseline.\n• DO use subset-level selection instead of instance-level selection, particularly with term distributions.\n• DO use proxy A distance instead of the default similarity metric.\n• DO NOT use pre-trained word embeddings for data selection on noisy data.\n• DO NOT use autoencoder representations for data selection if your dataset is small.\n• DO use autoencoder representations on large datasets."
    }, {
      "heading" : "5 Conclusion",
      "text" : "In this paper, we have extensively studied – for the first time as far as we are aware – domain similarity metrics in the context of sentiment analysis. We have proposed several representations and metrics that have previously not been employed for data selection. We have introduced a novel data selection strategy that leverages subsets of examples and consistently outperforms instancelevel selection. Finally, we have evaluated the proposed methods on two large-scale multi-domain adaptation settings on tweets and reviews and demonstrated that our proposed metrics and representations outperform strong random and balanced baselines, while our new selection strategy based on autoencoder representations yields the best score on the review corpus."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "Domain adaptation is important in sentiment analysis as sentiment-indicating words vary between domains. Recently, multi-domain adaptation has become more pervasive, but existing approaches train on all available source domains including dissimilar ones. However, the selection of appropriate training data is as important as the choice of algorithm. We undertake – to our knowledge for the first time – an extensive study of domain similarity metrics in the context of sentiment analysis and propose novel representations, metrics, and a new scope for data selection. We evaluate the proposed methods on two largescale multi-domain adaptation settings on tweets and reviews and demonstrate that they consistently outperform strong random and balanced baselines, while our proposed selection strategy outperforms instance-level selection and yields the best score on a large reviews corpus. All experiments are available at url_redacted1",
    "creator" : "LaTeX with hyperref package"
  }
}