{
  "name" : "1511.09300.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Influence diagrams for the optimization of a vehicle speed profile",
    "authors" : [ ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "Influence diagrams are decision theoretic extensions of Bayesian networks. They are applied to diverse decision problems. In this paper we apply influence diagrams to the optimization of a vehicle speed profile. We present results of computational experiments in which an influence diagram was used to optimize the speed profile of a Formula 1 race car at the Silverstone F1 circuit. The computed lap time and speed profiles correspond well to those achieved by test pilots. An extended version of our model that considers a more complex optimization function and diverse traffic constraints is currently being tested onboard a testing car by a major car manufacturer. This paper opens doors for new applications of influence diagrams."
    }, {
      "heading" : "1 INTRODUCTION",
      "text" : "Optimization of a vehicle speed profile is a well known problem studied in literature. Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).\nIn this paper we describe an application of influence diagrams to the problem of the optimization of a vehicle speed profile. Speed profile specifies the vehicle speed at each point of the path. We illustrate the proposed method using an example of the speed profile optimization of a Formula 1 race car at the Silverstone F1 circuit (Velenis and Tsiotras, 2008). The goal is to minimize the total lap time. This example will be used throughout the paper to explain the key concepts and for the final experimental evaluation of the proposed approach. An advantage is that the optimal solution is known (Velenis and Tsiotras, 2008). This allows us\nto compare the influence diagram solution with the analytic one. Both solutions have a close correspondence.\nThe proposed method allows applications of influence diagrams to more complex scenarios of a speed profile optimization. Speed constraints can be invoked not only by path radii, but also by other causes like traffic regulations, weather conditions, distance to other vehicles, etc. Moreover, these conditions can be changing dynamically. Also, the criteria to be optimized need not be the total time only. We can consider also safety, fuel consumption, etc. We believe that influence diagrams are very appropriate for these situations since optimum policies are precomputed for any speed the vehicle can attain. The optimal speed profile can be quickly updated if the conditions change.\nThere are two key properties that allow efficient computations. The first one is that the overall utility function is the sum of local utilities in all considered segments of the vehicle path. This is the case not only when the goal is to minimize the total time, but also when we aim at the minimal total fuel consumption or a linear combination of these two. The second key property is the Markov property. This allows to aggregate the whole future in one probability and one utility potential. These potentials are defined over the speed variable in the current path segment.\nThe paper is organized as follows. In Section 2, we describe the physical model of a vehicle and define the problem of the vehicle speed profile optimization. In Section 3, we introduce influence diagrams and in Section 4 we apply them to the vehicle speed profile optimization. The results of numerical experiments with real data are presented in Section 5. Section 6 reviews the related work. In Section 7, we conclude the paper by a summary of our contribution and by a discussion of our future work."
    }, {
      "heading" : "2 PHYSICAL MODEL OF THE VEHICLE",
      "text" : "First, we describe a simple physical model of a vehicle. The content of this section is based on (Velenis and Tsiotras, 2008). Although this model is too simple to model the\nar X\niv :1\n51 1.\n09 30\n0v 1\n[ cs\n.A I]\n3 0\nN ov\n2 01\ncomplex behavior of a car-like vehicle, it is sufficient for the optimization of a vehicle speed profile.\nWe model a vehicle as a point mass moving along a path, see Figure 1. We split the path into n ∈ N small segments of a specified length (e.g., 5 meters). Let s denote the length of each segment, i ∈ {0, . . . , n} be the path length coordinate, [i, i + 1] be the segment between path length coordinates i and i + 1. We assume that the acceleration is constant at each segment. Let vi be the velocity at i, and ai the acceleration at the segment [i, i + 1]. The velocity vi+1 at i + 1 is a function of the velocity vi and acceleration ai:\nvi+1 = vi+1(vi, ai, s) = √ (vi)2 + 2 · s · ai . (1)\nTime ti+1 spent at the path segment [i, i+ 1] is: ti+1 = ti+1(vi, vi+1, s) = s · ( vi + vi+1\n2\n)−1 . (2)\nThe vehicle is controlled by a control variable ui, which is assumed to be constant at the segment [i, i+1]. The control variable ui takes values from interval [−1,+1], where negative values represent braking and positive values represent accelerating. We use variable ui to control acceleration ai:\nai = { amaxt · ui − cv · (vi)2 if ui ≥ 0 amint · ui − cv · (vi)2 if ui < 0 , (3)\nwhere amaxt and a min t are engine and brakes characteristics, namely the maximum tangential acceleration and deceleration, respectively. cv is the deceleration coefficient for aerodynamic drag. Example 1. For a F1 race car:\nai = ai(ui, vi)\n= { 16 · ui − 0.0021 · (vi)2 if ui ≥ 0 18 · ui − 0.0021 · (vi)2 if ui < 0 . (4)\nThe vehicle path is characterized by a radius profile, which is defined as the radius ri of the circular arc which best approximates the path curve at each point i = 1, . . . , n (see Figure 1). The radius ri defines the maximum speed at point i as\nvi ≤ vmaxi = √ amaxn · ri , (5)\nwhere amaxn is the maximum lateral acceleration. Example 2. For a typical F1 race car amaxn = 30 m · s−2. This implies that\nvmaxi = √ 30 · ri . (6)\nIf ri = 30 m then the maximum speed is 108 km · h−1. Example 3. In Figure 2, we present the radius and maximum speed profiles of the F1 Silverstone circuit (the bridge version). The radius larger than 500 meters is not depicted1. From the radius profile, we derive the maximum speed profile by use of formula (6).\nOther restrictions on maximal and minimal tangential accelerations are due to friction forces at the tires, which restricts the control signals:\n|ui| ≤ umaxi (vi) =\n√ 1− ( vi\nvmaxi\n)4 . (7)\nNow, we can formally specify the problem. Definition 1 (Vehicle speed profile optimization problem). The goal is to find a vehicle speed profile vi, i = 1, . . . , n such that\n1Radius 500 meters allows maximum speed of 441 km · h−1 – a speed never reached by an F1 race car.\n• v0 is the actual speed of the vehicle at coordinate 0, • it minimizes the total time ∑n\ni=1 ti,\n• it satisfies the speed constraints specified by formula (5) for i = 0, 1, . . . , n and\n• it satisfies the control constraints specified by formula (7) for i = 0, 1, . . . , n.\nRemark. Please, note that an optimal speed profile can be also specified by values of control variable ui for i = 0, . . . , n− 1, from which it is computed."
    }, {
      "heading" : "3 INFLUENCE DIAGRAMS",
      "text" : "An influence diagram (Howard and Matheson, 1981) is a Bayesian network augmented with decision variables and utility functions. In graphs, random variables are depicted as circles, decision variables as squares, and utility functions as diamonds. As an example, see Figure 3. Random and decision variables are denoted by capital letters, their states by respective lower-case ones.\nA solution to the decision problem described by an influence diagram consists of a series of decision policies for the decision variables. Decision policy for decision variable U defines for each configuration of parents of U a probability distribution over the states of U . Decision strategy is a sequence of decision policies, one for every decision variable. The goal is to find an optimal decision strategy that maximizes the expected total utility."
    }, {
      "heading" : "3.1 SOLVING INFLUENCE DIAGRAMS",
      "text" : "Several methods for solving influence diagrams were proposed. A simple method was published already in (Howard and Matheson, 1981) where influence diagrams were introduced. They proposed to unfold respective influence diagram into a decision tree and solve it using dynamic programming. Another algorithm was developed by (Shachter, 1986) and it foreshadowed the future graphical algorithms. Basically, one can gradually simplify respective influence diagram by successive removing nodes from its graph. When a decision node is being removed (by maximizing expected utility), the maximizing alternative is recorded as the optimal policy. Three operations to remove graph nodes were introduced; at least one of them can be used at any given time. Another method is to reduce an influence diagram into a Bayesian network by converting decision variables into random variables – the solution of a specific inference problem in this Bayesian network then corresponds to the optimal decision policy of the influence diagram (Cooper, 1988). One can also transform an influence diagram into a valuation network and solve it using variable elimination in the valuation network (Shenoy, 1992).\nWe decided to use a method that employs a strong junction tree (Jensen et al., 1994; Jensen and Nielsen, 2007), which is a refinement of methods of Shenoy (1992) and Shachter and Peot (1992). The utility nodes are eliminated first by marrying all parents of each utility node and by including the corresponding utility potentials to cliques containing all parents of the utility node. It has been shown that an influence diagram can be solved exactly by message passing performed on the strong junction tree.\nTo every clique C in the junction tree, we associate a probability potential ΦC and a utility potential ΨC . Let C1 and C2 be adjacent cliques with separator S. To pass a message from clique C2 to clique C1 potentials ΦC1 and ΨC1 are updated as follows2 (Jensen et al., 1994):\nΦ′C1 = ΦC1 ∗ ΦS , (8) Ψ′C1 = ΨC1 + ΨS ΦS , (9)\nwhere\nΦS = M C2\\S ΦC2 , ΨS = M C2\\S (ΦC2 ∗ΨC2)\nandM is a generalized marginalization operation. The operator M acts differently for a random variable A and a decision variable U of a (probability or utility) potential Ξ:\nM A Ξ = ∑ A Ξ, M U Ξ = max U Ξ ,\nwhere ∑\nA is a shorthand for summation over all states ofA and maxU denotes maximum over all states of U . For a set of variables C, we define MCΞ as a sequence of singlevariable marginalizations. The elimination order follows the inverse order as determined by the relation≺. In case of discrete variables, the complexity of one message passing operation is O(|C1| + |C2| + |S|), where |C| denotes the number of combinations of states of variables in C.\nDespite its similarity with the junction tree algorithm for Bayesian networks (Lauritzen and Spiegelhalter, 1988), only the collection phase of the strong junction tree is needed to solve an influence diagram. The maximum expected utility value can be obtained by doing the remaining marginalization in the root. Above that, we can easily get the optimal decision policy for decision variables during the message passing process. For every combination of parents of a decision variable (in our case the only parent is the speed variable), it is the alternative with the maximal expected utility in the moment of message passing.\nNote that this approach is highly dependent on the process of building a junction tree from an influence diagram. The\n2Given two potentials Φ and Ψ, their product Φ ∗ Ψ and the quotient Φ/Ψ are defined in the natural way, except that 0/0 is defined to be 0 and x/0 for x 6= 0 is undefined (Jensen et al., 1994).\nsize of cliques is determining the speed of the algorithm. Consequently, the junction tree algorithm is typically infeasible for solving large influence diagrams. Fortunately, this is not the case for our application."
    }, {
      "heading" : "4 INFLUENCE DIAGRAMS FOR VEHICLE SPEED PROFILE OPTIMIZATION",
      "text" : "In this section, we use the physical model of a vehicle from Section 2 to create an influence diagram for the speed profile optimization. We split the vehicle path into n segments of the same length s. In each segment [i, i + 1], i ∈ {0, . . . , n− 1} there are three random variables Vi, Ai, and Vi+1, one decision variable Ui, and one utility potential Ti. A part of influence diagram corresponding to one path segment is depicted in Figure 3. The influence diagram used in the final experiments reported in Section 5 consisted of 1010 parts, one for a segment 5 meters long.\nVariable Vi corresponds to the vehicle speed in the beginning of the segment (at point i). Ai corresponds to the vehicle acceleration in the segment [i, i + 1] and it is assumed to be constant in this segment. Vi+1 is the vehicle speed at the end of the segment (at point i + 1). The decision variable Ui corresponds to the vehicle control signal whose positive values denote application of vehicle accelerator and negative values ones an application of brakes. Utility function Ti corresponds to time spent at segment [i, i + 1]. In our implementation the actual values of Ti are time savings achieved at segment [i, i + 1]. They are computed by subtracting time spent by the vehicle in the segment from a constant tmax – the maximum considered time3 the vehicle may spend at a segment of length s. This allows us to use maximization over non-negative utility potentials, which is required when working with random variables having states of zero probability.\n3E.g., tmax is time for a minimal race speed 100 km/h, which is equal to 0.036 seconds if s = 1 meter.\nIn this paper we consider discrete random and discrete decision variables. For all i ∈ {0, . . . , n}, the variable Vi takes its values from V , which is a finite subset of interval [0, 400] measured in km/h, the values of Ai are from A, which is a finite subset of interval [−34, 16] measured in ms−2, and values of decision variable Ui are from U , which is a finite subset of interval [−100,+100], where value −100 corresponds to the maximum braking (brakes 100%) while +100 corresponds to full acceleration (accelerator 100%). Sets V , A, and U are uniformly discretized with discretization steps dV , dA, and dU , respectively. Symbols |V|, |A|, and |U| denote the cardinalities of the respective sets.\nThe probability and utility potentials are defined using formulas from Section 2. The conditional probability distributions are “almost” deterministic. For each parent configuration of a variable there are only two states from the finite domain of that variable with a non-zero probability. These two values are those that are closest to the value computed by the corresponding formula of the physical model of the vehicle. The conditional probability distribution of the acceleration Ai is defined as:\nP (Ai = a|Vi = vi, Ui = ui) = 1− ai−adA if a = max{a ∈ A, a ≤ ai} 1− a−aidA if a = min{a ∈ A, a > ai} 0 otherwise, (10)\nwhere ai is defined by formula (3).\nExample 4. Consider P (Ai|Vi = 131km/h,Ui = 25) and A = {−34,−33, . . . ,−1, 0, 1, 2, . . . , 16}. Using (4) we compute the acceleration of an F1 race car ai = 1.2 ms−2. The conditional probability distribution is specified in Table 1.\nSimilarly, we define the conditional probability distribution P (Vi+1|Vi, Ai). More specifically, we combine the above approximation and formula (1). Finally, the utility function is defined as\nf(vi−1, vi, s) = t max − ti(vi−1, vi, s) , (11)\nwhere function ti is defined by formula (2).\nAfter elimination of utility nodes, the graph of the influence diagram is transformed into a strong junction tree. See Figure 4 where we present the strong junction tree of influence diagram from Figure 3. There are two cliques for path segment [i, i + 1], i ∈ {0, . . . , n − 1} in the strong junction tree. We will denote them CAi and C V i and define\nCAi = {Ai, Ui, Vi} and CVi = {Vi+1, Ai, Vi}. Cliques are ordered reversely and the variable elimination is processed also in this order. Rectangular nodes correspond to junction tree separators.\nThe junction tree is initialized as follows. Each conditional probability distribution and each utility function is assigned to a clique containing all its variables. Thus\nΦCAi = P (Ai|Ui, Vi) , ΦCVi = P (Vi+1|Ai, Vi) , ΨCAi = 0 , ΨCVi = f(Ti+1|Vi, Vi+1) ."
    }, {
      "heading" : "4.1 IMPLEMENTATION OF CONSTRAINTS",
      "text" : "During the inference we have to consider the speed and control constraints. Both, speed and control constraints are inserted to corresponding cliques of the junction tree."
    }, {
      "heading" : "4.1.1 Speed constraints",
      "text" : "Speed constraints are inserted in the form of likelihood evidence. Likelihood evidence is a vector that for each state of the corresponding variable takes values between zero and one (Jensen, 2001, Section 1.4.6). Likelihood evidence of a speed constraint is a vector φ of length |V| such that\nφ(v) = 1 if v ≤ vmaxi 1− v−v max i dV if v = min{v ∈ V, v > vmaxi }\n0 otherwise, (12)\nwhere vmaxi is defined by (5). Remark. The idea behind the formula (12) is that the closer the value of vmaxi is to the nearest speed value v ∈ V that is greater than vmaxi the higher is the likelihood of v. In experiments, we observed that by giving a non-zero probability to the state v just above the maximum value vmaxi we\nimprove the quality of results. The coarser the discretization the larger the improvement.\nDuring the inference we include potential φ(Vi) into a clique containing Vi that appears first in the computations."
    }, {
      "heading" : "4.1.2 Control constraints",
      "text" : "The control constraints (7) are applied during marginalization of the control variable Ui from a potential Ψ′CVi\n(we will abbreviate it as Ξ) performed in the steps specified by formulas (8) and (9).\nFor each vi ∈ V we define a set of admissible control\nU ′(vi) = {ui ∈ U , |ui| ≤ umaxi (vi)}\nand compute an optimal admissible control value\nu∗i (vi) = arg max ui∈U ′(vi) Ξ(Ui = ui, Vi = vi) .\nThe optimal decision policy in Ui is for all vi ∈ V δi(u|vi) = {\n1 if u = u∗i (vi) 0 otherwise. (13)\nThe value of the new potential is\nΞ(Vi = vi) = Ξ(Ui = u ∗ i (vi), Vi = vi) . (14)\nHowever, whenever u∗i (vi) is the least or the largest value of U ′(vi) we can reduce the discretization error by considering also the nearest value u∗∗i (vi) outside U ′i . The idea is similar to (12). If\nΞ(Ui = u ∗∗ i (vi), Vi = vi) ≥ Ξ(Ui = u∗i (vi), Vi = vi)\nthen we replace the deterministic policy (13) by a probabilistic policy\nδi(u|vi) =  1− |u ∗ i (vi)−u max i (vi)| dU if u = u∗i (vi) 1− |u ∗∗ i (vi)−u max i (vi)| dU if u = u∗∗i (vi)\n0 otherwise.\nFormula (14) is replaced by\nΞ(Vi = vi) =\nδi(u ∗ i |vi) · Ξ(Ui = u∗(vi), Vi = vi) +δi(u ∗∗ i |vi) · Ξ(Ui = u∗∗i (vi), Vi = vi) ."
    }, {
      "heading" : "4.2 ZERO COMPRESSION",
      "text" : "We solve the influence method using standard strong junction tree method (Jensen et al., 1994) briefly described in Section 3.1. But the probability potentials we are working with are sparse, i.e., they contain many zeroes. This is a consequence of conditional probability distributions being “almost” deterministic. In Hugin (Andersen et al., 1990) a\nprocedure called zero compression is employed to improve efficiency of inference with sparse potentials. In this procedure an efficient representation of the clique tables is used so that zeros need not be stored explicitly. The savings can be large: in our case, we basically reduce the dimension of each table by one. The compression does not affect the accuracy of the inference process, as it introduces no approximations (Cowell et al., 1999), i.e., it is an exact inference method.\nExample 5. We can store the distribution from Example 4 using two numbers only – value val and position pos of the first non-zero number in the table. Note that the second non-zero number is positioned on pos+1 with value 1−val and there are two non-zero numbers only. The same applies to P (Vi+1|Vi, Ai).\nIn the standard inference method the complexity in one path segment is O (|A| · |V| · (|V|+ |U|)). In case of zero compression the complexity drops to O(|V| · (|A|+ |U|)). In Section 5.1 we evaluate the savings experimentally."
    }, {
      "heading" : "5 EXPERIMENTS",
      "text" : "We performed experiments with a model of a Formula 1 race car at the Silverstone F1 circuit (the bridge version). The goal is to find a speed profile that minimizes the total lap time and satisfies speed and acceleration constraints as specified by Definition 1. The speed constraints are derived from radius of curves and the maximum allowed lateral acceleration amaxn – see formula (5). For a typical F1 race car amaxn = 30 ms\n−2 – see Example 2. The acceleration constraints are defined by formula (7).\nIn our experiments we use the influence diagram described in Section 3. The experiments were conducted in the following way:\n1. Define the length of one segment s and sets of variables’ states V,A,U .\n2. Initialize potentials ΦCAi ,ΦCVi ,ΨCAi , and ΨCVi and set up the junction tree.\n3. Insert speed and acceleration constraints to the junction tree.\n4. Compute the optimal policies δi, i = 0, 1, . . . , n− 1.\n5. Use the optimal policy and the initial speed4 v0 = 312 km/h to compute an optimal speed profile as specified by formulas (15), (16), and (17).\nThe expected speed v̂i+1 at coordinate i + 1 is computed using formulas (1) and (4) from the expected control value\n4Initial speed v0 is set as in (Velenis and Tsiotras, 2008).\nûi(vi), which is computed as a weighted average of policies for two values vi, vi from V that are the closest to vi:\nv̂i+1 = vi+1(v, s, ai (ûi(vi), vi)) , (15) ûi(vi) = ∑\nv∈{vi,vi}\nw(v, vi) · ∑ u∈U u · δi(u|v) , (16)\nw(v, vi) = 1− |v − vi| dV . (17)\nAll algorithms used in our experiments were implemented in the programming language R (R Core Team, 2014)."
    }, {
      "heading" : "5.1 ZERO COMPRESSION EXPERIMENTS",
      "text" : "We compared computational time of the zero compression and standard junction tree inference methods, see Table 2. Recall that symbols |V|, |A|, and |U| denote the cardinalities of the respective sets. The experiments were carried out on an influence diagram consisting of 10 path segments. We can see that zero compression brings large computational savings for fine grained discretizations."
    }, {
      "heading" : "5.2 DISCRETIZATION EXPERIMENTS",
      "text" : "We tested different variable discretizations and different path segmentations. The goal was to find a combination of these parameters that represents a reasonable tradeoff between precision and computational time.\nWe performed experiments on a part of Silverstone F1 circuit 180 meters long. Results of some performed experiments are presented in Figure 5. In the upper part of these figures, speed profiles are depicted while the control profile is plotted in their lower part. The shaded areas are forbidden by the speed and control constraints, respectively.\nIt turned out that the number of states of the model variables should be in accordance with the path segmentation. The finer is the path segmentation, the more variables’ values are required. Discretization that is not well balanced with the path segmentation leads to oscillations of decision (control) variables as it is illustrated for s = 1m, |V| = |A| = |U| = 100 in Figure 5.\nIn the experiments it turned out the oscillation depends strongly on |V|. Basically, there are two reasons. First, the discretization has to be able to distinguish small speed changes within one segment of the path. The reason can be elucidated by the following example.\nExample 6. Consider uniformly accelerated motion with the initial speed v0 ∈ {200 km/h, 300 km/h}. In case of full throttle, the acceleration computed by formula (4) is a .= 9.52 ms−2 and a .= 1.42 ms−2, respectively. Considering segments of various length s, we can compute the speed at the end of the respective segment using formula (1). From Table 3 we can see that in case of s = 1 m the discretization has to be fine grained in order to capture small speed changes within such a short segment.\nThe second reason is the inference algorithm itself. Information passes through clique separators. In Figure 4 we can see that all separators contain Vi and every second separator consists of single Vi only. Hence, the size of V limits the information flow between respective cliques. In other words, |V| represents a bottleneck of the inference mechanism.\nRepresentative results for the whole Silverstone F1 circuit are presented in Table 4. The expected lap time is quite stable with respect to different discretizations. For the final experiments we selected the configuration printed in boldface since from those that respect the speed and acceleration constraints well it is least computationally demanding."
    }, {
      "heading" : "5.3 INFLUENCE DIAGRAM SOLUTION",
      "text" : "We used the influence diagram to compute the speed profile for the Silverstone F1 circuit. It is plotted in the upper part of Figure 6 by a full line. The bridge version of Silverstone circuit is 5049 meters long, which corresponds to 1010 segments 5m long. In this figure we compare the\ncomputed speed profile with a test pilot performance at the Silverstone F1 circuit (Oxford Technical Solutions, 2002). In the upper part of Figure 6 the test pilot speed profile is plotted by a dotted line. Notice that the testing pilot violates these restrictions several times. Also, the test pilot acceleration is slower than expected. The speed constraints used in the model seem to be too cautious and the car acceleration ability a bit exaggerated.\nIt is interesting to compare the total lap time estimated by the influence diagram model with results achieved by F1 pilots. While the model estimated time 83.95 seconds is little lower than time achieved by the test pilot – 85.51 seconds, it is higher than the fastest ever lap time – 78.12 seconds – attained by Sebastian Vettel with his Red Bull-Renault in the qualification of the 2009 British Grand Prix."
    }, {
      "heading" : "5.4 ANALYTIC SOLUTION",
      "text" : "The analytic solution was presented in (Velenis and Tsiotras, 2008). It is plotted in Figure 7 by a dotted line together with the influence diagram solution. The solutions are quite similar but there are some differences. Apparently, the analytical solution does not fully comply with the acceleration constraints. This causes differences in the speed profiles, otherwise they would be equivalent. We were not able to explain this observation. In the lower part of Figure 7 we present the control profile of the analytic solution reconstructed from the speed profile of the analytic solution5."
    }, {
      "heading" : "6 RELATED WORK",
      "text" : "The speed profile optimization problem can be also specified using Markov decision processes (MDPs) (Puterman, 1994) with a finite horizon, a non-stationary policy and a non-linear stationary reward function. The solution of such an MDP can be found by the approach presented in this paper since solution methods of both approaches are based on\n5The little oscillations are caused by imprecision of the analytic speed profile taken from (Velenis and Tsiotras, 2008).\ndynamic programming. In (Velenis and Tsiotras, 2008) the problem was solved analytically by methods of the continuous time control (Bertsekas, 2000) using the Pontryagin’s maximum principle. We compared the influence diagram solution with the analytic solution in Section 5.4 – the solutions were similar. However, analytical solutions for considered extended versions of the problem with an advanced optimization function and additional constraints are not known and numerical methods have to be used."
    }, {
      "heading" : "7 CONCLUSIONS AND FUTURE WORK",
      "text" : "We proposed an application of influence diagrams to speed profile optimization and tested it in a real-life scenario. We summarize what we have achieved and what we have learned:\n• We were able to find optimal solutions efficiently.\n• We verified the solutions are in accordance with the analytical solution of the considered problem.\n• An important advantage of influence diagrams is that once the policy is computed, it can be immediately used to update the optimal speed profile under modified circumstances. For example, if the driver has to slow down because of an unexpected traffic situation, the policy immediately provides the best new control value and the speed profile is specified by following the precomputed optimal policies.\n• Influence diagrams are especially handy in more complex real-life scenarios where the analytic solution is unknown.\n• In applications, different optimality criteria come into play. We can do the computations efficiently as long as they decompose additively along the path segments.\nIn future we plan to optimize speed profiles using influence diagrams with continuous variables. Inspired by the work of (Kveton et al., 2006) on MDPs we plan to study inference in influence diagrams based on mixtures of beta distributions. Other possibilities to be considered are approximations by mixtures of polynomials (Shenoy and West, 2011; Li and Shenoy, 2012) or by mixtures of truncated exponentials (Cobb and Shenoy, 2008; Moral et al., 2001).\nCurrently, we are applying influence diagrams to a more complex scenario with a complex utility function, for which no analytical solution is known. Methods of the control theory, if applied to this scenario, thus need to rely on approximate numerical methods."
    }, {
      "heading" : "Acknowledgements",
      "text" : "This work was supported by the Czech Science Foundation through project 13–20012S."
    } ],
    "references" : [ {
      "title" : "HUGIN: a shell for building Bayesian belief universes for expert systems",
      "author" : [ "S.K. Andersen", "K.G. Olesen", "F.V. Jensen", "F. Jensen" ],
      "venue" : "Shafer, G. and Pearl, J., editors, Readings in Uncertain Reasoning, pages 332– 337. Kaufman.",
      "citeRegEx" : "Andersen et al\\.,? 1990",
      "shortCiteRegEx" : "Andersen et al\\.",
      "year" : 1990
    }, {
      "title" : "Dynamic Programming and Optimal Control",
      "author" : [ "D.P. Bertsekas" ],
      "venue" : "Athena Scientific, 2nd edition.",
      "citeRegEx" : "Bertsekas,? 2000",
      "shortCiteRegEx" : "Bertsekas",
      "year" : 2000
    }, {
      "title" : "Vehicle speed profiles to minimize work and fuel consumption",
      "author" : [ "D.J. Chang", "E.K. Morlok" ],
      "venue" : "Journal of Transportation Engineering, 131(3):173–182.",
      "citeRegEx" : "Chang and Morlok,? 2005",
      "shortCiteRegEx" : "Chang and Morlok",
      "year" : 2005
    }, {
      "title" : "Decision making with hybrid influence diagrams using mixtures of truncated exponentials",
      "author" : [ "B.R. Cobb", "P.P. Shenoy" ],
      "venue" : "European Journal of Operational Research, 186(1):261 – 275.",
      "citeRegEx" : "Cobb and Shenoy,? 2008",
      "shortCiteRegEx" : "Cobb and Shenoy",
      "year" : 2008
    }, {
      "title" : "A method for using belief networks as influence diagrams",
      "author" : [ "G. Cooper" ],
      "venue" : "Proceedings of the Fourth Conference Annual Conference on Uncertainty in Artificial Intelligence (UAI-88), pages 55–63, Corvallis, Oregon. AUAI Press.",
      "citeRegEx" : "Cooper,? 1988",
      "shortCiteRegEx" : "Cooper",
      "year" : 1988
    }, {
      "title" : "Probabilistic Networks and Expert Systems",
      "author" : [ "R.G. Cowell", "A.P. Dawid", "S.L. Lauritzen", "D.J. Spiegelhalter" ],
      "venue" : "Springer-Verlag, Berlin-Heidelberg-New York.",
      "citeRegEx" : "Cowell et al\\.,? 1999",
      "shortCiteRegEx" : "Cowell et al\\.",
      "year" : 1999
    }, {
      "title" : "Design of an efficient algorithm for fuel-optimal look-ahead control",
      "author" : [ "E. Hellström", "J. Åslund", "L. Nielsen" ],
      "venue" : "Control Engineering Practice, 18(11):1318–1327.",
      "citeRegEx" : "Hellström et al\\.,? 2010",
      "shortCiteRegEx" : "Hellström et al\\.",
      "year" : 2010
    }, {
      "title" : "Influence diagrams",
      "author" : [ "R.A. Howard", "J.E. Matheson" ],
      "venue" : "Howard, R. A. and Matheson, J. E., editors, Readings on The Principles and Applications of Decision Analysis, volume II, pages 721–762. Strategic Decisions Group.",
      "citeRegEx" : "Howard and Matheson,? 1981",
      "shortCiteRegEx" : "Howard and Matheson",
      "year" : 1981
    }, {
      "title" : "From influence diagrams to junction trees",
      "author" : [ "F. Jensen", "F.V. Jensen", "S.L. Dittmer" ],
      "venue" : "Proceedings of the Tenth Conference on Uncertainty in Artificial Intelligence, pages 367–373. Morgan Kaufmann.",
      "citeRegEx" : "Jensen et al\\.,? 1994",
      "shortCiteRegEx" : "Jensen et al\\.",
      "year" : 1994
    }, {
      "title" : "Bayesian Networks and Decision Graphs",
      "author" : [ "F.V. Jensen" ],
      "venue" : "Springer-Verlag, New York.",
      "citeRegEx" : "Jensen,? 2001",
      "shortCiteRegEx" : "Jensen",
      "year" : 2001
    }, {
      "title" : "Bayesian Networks and Decision Graphs, 2nd ed",
      "author" : [ "F.V. Jensen", "T.D. Nielsen" ],
      "venue" : "Springer-Verlag, New York.",
      "citeRegEx" : "Jensen and Nielsen,? 2007",
      "shortCiteRegEx" : "Jensen and Nielsen",
      "year" : 2007
    }, {
      "title" : "Solving factored MDPs with hybrid state and action variables",
      "author" : [ "B. Kveton", "M. Hauskrecht", "C. Guestrin" ],
      "venue" : "Journal of Artificial Intelligence Research, 27:153–201.",
      "citeRegEx" : "Kveton et al\\.,? 2006",
      "shortCiteRegEx" : "Kveton et al\\.",
      "year" : 2006
    }, {
      "title" : "Local computations with probabilities on graphical structures and their application to expert systems (with discussion)",
      "author" : [ "S.L. Lauritzen", "D.J. Spiegelhalter" ],
      "venue" : "Journal of the Royal Statistical Society, Series B, 50:157–224.",
      "citeRegEx" : "Lauritzen and Spiegelhalter,? 1988",
      "shortCiteRegEx" : "Lauritzen and Spiegelhalter",
      "year" : 1988
    }, {
      "title" : "A framework for solving hybrid influence diagrams containing deterministic conditional distributions",
      "author" : [ "Y. Li", "P.P. Shenoy" ],
      "venue" : "Decision Analysis, 9(1):55–75.",
      "citeRegEx" : "Li and Shenoy,? 2012",
      "shortCiteRegEx" : "Li and Shenoy",
      "year" : 2012
    }, {
      "title" : "Vehicle trajectory optimization for application in Eco-driving",
      "author" : [ "F. Mensing", "R. Trigui", "E. Bideaux" ],
      "venue" : "Vehicle Power and Propulsion Conference (VPPC), IEEE, pages 1–6.",
      "citeRegEx" : "Mensing et al\\.,? 2011",
      "shortCiteRegEx" : "Mensing et al\\.",
      "year" : 2011
    }, {
      "title" : "Rapid computation of optimal control for vehicles",
      "author" : [ "V.V. Monastyrsky", "I.M. Golownykh" ],
      "venue" : "Transportation Research Part B: Methodological, 27(3):219 – 227.",
      "citeRegEx" : "Monastyrsky and Golownykh,? 1993",
      "shortCiteRegEx" : "Monastyrsky and Golownykh",
      "year" : 1993
    }, {
      "title" : "Mixtures of truncated exponentials in hybrid bayesian networks",
      "author" : [ "S. Moral", "R. Rumi", "A. Salmerón" ],
      "venue" : "Benferhat, S. and Besnard, P., editors, Symbolic and Quantitative Approaches to Reasoning with Uncertainty, volume 2143 of Lecture Notes in Computer Science,",
      "citeRegEx" : "Moral et al\\.,? 2001",
      "shortCiteRegEx" : "Moral et al\\.",
      "year" : 2001
    }, {
      "title" : "RT3000 inertial and GPS measurement system",
      "author" : [ "Oxford Technical Solutions" ],
      "venue" : "Technical report, Oxfordshire, UK.",
      "citeRegEx" : "Solutions,? 2002",
      "shortCiteRegEx" : "Solutions",
      "year" : 2002
    }, {
      "title" : "Markov Decision Processes: Discrete Stochastic Dynamic Programming",
      "author" : [ "M.L. Puterman" ],
      "venue" : "John Wiley & Sons, New York, NY.",
      "citeRegEx" : "Puterman,? 1994",
      "shortCiteRegEx" : "Puterman",
      "year" : 1994
    }, {
      "title" : "R: A Language and Environment for Statistical Computing",
      "author" : [ "R Core Team" ],
      "venue" : "R Foundation for Statistical Computing, Vienna, Austria.",
      "citeRegEx" : "Team,? 2014",
      "shortCiteRegEx" : "Team",
      "year" : 2014
    }, {
      "title" : "Aeris: Eco-vehicle speed control at signalized intersections using i2v communication",
      "author" : [ "H.A. Rakha", "R.K. Kamalanathsharma", "K. Ahn" ],
      "venue" : "Technical Report FHWA-JPO-12-063, Virginia Polytechnic Institute and State University and Virginia Tech Transportation",
      "citeRegEx" : "Rakha et al\\.,? 2012",
      "shortCiteRegEx" : "Rakha et al\\.",
      "year" : 2012
    }, {
      "title" : "Model for developing an eco-driving strategy of a passenger vehicle based on the least fuel consumption",
      "author" : [ "Y. Saboohi", "H. Farzaneh" ],
      "venue" : "Applied Energy, 86(10):1925–1932.",
      "citeRegEx" : "Saboohi and Farzaneh,? 2009",
      "shortCiteRegEx" : "Saboohi and Farzaneh",
      "year" : 2009
    }, {
      "title" : "Evaluating influence diagrams",
      "author" : [ "R.D. Shachter" ],
      "venue" : "Operations Research, 34(6):871–882.",
      "citeRegEx" : "Shachter,? 1986",
      "shortCiteRegEx" : "Shachter",
      "year" : 1986
    }, {
      "title" : "Decision making using probabilistic inference methods",
      "author" : [ "R.D. Shachter", "M.A. Peot" ],
      "venue" : "Proceedings of the Eighth Conference Annual Conference on Uncertainty in Artificial Intelligence (UAI-92), pages 276–283, San Mateo, CA. Morgan Kaufmann.",
      "citeRegEx" : "Shachter and Peot,? 1992",
      "shortCiteRegEx" : "Shachter and Peot",
      "year" : 1992
    }, {
      "title" : "Valuation based systems for bayesian decision analysis",
      "author" : [ "P.P. Shenoy" ],
      "venue" : "Operations Research, 40:463–484.",
      "citeRegEx" : "Shenoy,? 1992",
      "shortCiteRegEx" : "Shenoy",
      "year" : 1992
    }, {
      "title" : "Inference in hybrid bayesian networks using mixtures of polynomials",
      "author" : [ "P.P. Shenoy", "J.C. West" ],
      "venue" : "International Journal of Approximate Reasoning, 52(5):641– 657.",
      "citeRegEx" : "Shenoy and West,? 2011",
      "shortCiteRegEx" : "Shenoy and West",
      "year" : 2011
    }, {
      "title" : "Minimum-time travel for a vehicle with acceleration limits: Theoretical analysis and receding-horizon implementation",
      "author" : [ "E. Velenis", "P. Tsiotras" ],
      "venue" : "Journal of Optimization Theory and Applications, 138(2):275–296.",
      "citeRegEx" : "Velenis and Tsiotras,? 2008",
      "shortCiteRegEx" : "Velenis and Tsiotras",
      "year" : 2008
    } ],
    "referenceMentions" : [ {
      "referenceID" : 15,
      "context" : "Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 45,
      "endOffset" : 196
    }, {
      "referenceID" : 2,
      "context" : "Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 45,
      "endOffset" : 196
    }, {
      "referenceID" : 21,
      "context" : "Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 45,
      "endOffset" : 196
    }, {
      "referenceID" : 6,
      "context" : "Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 45,
      "endOffset" : 196
    }, {
      "referenceID" : 14,
      "context" : "Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 45,
      "endOffset" : 196
    }, {
      "referenceID" : 20,
      "context" : "Some authors minimize the energy consumption (Monastyrsky and Golownykh, 1993; Chang and Morlok, 2005; Saboohi and Farzaneh, 2009; Hellström et al., 2010; Mensing et al., 2011; Rakha et al., 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 45,
      "endOffset" : 196
    }, {
      "referenceID" : 26,
      "context" : ", 2012) while others aim at minimizing the total time (Velenis and Tsiotras, 2008).",
      "startOffset" : 54,
      "endOffset" : 82
    }, {
      "referenceID" : 26,
      "context" : "We illustrate the proposed method using an example of the speed profile optimization of a Formula 1 race car at the Silverstone F1 circuit (Velenis and Tsiotras, 2008).",
      "startOffset" : 139,
      "endOffset" : 167
    }, {
      "referenceID" : 26,
      "context" : "An advantage is that the optimal solution is known (Velenis and Tsiotras, 2008).",
      "startOffset" : 51,
      "endOffset" : 79
    }, {
      "referenceID" : 26,
      "context" : "The content of this section is based on (Velenis and Tsiotras, 2008).",
      "startOffset" : 40,
      "endOffset" : 68
    }, {
      "referenceID" : 7,
      "context" : "An influence diagram (Howard and Matheson, 1981) is a Bayesian network augmented with decision variables and utility functions.",
      "startOffset" : 21,
      "endOffset" : 48
    }, {
      "referenceID" : 7,
      "context" : "A simple method was published already in (Howard and Matheson, 1981) where influence diagrams were introduced.",
      "startOffset" : 41,
      "endOffset" : 68
    }, {
      "referenceID" : 22,
      "context" : "Another algorithm was developed by (Shachter, 1986) and it foreshadowed the future graphical algorithms.",
      "startOffset" : 35,
      "endOffset" : 51
    }, {
      "referenceID" : 4,
      "context" : "Another method is to reduce an influence diagram into a Bayesian network by converting decision variables into random variables – the solution of a specific inference problem in this Bayesian network then corresponds to the optimal decision policy of the influence diagram (Cooper, 1988).",
      "startOffset" : 273,
      "endOffset" : 287
    }, {
      "referenceID" : 24,
      "context" : "One can also transform an influence diagram into a valuation network and solve it using variable elimination in the valuation network (Shenoy, 1992).",
      "startOffset" : 134,
      "endOffset" : 148
    }, {
      "referenceID" : 8,
      "context" : "We decided to use a method that employs a strong junction tree (Jensen et al., 1994; Jensen and Nielsen, 2007), which is a refinement of methods of Shenoy (1992) and Shachter and Peot (1992).",
      "startOffset" : 63,
      "endOffset" : 110
    }, {
      "referenceID" : 10,
      "context" : "We decided to use a method that employs a strong junction tree (Jensen et al., 1994; Jensen and Nielsen, 2007), which is a refinement of methods of Shenoy (1992) and Shachter and Peot (1992).",
      "startOffset" : 63,
      "endOffset" : 110
    }, {
      "referenceID" : 4,
      "context" : "Another method is to reduce an influence diagram into a Bayesian network by converting decision variables into random variables – the solution of a specific inference problem in this Bayesian network then corresponds to the optimal decision policy of the influence diagram (Cooper, 1988). One can also transform an influence diagram into a valuation network and solve it using variable elimination in the valuation network (Shenoy, 1992). We decided to use a method that employs a strong junction tree (Jensen et al., 1994; Jensen and Nielsen, 2007), which is a refinement of methods of Shenoy (1992) and Shachter and Peot (1992).",
      "startOffset" : 274,
      "endOffset" : 601
    }, {
      "referenceID" : 4,
      "context" : "Another method is to reduce an influence diagram into a Bayesian network by converting decision variables into random variables – the solution of a specific inference problem in this Bayesian network then corresponds to the optimal decision policy of the influence diagram (Cooper, 1988). One can also transform an influence diagram into a valuation network and solve it using variable elimination in the valuation network (Shenoy, 1992). We decided to use a method that employs a strong junction tree (Jensen et al., 1994; Jensen and Nielsen, 2007), which is a refinement of methods of Shenoy (1992) and Shachter and Peot (1992). The utility nodes are eliminated first by marrying all parents of each utility node and by including the corresponding utility potentials to cliques containing all parents of the utility node.",
      "startOffset" : 274,
      "endOffset" : 630
    }, {
      "referenceID" : 8,
      "context" : "To pass a message from clique C2 to clique C1 potentials ΦC1 and ΨC1 are updated as follows2 (Jensen et al., 1994): ΦC1 = ΦC1 ∗ ΦS , (8)",
      "startOffset" : 93,
      "endOffset" : 114
    }, {
      "referenceID" : 12,
      "context" : "Despite its similarity with the junction tree algorithm for Bayesian networks (Lauritzen and Spiegelhalter, 1988), only the collection phase of the strong junction tree is needed to solve an influence diagram.",
      "startOffset" : 78,
      "endOffset" : 113
    }, {
      "referenceID" : 8,
      "context" : "The Given two potentials Φ and Ψ, their product Φ ∗ Ψ and the quotient Φ/Ψ are defined in the natural way, except that 0/0 is defined to be 0 and x/0 for x 6= 0 is undefined (Jensen et al., 1994).",
      "startOffset" : 174,
      "endOffset" : 195
    }, {
      "referenceID" : 8,
      "context" : "We solve the influence method using standard strong junction tree method (Jensen et al., 1994) briefly described in Section 3.",
      "startOffset" : 73,
      "endOffset" : 94
    }, {
      "referenceID" : 0,
      "context" : "In Hugin (Andersen et al., 1990) a",
      "startOffset" : 9,
      "endOffset" : 32
    }, {
      "referenceID" : 5,
      "context" : "The compression does not affect the accuracy of the inference process, as it introduces no approximations (Cowell et al., 1999), i.",
      "startOffset" : 106,
      "endOffset" : 127
    }, {
      "referenceID" : 26,
      "context" : "Initial speed v0 is set as in (Velenis and Tsiotras, 2008).",
      "startOffset" : 30,
      "endOffset" : 58
    }, {
      "referenceID" : 26,
      "context" : "The analytic solution was presented in (Velenis and Tsiotras, 2008).",
      "startOffset" : 39,
      "endOffset" : 67
    }, {
      "referenceID" : 18,
      "context" : "The speed profile optimization problem can be also specified using Markov decision processes (MDPs) (Puterman, 1994) with a finite horizon, a non-stationary policy and a non-linear stationary reward function.",
      "startOffset" : 100,
      "endOffset" : 116
    }, {
      "referenceID" : 26,
      "context" : "The little oscillations are caused by imprecision of the analytic speed profile taken from (Velenis and Tsiotras, 2008).",
      "startOffset" : 91,
      "endOffset" : 119
    }, {
      "referenceID" : 26,
      "context" : "In (Velenis and Tsiotras, 2008) the problem was solved analytically by methods of the continuous time control (Bertsekas, 2000) using the Pontryagin’s maximum principle.",
      "startOffset" : 3,
      "endOffset" : 31
    }, {
      "referenceID" : 1,
      "context" : "In (Velenis and Tsiotras, 2008) the problem was solved analytically by methods of the continuous time control (Bertsekas, 2000) using the Pontryagin’s maximum principle.",
      "startOffset" : 110,
      "endOffset" : 127
    }, {
      "referenceID" : 11,
      "context" : "Inspired by the work of (Kveton et al., 2006) on MDPs we plan to study inference in influence diagrams based on mixtures of beta distributions.",
      "startOffset" : 24,
      "endOffset" : 45
    }, {
      "referenceID" : 25,
      "context" : "Other possibilities to be considered are approximations by mixtures of polynomials (Shenoy and West, 2011; Li and Shenoy, 2012) or by mixtures of truncated exponentials (Cobb and Shenoy, 2008; Moral et al.",
      "startOffset" : 83,
      "endOffset" : 127
    }, {
      "referenceID" : 13,
      "context" : "Other possibilities to be considered are approximations by mixtures of polynomials (Shenoy and West, 2011; Li and Shenoy, 2012) or by mixtures of truncated exponentials (Cobb and Shenoy, 2008; Moral et al.",
      "startOffset" : 83,
      "endOffset" : 127
    }, {
      "referenceID" : 3,
      "context" : "Other possibilities to be considered are approximations by mixtures of polynomials (Shenoy and West, 2011; Li and Shenoy, 2012) or by mixtures of truncated exponentials (Cobb and Shenoy, 2008; Moral et al., 2001).",
      "startOffset" : 169,
      "endOffset" : 212
    }, {
      "referenceID" : 16,
      "context" : "Other possibilities to be considered are approximations by mixtures of polynomials (Shenoy and West, 2011; Li and Shenoy, 2012) or by mixtures of truncated exponentials (Cobb and Shenoy, 2008; Moral et al., 2001).",
      "startOffset" : 169,
      "endOffset" : 212
    }, {
      "referenceID" : 26,
      "context" : "Figure 7: A comparison of speed profiles: the influence diagram and analytic solution (Velenis and Tsiotras, 2008).",
      "startOffset" : 86,
      "endOffset" : 114
    } ],
    "year" : 2015,
    "abstractText" : "Influence diagrams are decision theoretic extensions of Bayesian networks. They are applied to diverse decision problems. In this paper we apply influence diagrams to the optimization of a vehicle speed profile. We present results of computational experiments in which an influence diagram was used to optimize the speed profile of a Formula 1 race car at the Silverstone F1 circuit. The computed lap time and speed profiles correspond well to those achieved by test pilots. An extended version of our model that considers a more complex optimization function and diverse traffic constraints is currently being tested onboard a testing car by a major car manufacturer. This paper opens doors for new applications of influence diagrams.",
    "creator" : "LaTeX with hyperref package"
  }
}