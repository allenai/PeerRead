{
  "name" : "1705.03352.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Composition of Credal Sets via Polyhedral Geometry",
    "authors" : [ "Jǐrina Vejnarová" ],
    "emails" : [ "vejnar@utia.cas.cz", "velorex@utia.cas.cz" ],
    "sections" : [ {
      "heading" : null,
      "text" : "ar X\niv :1\n70 5.\n03 35\n2v 1\n[ cs"
    }, {
      "heading" : "1 Introduction",
      "text" : "In the second half of 1990’s a new approach to efficient representation of multidimensional probability distributions was introduced with the aim to be an alternative to Graphical Markov Modeling. This approach is based on a simple idea: a multidimensional distribution is composed from a system of low-dimensional distributions by repetitive application of a special composition operator, which is also the reason why such models are called compositional models.\nLater, these compositional models were introduced also in possibility theory [Vejnarová, 1998, 2007] (here the models are parametrized by a continuous t-norm) and ten years ago also in evidence theory [Jiroušek et al.,\n∗vejnar@utia.cas.cz †velorex@utia.cas.cz\n2007, Jiroušek and Vejnarová, 2011]. In all these frameworks the original idea is kept, but there exist some slight differences among these frameworks.\nIn [Vejnarová, 2013] we introduced a composition operator for credal sets, but due to the problem of discontinuity it needed a revision. After a thorough reconsideration in [Vejnarová, 2016] we presented a new definition avoiding this discontinuity. We showed that the revised composition operator keeps the basic properties of its counterparts in other frameworks, and therefore it enables us to introduce compositional models for multidimensional credal sets. Nevertheless, a problem how to make practical computations appeared and the need for effective computational procedures became urgent.\nCredal sets are usually defined as convex sets of probability distributions. In finite case, a probability distribution can be represented as a point in a multidimensional space. Credal set — as a convex set of such points — can be interpreted as a convex polyhedron in respective space. This naturally leads to computational procedures based on methods used in polyhedral geometry [Grünbaum et al., 1967].\nThis contributions is organized as follows. In Section 2 we summarise the basic concepts and notation. The definition of the operator of composition is presented in Section 3, which is devoted also to its basic properties. In Section 4 we describe proposed computational procedures, in Section 5 we illustrate their application on a few simple examples and Section 6 is devoted to implementation."
    }, {
      "heading" : "2 Basic Concepts and Notation",
      "text" : "In this section we will briefly recall basic concepts and notation necessary for understanding the contribution."
    }, {
      "heading" : "2.1 Variables and Distributions",
      "text" : "For an index set N = {1, 2, . . . , n} let {Xi}i∈N be a system of variables, each Xi having its values in a finite set Xi and XN = X1 ×X2 × . . .×Xn be the Cartesian product of these sets.\nIn this paper we will deal with groups of variables on its subspaces. Let XK will denote a group of variables {Xi}i∈K with values in XK =×i∈KXi throughout the paper.\nAny group of variables XK can be described by a probability distribution\n(sometimes also called probability function)\nP : XK −→ [0, 1],\nsuch that ∑\nxK∈XK\nP (xK) = 1.\nHaving two probability distributions P1 and P2 of XK we say that P1 is absolutely continuous with respect to P2 (and denote P1 ≪ P2) if for any xK ∈ XK\nP2(xK) = 0 =⇒ P1(xK) = 0.\nThis concept plays an important role in the definition of the composition operator."
    }, {
      "heading" : "2.2 Credal Sets",
      "text" : "A credal set M(XK) describing a group of variables XK is usually defined as a closed convex set of probability measures describing the values of these variables. In order to simplify the expression of operations with credal sets, it is often considered [Moral and Cano, 2002] that a credal set is the set of probability distributions associated to the probability measures in it. Under such consideration a credal set can be expressed as a convex hull (denoted by CH) of its extreme distributions (ext)\nM(XK) = CH{ext(M(XK ))}.\nConsider a credal set M(XK). For each L ⊂ K its marginal credal set M(XL) is obtained by element-wise marginalization, i.e.\nM(XL) = CH{P ↓L : P ∈ ext(M(XK))}, (1)\nwhere P ↓L denotes the marginal distribution of P on XL. Besides marginalization we will also need the opposite operation, usually called extension. Vacuous extension of a credal set M(XL) describing XL to a credal set M(XK) = M(XL)\n↑K (L ⊂ K) is the maximal credal set describingXK such that M(XK)\n↓L = M(XL). A simple example of vacuous extension can be found in Section 5 (Example 5.3).\nHaving two credal sets M1 and M2 describing XK and XL, respectively (assuming that K,L ⊆ N), we say that these credal sets are projective if their marginals describing common variables coincide, i.e. if\nM1(XK∩L) = M2(XK∩L).\nLet us note that if K and L are disjoint, then M1 and M2 are always projective, as M1(X∅) = M2(X∅) ≡ 1."
    }, {
      "heading" : "2.3 Strong Independence",
      "text" : "Among the numerous definitions of independence for credal sets [Couso et al., 1999] we have chosen strong independence, as it seems to be the most appropriate for multidimensional models.\nWe say that (groups of) variables XK and XL (K and L disjoint) are strongly independent with respect to M(XK∪L) iff (in terms of probability distributions)\nM(XK∪L) = CH{P1 · P2 : P1 ∈ M(XK), P2 ∈ M(XL)}. (2)\nAgain, there exist several generalizations of this notion to conditional independence, see e.g. [Moral and Cano, 2002], but as the following definition is suggested by the authors as the most appropriate for the marginal problem, it seems to be a suitable concept also in our case, since the operator of composition can also be used as a tool for solution of a marginal problem, as shown (in the framework of possibility theory) e.g. in [Vejnarová, 2007].\nGiven three groups of variables XK ,XL and XM (K,L,M be mutually disjoint subsets of N , such thatK and L are nonempty), we say that XK and XL are conditionally independent given XM under global set M(XK∪L∪M ) (to simplify the notation we will denote this relationship by K ⊥ L|M) iff\nM(XK∪L∪M ) (3)\n= CH{(P1 · P2)/P ↓M 1 : P1 ∈ M(XK∪M ), P2 ∈ M(XL∪M ), P ↓M 1 = P ↓M 2 } .\nThis definition is a generalisation of stochastic conditional independence: ifM(XK∪L∪M ) is a singleton, thenM(XK∪M ) andM(XL∪M ) are also (projective) singletons and the definition reduces to the definition of stochastic conditional independence."
    }, {
      "heading" : "2.4 Polyhedral Geometry",
      "text" : "A convex polytope may be defined in numerous ways, depending on what is more suitable for the problem at hand. Grünbaum’s definition [Grünbaum et al., 1967] is in terms of a convex set of points in space. Other important definitions are: as the intersection of half-spaces (H-representation) and as the convex hull of a set of vertices (V-representation). For a compact convex polytope, the minimal V-representation is unique and it is given by the set of the vertices of the polytope [Grünbaum et al., 1967]. In our experiments, we use both H and V-representations. However, for the purpose of representation of the polytope within the paper only V-representation is used.\nAs mentioned in the introduction, a credal set is a convex polytope (bounded polyhedron) in |XN |-dimensional space. Each dimension corresponds to an element from XN (a combination of the variables N) - i.e. xN ∈ XN . Vertex v of the space is nothing else than a probability distribution Pv with v[xN ] = Pv(xN ). Following the fact, that probability belongs to unit interval [0, 1], we can restrict the space — it is, in fact, a hypercube.\nThe nature of the space imposes several restrictions to operations with convex polytopes. We do not consider projections into subspaces. Marginalization of a convex polytope representing a set of probability distributions of XN to XK (K ⊂ N) corresponds to a transformation of |XN |-dimensional space into XK-dimensional space. Naturally, for each vertex this is done by summing of all coordinates from XN with the projection to XK . The similar holds for extensions."
    }, {
      "heading" : "3 Composition Operator",
      "text" : "In this section we will recall the new definition of composition operator for credal sets introduced in [Vejnarová, 2016]. To enable the reader better understanding to the concept we will present it first in a precise probability framework."
    }, {
      "heading" : "3.1 Composition Operator of Probability Distributions",
      "text" : "First let us recall the definition of composition of two probability distributions [Jiroušek, 1997]. Consider two index sets K,L ⊂ N . We do not put any restrictions on K and L; they may be but need not be disjoint, and one may be a subset of the other. Let P1 and P2 be two probability distributions of (groups of) variables XK and XL; then\n(P1 ⊲ P2)(XK∪L) = P1(XK) · P2(XL)\nP2(XK∩L) , (4)\nwhenever P1(XK∩L) ≪ P2(XK∩L); otherwise, it remains undefined. It is specific property of composition operator for probability distributions — in other settings the operator is always defined [Vejnarová, 2007, Jiroušek et al., 2007]."
    }, {
      "heading" : "3.2 Definition",
      "text" : "Let M1 and M2 be credal sets describing XK and XL, respectively. Our goal is to define a new credal set, denoted by M1 ⊲M2, which will describe\nXK∪L and will contain all of the information contained in M1 and, as much as possible, from M2. In other words, we want to find a common extension of M1 and M2 (if it is possible).\nThe required properties were already met by Definition 1 in [Vejnarová, 2013]1. However, that definition exhibits a kind of discontinuity and was thoroughly reconsidered. In [Vejnarová, 2016] we proposed the following one.\nDefinition 3.1 For two credal sets M1 and M2 describing XK and XL, their composition M1 ⊲ M2 is defined as a convex hull of probability distributions P obtained as follows. For each couple of distributions P1 ∈ M1(XK) and P2 ∈ M2(XL) such that P ↓K∩L 2 ∈ argmin{Q2 ∈ M2(XK∩L) : d(Q2, P ↓K∩L 1 ), distribution P is obtained by one of the following rules: [a] if P ↓K∩L 1 ≪ P ↓K∩L 2\nP (XK∪L) = P1(XK) · P2(XL)\nP ↓K∩L 2 (XK∩L) .\n[b] otherwise\nP (XK∪L) ∈ ext{P ↑K∪L 1 (XK)}.\nFunction d used in the definition is a suitable distance function. In this paper we use Euclidean distance, as it is natural choice in polyhedral geometry.\nLet us note, that this definition of composition operator does not differ from the original one [Vejnarová, 2013] in case of projective credal sets, as in this case the only distributions in M1 ⊲ M2 are those satisfying P = (P1 · P2)/P ↓K∩L 2 , where P ↓K∩L 1 = P ↓K∩L 2\n(and those belonging to their convex hull). However, it differs in the remaining cases. It will be illustrated in Section 5 using our computational procedures.\nIn the next subsection we will summarize the most important basic properties of the composition operator."
    }, {
      "heading" : "3.3 Basic Properties",
      "text" : "The following lemma proven in [Vejnarová, 2016] suggests that the abovedefined composition operator possesses basic properties required at the beginning of this section. Its last item characterizes condition under which common extension of M1 and M2 can be obtained.\n1Let us note that the definition is based on Moral’s concept of conditional independence\nwith relaxing convexity.\nLemma 3.2 For two credal sets M1 and M2 describing XK and XL, respectively, the following properties hold true:\n1. M1 ⊲M2 is a credal set describing XK∪L.\n2. (M1 ⊲M2)(XK) = M1(XK).\n3. M1 ⊲M2 = M2 ⊲M1 iff M1(XK∩L) = M2(XK∩L).\nThis lemma, together with the following theorem, proven in [Vejnarová, 2013], expressing the relationship between strong independence and the operator of composition, are the most important assertions enabling us to introduce compositional models.\nTheorem 3.3 Let M be a credal set describing XK∪L with marginals M(XK) and M(XL). Then\nM(XK∪L) = (M ↓K ⊲M↓L)(XK∪L)\niff (K \\ L) ⊥ (L \\K)|(K ∩ L).\nThis theorem remains valid also for the revised definition of the composition operator, as M(XK) and M(XL) are marginals of M(XK∪L), and therefore only [a] (for projective distributions) is applicable.\nBefore closing this section, let us present one more result proven in [Vejnarová, 2017] concerning the relationship between the original composition operator for precise probabilities and that studied in this contribution.\nLemma 3.4 Let M1(XK) and M2(XL) be two singleton credal sets describing XK and XL, respectively, where M1(XK∩L) is absolutely continuous with respect to M2(XK∩L). Then (M1⊲M2)(XK∪L) is also a singleton.\nThe reader should however realize that the definition of the operator of composition for singleton credal sets is not completely equivalent to the definition of composition for probabilistic distributions. They equal each other only in case that the probabilistic version is defined. This is ensured in Lemma 3.4 by assuming the absolute continuity. In case it does not hold, the probabilistic operator is not defined while its credal version introduced in this paper is always defined. However, in this case, the result is not a singleton credal set, as can be seen from Example 5.3 in Section 5."
    }, {
      "heading" : "4 Computational Procedures for Composition Op-",
      "text" : "erator\nThe experiments were performed in R environment [R Core Team, 2016] using RStudio [RStudio Team, 2015]. To implement polyhedral geometry, we have used rcdd package [Geyer et al., 2016] based on GMP GNU library (The GNUMultiple Precision Arithmetic Library) [Granlund and the GMP development team, 2012].\nFor quadratic programming methods — i.e. in case of a finding a projection of a given vertex on a certain polytope (we considered Euclidean distance in this paper) — we have used methods of quadratic programming [Gould and Toint, 2000] implemented in quadprog package [original by Berwin A. Turlach R port by Andreas 2013].\nTo implement various extensions to higher dimensional space — as described in Definition 3.1 — we have used the advantage of equivalence of Hand V-representations of convex polytopes. To move from |XN |-dimensional space to |XK |-dimensional space where K ⊂ N we can easily create a 0-1 transformation matrix that allows us to convert an arbitrary vertex from one space to the other one. With the help of such a transformation matrix, a set of related (in)equalities can be transformed as well. This is extremely handy when we need to extend a vertex or a convex polytope from a space to the higher-dimensional one. First, we convert it to its H-representation and then transform it using a transformation matrix to the higher dimensional space.\nTo find a part of a polytope with given projection, it is enough to extend H-projection of the projection to the original space and combine both Hrepresentations (to get the intersection of the polytopes)."
    }, {
      "heading" : "5 Examples",
      "text" : "In this Section we will demonstrate the application of Definition 1 via our computational procedures. Let us start with the case of projective credal sets.\nExample 5.1 Let M1(X1X2) and M2(X2X3) be credal sets about variables X1X2 and X2X3, respectively, with extreme vertices as listed in Table 1.\nThese two credal sets are projective, as\nM1(X2) = CH{[0.2, 0.8], [0.5, 0.5]} = M2(X2)\nFollowing Definition 1, M1 ⊲M2 can be expressed as a convex polytope with V-representation defined in Table 2.\nIt can easily be checked that both (M1 ⊲M2)(X1X2) = M1(X1X2) and (M1 ⊲M2)(X2X3) = M2(X2X3). ♦\nHere for any distribution P1(X1X2) in M1 exists (at least one) distribution P2(X2X3) in M2 such that P1(X2) = P2(X2), therefore all the extreme points are obtained as a simple conditional product. In this case, furthermore, M1 ⊲ M2 = M2 ⊲ M1, as corresponds to Lemma 3.2 (and can be easily checked).\nThe following example is more complicated, as it deals with non-projective credal sets.\nExample 5.2 Let M1(X1X2) and M2(X2X3) be two credal sets describing binary variables X1X2 and X2X3, respectively, defined as a convex hull of vertices in Table 3.\nThese two credal sets are not projective, as M1(X2) = CH{[0.2, 0.8], [0.6, 0.4]}, while M2(X2) = CH{[0.3, 0.7], [0.5, 0.5]}. Therefore M2(X2) ⊂ M1(X2).\nDefinition 1 in this case leads to a credal set (M1 ⊲M2)(X1X2X3) with 23 extreme points listed in Table 4. On the other hand (M2 ⊲M1)(X1X2X3)\nhas 16 extreme points. They are listed in Table 5.\n♦\nThis difference deserves a more detailed explanation. Both M1⊲M2 and M2⊲M1 keep the first marginal, but not the second one (which corresponds to Lemma 3.2).\nThe extreme vertices of marginal of the composition M2 ⊲M1 of X1X2 are listed in Table 6. Is is not obvious just from the table itself, but the convex polytope corresponding to (M2 ⊲ M1)(X1X2) is smaller than the one of the original credal set M1(X1X2). Actually, any extreme vertex of (M2 ⊲M1)(X1X2) is an inner point of M1(X1X2).\nThe opposite inclusion holds for the marginal of the composition M1 ⊲ M2 of X2X3. The V-representation of respective credal set is given in Table 7. This credal set is bigger than M2(X2X3), i.e., any extreme vertex of M2(X2X3) is contained in (M1 ⊲M2)(X2X3).\nThe fact that (M2 ⊲M1)(X1X2) is smaller (more precise) than (M2 ⊲ M1))(X1X2) corresponds to the idea that we want M2 ⊲ M1 to keep all the information contained in M2. Therefore, we do not consider those distributions from M1 not corresponding to any from M2 — although these distributions are taken into account when composing M1 ⊲M2.\nx2x3 x2x̄3 x̄2x3 x̄2x̄3 1 0 0.3 0 0.7 2 0.25 0.25 0.25 0.25 3 0.5 0 0.5 0 4 0 0.2 0 0.8 5 0.133 0.067 0.457 0.343 6 0.6 0 0.4 0 7 0.3 0.3 0.2 0.2\nTable 7: (M1 ⊲M2)(X2X3)\nV-representation of two marginals of composition of M1 and M2 from Example 5.2\nThe last example demonstrates the case, when [b] of Definition 1 is applied. Simultaneously, it is the case, when probabilistic composition operator remains undefined, but composition of two precise probabilities taken as singleton credal sets is defined (and the result is, naturally, a credal set).\nExample 5.3 Let M1(X1X2) and M2(X2X3) be two singleton credal sets describing variables X1X2 and X2X3, respectively. They are defined in Table 8. Let us compute M1 ⊲ M2. As M1(X2) = {[0.5, 0.5]}, while (M2(X2) = {[1, 0]}, it is evident, that M1 is not absolutely continuous with respect to M2. Therefore, using part [b] of Definition 1, we get the full extension of M1(X2) = {[0.5, 0.5]}, to X1,2,3-dimensional space of probability distributions (i.e. to a hypercube). The V-representation of such a polytope is listed in Table 9.\n♦\nAlgorithm 1 Implementation of M1 ⊲M2 procedure V(M)\nreturn V-representation of M - set of extreme vertices end procedure procedure compose(M1(XK),M2(XL))\nMKL ← M K∩L 1 ∩MK∩L 2 Mprojective 1\n← M↑KKL ∩M1 Mprojective\n2 ← M↑LKL ∩M2\nresult ← ∅ for P1 ∈ V (M projective 1 ) do\nfor P2 ∈ V (M projective 2 ) do\nif P ↓K∩L 1 = P ↓K∩L 2\nthen add P1 ⊲ P2 to the result\nend if end for\nend for for P1 ∈ V (M1) do\nQ2 ← find a projection of P ↓K∩L 1 on M↓K∩L 2 (comment: i.e. minimize distance ‖P ↓K∩L 1 − p‖ subject to p ∈\nM↓K∩L 2\n) (comment: in case of Euclidean distance we can use methods of\nquadratic programming)\nif P ↓K∩L 1 ≪ Q2 then\nfor P2 ∈ V (M2 ∩Q ↑L 2 ) do\nadd P1 ⊲ P2 to the result end for\nend if if P ↓K∩L\n1 6≪ Q2 then\nadd V (P ↑K∪L 1\n) to the result end if\nend for return convex hall of the result\nend procedure"
    }, {
      "heading" : "6 Implementation",
      "text" : "The implementation of M1 ⊲M2 via Definition 1 is based on a conjecture that it is sufficient to deal with two finite groups of vertices only. The first group coincides with the set of extreme vertices of each polytope (credal set). The other group corresponds to projective parts of the credal sets - i.e. the parts whose marginals describing common variables coincide. For better explanation see the pseudo-code of the implementation, as described in Algorithm 1."
    }, {
      "heading" : "7 Conclusions and Future Work",
      "text" : "We have presented computational procedures for composition of credal sets. We utilized the fact, that a credal set can be viewed as a special case of a convex polyhedron and that the methods in polyhedral geometry are developed for a long period. It seems to be useful, as the composition can hardly be performed without this computational support (with the exception of the simplest examples).\nNevertheless, it is only the first step in the construction of multidimen-\nsional models. The repetitive application of the composition operator is theoretically solved for so-called perfect sequences of credal sets, but the computational issues have not been tackled yet. And the problems connected with other generating sequences could be Another research direction can be shift of the distance from the Euclidean on to some divergence of probability distributions as e.g. Kullback-Leibler divergence, total variation or some other f-divergence [Vajda, 1989].\nLast but not least, a number of theoretical issues concerning relationship between credal compositional models and other kinds of multidimensional models in the framework of credal sets or compositional models in other frameworks are to be solved."
    }, {
      "heading" : "Acknowledgement",
      "text" : "This work was supported by the Czech Science Foundation (project 16- 12010S)."
    } ],
    "references" : [ {
      "title" : "rcdd: Computational Geometry, 2016",
      "author" : [ "ten by Komei Fukuda" ],
      "venue" : null,
      "citeRegEx" : "Fukuda.,? \\Q2016\\E",
      "shortCiteRegEx" : "Fukuda.",
      "year" : 2016
    } ],
    "referenceMentions" : [ ],
    "year" : 2017,
    "abstractText" : "Recently introduced composition operator for credal sets is an analogy of such operators in probability, possibility, evidence and valuationbased systems theories. It was designed to construct multidimensional models (in the framework of credal sets) from a system of lowdimensional credal sets. In this paper we study its potential from the computational point of view utilizing methods of polyhedral geometry.",
    "creator" : "LaTeX with hyperref package"
  }
}