{
  "name" : "1206.3293.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Propagation using Chain Event Graphs",
    "authors" : [ "Peter A. Thwaites", "Jim Q. Smith", "Robert G. Cowell" ],
    "emails" : [ ],
    "sections" : [ {
      "heading" : null,
      "text" : "Propagation using Chain Event Graphs Peter A. Thwaites Jim Q. Smith Robert G. CowellStatisti s Dept. Statisti s Dept Cass Business S hoolUniversity of Warwi k University of Warwi k City UniversityCoventry UK CV4 7AL Coventry UK CV4 7AL London EC1Y 8TZAbstra tA Chain Event Graph (CEG) is a graphi almodel whi h is designed to embody onditionalindependen ies in problems whose state spa esare highly asymmetri and do not admit anatural produ t stru ture. In this paper wepresent a probability propagation algorithmwhi h uses the topology of the CEG to build atransporter CEG. Intriguingly, the transporterCEG is dire tly analogous to the triangulatedBayesian Network (BN) in the more onven-tional jun tion tree propagation algorithmsused with BNs. The propagation method usesfa torization formulae also analogous to (butdi erent from) the ones using potentials on liques and separators of the BN. It appearsthat the methods will be typi ally more eÆ- ient than the BN algorithms when applied to ontexts where there is signi ant asymmetrypresent.1 INTRODUCTIONBased on an event tree, a Chain Event Graph (CEG)is a more expressive alternative to a dis rete BayesianNetwork (BN), embodying olle tions of onditionalindependen e statements in its topology. In Andersonand Smith (2008) it is shown not only how asymme-tries in a problem's sample spa e an be representedexpli itly through the topology of its CEG, but alsohow it an express a mu h wider range of types of on-ditional independen e statement not simultaneouslyexpressible through a single BN. As with the BN, theCEG of an hypothesised model an be interrogated us-ing natural language before the graph is embellishedwith probabilities. In Thwaites and Smith (2006) andRi omagno and Smith (2005) we demonstrate howthe CEG an also be used to represent and analysevarious ausal hypotheses. In this paper we ontinuethe development of CEGs by demonstrating how the graph provides a useful stru ture for fast probabilitypropagation in asymmetri models.It has been noted that the CEG is an espe ially power-ful framework for inferen e when a probability modelis highly asymmetri and eli ited through a des rip-tion of how situations unfold. Although theoreti allya BN an be used in this ontext, the lique probabil-ity tables are then very sparse and ontain many ze-ros or repeated probabilities. This impedes fast prop-agation algorithms and has led to the developmentof many ontext spe i variants of BNs (Boutilieret al 1996, M Allester et al 2004, Poole and Zhang2003, Salmeron et al 2000), often based on trees within liques. These developments provoke the question asto whether a single tree might be used for propagationinstead of the BN. Now obviously the event tree itselfexpresses no onditional independen ies in its topol-ogy and these independen ies are the building blo ksof urrent propagation algorithms. However, unlikethe event tree, the CEG expresses a fairly omprehen-sive olle tion of onditional independen ies. In thispaper we demonstrate the surprising fa t that thereis a dire t analogue between a distribution on a BNexpressed as a produ t of potentials supported by agraph of liques and separators, and propagation al-gorithms on CEGs using the distributions on the hil-dren of the CEG's non-leaf nodes and marginal likeli-hoods on the verti es themselves. This enables us todevelop fast propagation algorithms that use a singlegraph, the transporter CEG { analogous to a triangu-lated BN { as its framework. This framework is highlyeÆ ient for asymmetri /non-produ t-spa e ontexts,and in parti ular does not involve propagating zerosin sparse but large probability tables, nor ontinuallyrepeating the same al ulations, whi h would be the ase if we were to use the BN as a framework in thissort of environment with a naive BN propagation al-gorithm.In the next se tion we formally de ne the transporterCEG C(T ) of a hypothesised probability tree T . In\nse tion 3 we present an algorithm analogous to thatof Cowell and Dawid (1992) for a BN where ondi-tional probability tables asso iated with the hildrenof a given vertex of the CEG take the role of liques,and vertex probabilies take the role of separators. Inse tion 4 we demonstrate the eÆ ien y of this algo-rithm with a simple example.2 PROBABILITY TREES ANDCHAIN EVENT GRAPHSProbability trees (Shafer 1996), and their ontrol ana-logues de ision trees, have been found to be a very nat-ural and expressive framework for probability and de- ision problems, and they provide an ex ellent frame-work for des ribing sample spa e asymmetry and inho-mogeneity in a given ontext (see for example Fren hand Insua (2000)). We start with an event tree T withvertex set V (T ) and (dire ted) edge set E(T ). Hen e-forth all the tree's non-leaf verti es fvg situations,and denote this set of verti es S(T ) V (T ). We an onvert an event tree into a probability tree by spe ify-ing a transition matrix from its verti es V (T ), wherethe absorbing states orrespond to the leaf verti es.Transition probabilities from a situation are zero ex- ept for transitions to one of that situation's hildren.This makes the transition matrix upper triangular.Su h a matrix would look like the one in Table 1 whi hshows part of the matrix for the problem des ribed inExample 1. Note that ea h transition probability anbe identi ed by an edge on the tree.Table 1: Part of the transition matrix for Example 1v0 v1 v2 v3 v14 v24 v34 v15 v25 v11 v0 0 1 2 3 0 0 0 0 0 0 v1 0 0 0 0 5 0 0 0 0 4 v2 0 0 0 0 0 6 0 7 0 0 v3 0 0 0 0 0 0 8 0 9 0 ... ... ...One way of seeing onditional independen estatements on a BN is as identities in ertain ve tors of onditional probabilties { expli itly those probabilityve tors asso iated with di erent an estor on gura-tions but the same parent on guration of a variablein the BN (Ri omagno and Smith 2007). There is alarge lass of models where the probabilities in someof the rows of the transition matrix an be identitifedwith ea h other. The CEG is a topologi al representa-tion of this lass of models, and the transporter CEGde ned below is a subgraph of the CEG.Let T (vi), i = 1; 2 be the unique subtrees whose rootsare the situations vi, and whi h ontain all verti esafter vi in T . Say v1 and v2 are in the same positionw if:\n1. the trees T (v1) and T (v2) are topologi ally iden-ti al.2. there is a map between T (v1) and T (v2) su h thatthe edges in T (v2) are annotated, under that map,by the same (possibly unknown) probabilities asthe orresponding edges in T (v1).It is easily he ked that the set W (T ) of positions wpartitions S(T ). Furthermore, somewhat more sub-tlely, if v1; v2 2 w and vij 2 V (T (vi)), then the vertexsets of T (vi) i = 1; 2 are mapped on to ea h other bythis map, and vij 2 wj i = 1; 2 for some position wj(providing vij is not a leaf-vertex in either subtree).For details of this property see Anderson and Smith(2008).We now draw a new graph to depi t both the samplespa e of T and ertain onditional independen e state-ments. The transporter CEG C(T ) is a dire ted graphwhose verti es W (C(T )) are W (T ) [ fw1g. There isan edge (e 2 E(C(T ))) from w1 to w2 6= w1 for ea hsituation v2 2 w2 whi h is a hild of a xed repre-sentative v1 2 w1 for some v1 2 S(T ), and an edgefrom w1 to w1 for ea h leaf node v 2 V (T ) whi h isa hild of some xed representative v1 2 w1 for somev1 2 S(T ). The transporter CEG (hen eforth labelledsimply as C) is the subgraph of a CEG (de ned in An-derson and Smith (2008)) where all undire ted edgesin the CEG are omitted. The relationship between thetransporter CEG and the CEG is dire tly analogousto the relationship between a triangulated BN and theoriginal BN. Certain onditional independen e state-ments that an be lost through onditioning are simplyforgotten so that an homogeneous propagation algo-rithm an be onstru ted on the basis of the enduring onditional independen ies. Unlike the BN, this CEG an have many edges between two verti es and alwayshas a single sink vertex w1. Although typi ally hav-ing many fewer verti es than T , it retains a depi tionof the sample spa e stru ture of T . Thus it is easyto he k that the set of root to leaf paths of the tree(representing the set of all possible unfoldings of thehistory of a unit) are in one to one orresponden ewith the set of root to sink paths on the transporterCEG. The CEG- onstru tion pro ess is illustrated inExample 1.Example 1Consider the tree in Figure 1, whi h has 16 atoms(root-to-leaf paths). Note that as the subtrees rootedin the verti es fvi4g are the same, and those rooted infvi5g are the same, the distribution on the tree an bestored using 7 onditional tables whi h ontain 16 (9free) probabilities.Our transporter CEG (Figure 2) is produ ed by om-bining the verti es fvi4g into one position w4, the ver-\nti es fvi5g into one position w5, the verti es fvi6g intoone position w6, and all leaf-verti es into a single sink-node w1. The full CEG for our example is simple { ithas no undire ted edges, and is identi al to the trans-porter CEG C. For a simple CEG, all the onditionalindependen ies inherent in the problem are onveyedby the transporter CEG. θ 1= 0 .6 θ10\nθ11\nv0\nv1 v2\nv3\nv41\nv51\nv42\nv52\nθ10= 0 .65\nθ11= 0.25\nθ2= 0.25\nθ12= 0.1\nθ11\nθ 3 = 0.15\nθ10\nθ 14= 0.7 v43\nθ6= 0. 7\nθ 5= 0.35\nθ 12 θ 13= 0.3\nθ 4= 0.65\nθ7= 0.3 θ8= 0.4\nvinf1\nvinf2\nθ9= 0.6\nθ12 θ13\nθ 14\nθ15 = 0.65 θ 16 = 0.35\nθ15\nθ 16\nv61\nv62Figure 1: Tree for Example 1 w0 w2 w1\nwinf\nw3 (θ3)\nθ2= 0.25\nθ 1= 0\n.6\nθ 8= 0\n.4\nθ 7 = 0.3\nθ4= 0.65\nθ 3 = 0.15\nθ 11= 0.25\nθ 5= 0.35\nθ 6= 0 .7\n(θ1θ5 + θ2θ6 + θ3θ8) w4\nw5 (θ2θ7 + θ3θ9)\nθ12= 0.1\nθ9= 0.6\nθ10= 0.65\nθ 13= 0.3\nθ14= 0.7\n(θ1)\n(θ2)\nw6 (θ2θ7θ14 + θ3θ9θ14)\nθ 15 =\n0. 65\nθ 16 =\n0. 35\nFigure 2: Transporter CEG for Example 1Figure 2 shows the probabilities of rea hing ea h po-sition w (the event rea hing w, denoted (w), is theunion of all root-to-sink paths passing through w). Italso shows ea h edge-probability e(w0 j w)(= ( (e(w;w0)) j (w)), where (e(w;w0)) is theunion of all root-to-sink paths utilising the edgee(w;w0) ).The problem represented by the tree in Figure 1 isasymmetri in that not all the root-to-leaf paths areof the same length, and also in the lo al stru ture as-so iated with its verti es. We do not know whetherthe verti es fvi4g are related in any ontextual way tothe verti es fvi5g or fvi6g, and hen e we annot obvi-ously de ne variables on the sigma-algebra of the treeto allow us to represent the problem as a BN. Evensupposing we were able to represent the problem in\nsu h a way, the onditional independen ies embodiedin the problem (and in our transporter CEG) annotbe eÆ iently oded in a BN without introdu ing ta-bles with many zeros. Consequently, even in this verysimple example we have eÆ ien y gains in storing thisdistribution over using a saturated model, a BN, or atree.3 A SIMPLE PROPAGATIONALGORITHM3.1 THE FRAMEWORKTo spe ify the joint distribution of all random vari-ables measurable with respe t to a CEG we simplyneed to spe ify the ve tor of onditional probabilitymass fun tions asso iated with ea h of its positions.The rst step of our propagation algorithm is analo-gous to the triangulation step for a BN, whi h allowsus to retain all onditional independen e properties atthe ost of a possible loss of eÆ ien y. To do this weignore onditional independen e statements oded bythe undire ted edges of the CEG and work only withthe subgraph onsisting of its positions, together withits dire ted edges, but not its undire ted edges { ourtransporter CEG C.For ea h position w 2 W = W (C)nfw1g we store ave tor of probabilites (w) = f e(w0 j w) j e(w;w0) 2E(w)g where E(w) E(C) is the set of all edgesemanating from w. (w) is of ourse a onditionalprobability distribution. We let X(w) be the randomvariable taking values on f1; 2; : : : ; n(E(w))g (wheren(E(w)) is the number of edges emanating from w)whose probability mass fun tion is given by the om-ponents of (w) taken in order. The positions w 2Wtake the role of the liques in a triangulated BN, whilstthe ve tors f (w) j w 2 Wg are analogous to the liqueprobability tables.We an now spe ify the probability of every atom (a root to sink path of C, of length n( ) ) as a fun tionof f (w) j w 2 Wg and C. If: = (w0 = w [0℄; e [1℄; w [1℄; : : : ; e [n( )℄; w1)then = n( )Yi=1 (e [i℄)where (e [i℄) is a omponent of the probability ve -tor (w [i 1℄), 1 i n( ). It follows that thedistribution of any random variable measurable withrespe t to C an be al ulated from f (w) j w 2Wg.3.2 COMPATIBLE OBSERVATIONSRe all that propagation algorithms for BNs based ontriangulation are only designed to propagate informa-tion that an be expressed in the form\nO(A) = fXj 2 Ajg for some subsets fAjg of thesample spa es of fXjg the vertex-variables of the BN.Propagating information about the value of some gen-eral fun tion of the vertex variables using lo al mes-sage passing is not generally possible, be ause ondi-tioning on the values of su h a fun tion an destroy the onditional independen ies on whi h the lo al steps ofthe propagation algorithm depend for their validity.In the same way the types of observation we an ef- iently propagate using C and f (w) j w 2 Wgneeds to be onstrained. In general an observation an be identi ed with a subset of the set of allroot to sink paths f g. The most obvious onstrain-ing assumption on (and the one we will hen eforthmake in this paper) about what we might learn isthat our observation an be identi ed with havinglearned that fX(w) 2 A(w)g for some subsets fA(w)gof the sample spa es of the position random variablesfX(w)g. Call su h a set C ompatible. Note that is C ompatible if and only if there exists possiblyempty subsets fE (w) j w 2Wg su h that = f j e 2 E (w) for some w 2W; for ea h edgee on the path in CgSo we an identify a ompatible observation with theset of edges E = Sw2W E (w) E(C). We notethat the set of ompatible observations is large andin parti ular when the CEG is expressible as a BN ontains all sets of the form O(A) de ned above.Example 2Consider: = f j e 2 fe1(w0; w1); e2(w0; w2); e4(w1; w1);e5(w1; w4); e6(w2; w4); e7(w2; w5); e10(w4; w1);e11(w4; w1); e14(w5; w6); e15(w6; w1)ggThis orresponds to all the root-to-sink paths in thesubgraph of C given in Figure 3. w0 w2 w1\nwinf\nw4\nw5 w6Figure 3: Subgraph for event in Example 2\n3.3 MESSAGE PASSING FROMCOMPATIBLE OBSERVATIONS ONA CEGThe message passing algorithm is a fun tion from theoriginal probabilities f (w) j w 2Wg to revised prob-abilities on the same graph f̂(w) j w 2 Wg ondi-tional on the observation . Note that on e edge-probabilities have been revised, the resulting graphmay not be a minimal CEG (in that we may haveverti es within the graph whi h are the roots of iden-ti al sub-graphs). It is possible (although unne essaryfor information-propagating purposes) to add a fur-ther algorithm step to produ e a minimal CEG if thisis required. This step ensures that any verti es thatare equivalent are ombined into a single position.Messages are passed from the terminal edges ba k-wards through the transporter CEG along neighbour-ing edges until rea hing the root in a olle t step givinga new pair f (w); (w) j w 2Wg. We then move for-ward from the root produ ing revised f̂(w) j w 2Wg.Let W ( 1) denote the set of positions all of whoseoutgoing edges terminate in w1 in C.1. For any edge e(w;w1) su h that w 2W ( 1), setthe potential e(w1 j w) = 0 if e(w;w1) =2 E ,and e(w1 j w) = e(w1 j w) if e(w;w1) 2 E .Let the emphasis: (w) = Xe2E(w) e(w1 j w)Say that w1 and ea h of these positions is a om-modated.2. For any position w all of whose hildren are a - ommodated, and edge e(w;w0), set the potential e(w0 j w) = 0 if e(w;w0) =2 E , and e(w0 j w) = e(w0 j w) (w0) if e(w;w0) 2 E . Let the em-phasis: (w) = Xe2E(w) e(w0 j w)Say that w is a ommodated.3. Repeat step 2 until all w 2 W are a ommodated.This ompletes the olle t steps.4. For all w 2W , set:̂(w) = 0 if (w) = 0̂(w) = (w) (w) if (w) 6= 0where (w) = f e(w0 j w) j e(w;w0) 2 E(w)g.Clearly we have that:̂e(w0 j w) = 0 if e(w;w0) =2 E ̂e(w0 j w) = e(w0 j w) (w) if e(w;w0) 2 E\nA proof of these results is given in the appendix.Note that as we move forward through the graph theupdated probabilities of (w0; w) subpaths will be ofthe form: ̂ (w j w0) =Yi=0 ̂e(wi+1 j wi)and we get:̂ ( (w)) = X 2f (w0;w)g ̂ (w j w0)From the de nition of a ommodation, the order ofthese operations (like the perfe t order used to updatea triangulated BN) depends only on the toplogy of C,so it an be set up beforehand.Example 3Steps 1, 2 and 3 give us the graph in Figure 4. Step 4gives us the CEG in Figure 5 (note that our CEG isagain simple, and also minimal without the need forthe additional step previously mentioned). 0.579 + 0.1916 w2 w1\nwinf 0.3 x 0.455\n0.65\n0.25\n0.35 x 0.9\n0.7 x 0.9\n0.65 + 0.25 w4\nw5 0.455\n0.65\n0. 65\n0.65 + 0.315\n0.63 + 0.1365\nw0\n0. 6\nx 0.\n96 5\n0.25 x 0.7665\nw6 0.65 0.7 x 0.65Figure 4: Potentials and emphases added w2 w1\nwinf\n0.65 / 0.965 = 0.674\n0.315 / 0.965 = 0.326\nw4\nw5\n0.65 / 0.9 = 0.722\n1\nw0\n0.579 / 0.771 = 0.751\n0.192 / 0.771 = 0.249\n0.25 / 0.9 = 0.278\n0.63 / 0.767 = 0.822\n0.137 / 0.767 = 0.178\nw6 1Figure 5: Updated CEG C Note that, in analogy with equation (6) of Cowell andDawid (1992), the onditional probability of any atom\n= (w0 = w [0℄; e [1℄; w [1℄; : : : ; e [n( )℄; w1) isgiven by the invarian e formula: ( j ) = ̂( ) = n( )Yi=1 ̂(e [i℄) = n( )Qi=1 (e [i℄)n( ) 1Qi=0 (w [i℄)Also note that at the ost of some omputation, we an perform inferen e on the redu ed graph C whoseedges E(C ) are just the edges e in E(C) with non-zero probabilities ̂(e), and whose verti es W (C ) arethe w 2 W (C) for whi h (w) 6= 0. The non-zeroedge and vertex probabilities of C then simply mapon to their orresponding edge and vertex probabilitiesin C . Note that, unlike for the BN, any non trivialC ompatible observation stri tly redu es the numberof edges in the edge set after this operation.A pseudo- ode version of our algorithm is providedbelow:Let C(W (C); E(C)) be a transporter CEG with edgesin E(C) having labels ei; i = 1; 2; : : : ne, su h thati < j ) ei ej (ei does not lie downstream of ej onany w0 ! w1 path); and positions in W (C)nfw1ghaving labels wi; i = 0; 1; 2; : : :mw, su h that i < j )wi wj . To update the edge-probabilities on C fol-lowing observation of an event , do:(1) Set A = (2) Set B = (3) Set i = 1(4) Repeat(a) Sele t ei(b) If ei 2 E , add ei to Aotherwise, set ̂ei = 0( ) Set i = i+ 1Until i = ne + 1(5) Set (w1) = 1(6) Set j = mw(7) Repeat(a) Sele t wj(b) Repeat(i) Sele t e(wj ; w0j) 2 E(wj) \\ A(ii) Set e(w0j j wj) = e(w0j j wj) (w0j)(iii) Add e(wj ; w0j) to BUntil E(wj) \\ A B( ) Set (wj) =Pe2E(wj) e(w0j j wj)(d) Set j = j 1Until j = 1(8) For ea h e(w;w0) 2 E , set ̂e(w0 j w) = e(w0 j w) (w)(9) Return f̂eg4 A CLOSER LOOK AT OUREXAMPLEConsider the CEG in Figure 2 and let the 16 edges belabelled ei in the same order as the f ig thereon. In\nExamples 1 to 3 we showed how to reate and use aTransporter CEG without on erning ourselves with a ontext. We now add that ontext and suppose thatthis CEG represents a Treatment regime for a seriousmedi al ondition, and the edges arry the meaningsgiven in Table 2:Table 2: Edge des riptorsEdge Des riptione1 Not riti al { Treatment pres ribed Ie2 Liver failure { Treatment : : : IIe3 Liver & Kidney failure { Treatment : : : IIe4 Responds to I { Full re overye5 No response to I { Surgery pres ribed IIIe6; e8 Responds to II { Surgery : : : IIIe7; e9 No response to II { Surgery : : : IVe10 Re overy { Lifetime monitoringe11 Re overy { Lifetime medi atione12; e13 Death in surgerye14 Survives surgery IV { Treatment : : : Ve15 Re overy { Lifetime on treatment Ve16 No response to V { DiesAs alluded to in se tion 2, it is not possible to representthis regime eÆ iently as a BN, nor yet as a ontext-spe i BN, given that the asymmetry of the prob-lem does not just lie in it having asymmetri samplespa e stru tures. By equating the des riptions of edgese4 and e10; edges e11 and e15; and edges e12; e13 ande16, we an however approximate the problem witha 4-variable BN; where X1 Diagnosis and initial treat-ment an take values orresponding to the out omesfNot riti al, Liver failure, Liver & Kidney failureg;X2 2nd treatment to fNone, III, IVg; X3 3rd treatmentto fNone, Vg; and X4 Response to fDeath, Partial re- overy, Full re overyg. The BN for this approximationto the model is given in Figure 6. X1\nX3\nX2\nX4Figure 6: BN for our exampleTo store the model using a CEG requires 16 ells ( or-responding to the 16 edges), but in this BN 27 ells (9for the lique fX1; X2g and 18 for fX2; X3; X4g), 14of whi h are storing the value zero.The event in our example orresponds to the ob-servation that a patient was not diagnosed with Liverand Kidney failure, and is still alive. Propagationof this event enables a pra titioner to establish prob-\nability distributions for the possible histories of ourpatient. Note that it is only the fa t that we an de-s ribe in su h a simple manner that has allowed usto approximate the problem with the BN in Figure 6.Propagating of the event using a simple Jun tionTree algorithm on the liques of the BN takes a mini-mum of 43 operations. Propagation on the CEG usingour algorithm requires 32 operations ( orrespondingto 16 ba kward edges, 6 ba kward verti es and 10 for-ward edges). So even in this simple example, usingthe CEG is more eÆ ient than the BN. The eÆ ien yhere is due mainly to the fa t that the lique probabil-ity tables ontain many zeros. This is re e ted in theCEG by the w0 ! w1 paths not all having the samelength. It is this form of asymmetry in a model that ontext-spe i BNs do not ope with adequately, andwhy CEGs are a better stru ture for use with this typeof problem.The problems in whi h the algorithm des ribed aboveare most eÆ ient are when the CEG stru ture is knownto be simple. To store the probability tables for theCEG requires only N = #(W (C)) + #(E(C))< 2#(E(C)) ells. In this ase the olle t step involvesonly N al ulations and the topology of the CEG isvalid so that in parti ular the original probability ta-ble stru ture an be preserved. The potential produ tne essitates only a single distribute step whi h againonly involves at most N al ulations. For large treeswith mu h of the type of subtree symmetry dis ussedabove the propagation is extremely fast.It is worth qui kly looking at a very simple exam-ple arising from model sele tion in graphi al or par-tition model problems, an area urrently attra tingsome interest: Consider a model with random vari-ables X1; : : : Xn, where X1 with M = 1=2(n 1)(n 2) possible states, determines whi h pair of bi-nary variables from fX2; : : : Xng are dependent, allother variables from fX2; : : :Xng being independentof ea h other and of the pair determined. The CEG ofthis model has at most M(1 + 2n) edges and 2 +Mnpositions, whereas the BN is a single lique requiringM 2n 1 ells for storage. As the number of opera-tions required for propagation on both the BN and theCEG is of the same order of magnitude as the numberof ells required for storage, it is lear that the CEGis far more eÆ ient in this example.5 DISCUSSIONThere are several advantages of this method over the oding of this type of problem through a BN. Firstly,the al ulated probabilities an be proje ted ba k onto the edges of the eli ited tree, so that the onse-quen es of inferen es given di erent types of informa-tion an be immediately appre iated by the pra ti-\ntioner. Se ondly, the a ommmodation of data in theform of a ompatible observation is mu h more generalthan the a ommodation of subsets of observationsfrom a predetermined set of random variables, so theCEG provides a more exible framework for propaga-tion, parti ularly when data is ontingently ensored.Thirdly, there are eÆ ien y gains as outlined above.We intend to show how great these gains an be forvery large problems in a later paper.Note also that, as is the ase with the triangulationstep in BN-based algorithms, there are faster algo-rithms (Thwaites 2008) than the one des ribed above,although they lose some of this algorithm's generality.Our algorithms are urrently being oded by Cowellwithin freely available software, and will be availableshortly.Of ourse BNs provide a simpler representation ofmore symmetri problems and should always be pre-ferred when the three ontingen ies are not satisi ed.The CEG does not provide a universal improvementover the BN for propagation. In parti ular in prob-lems when the underlying BN is de omposable but theCEG is not simple the BN propagation an be mu hmore eÆ ient. But in highly asymmetri problems,the CEG should de nitely be a rst hoi e.It should be noted that it is also possible to de ne adynami analogue of the CEG, and our investigationof these suggests that a time-sli ed CEG (analogousto a time-sli ed BN) will be an ideal vehi le for a dy-nami updating algorithm. We hope to report on thesedevelopments in the near-future.APPENDIXWe laim that:̂e(w0 j w) , ( (e(w;w0)) j ; (w))= ( e(w0 j w) (w) if e(w;w0) 2 E 0 if e(w;w0) 62 E Proof:For a CEG C, and C ompatible event , let T bethe tree asso iated with C, T the tree asso iated withC , and T( ) the subtree of T ontaining only thoseroot-to-leaf paths in . T( ) di ers from T in thatthe former retains the edge-probabilities from T .Consider a position w 2 C (w 2 C ) orresponding toa set of verti es fvig 2 T . Then the subtrees rootedin ea h vi are identi al both in topology and in theiredge-probabilities.If there is a subpath (w0; w) whi h is not part of aw0 ! w1 path in (ie. (w0; w) exists in C, but notin C ) then there will exist a subset of fvig whi h doesnot exist in T (or T( )). We split the set fvig into:\nfvigi2I verti es existing in T fvigi2J verti es not existing in T Be ause is C ompatible, the subtrees in T( )rooted in ea h vi 2 fvigi2I are also identi al bothin topology and in their edge-probabilities that theyretain from T .Suppose there exists an edge e(w;w0) in C, then forea h vi 2 fvig, there exists an edge e(vi; v0i) in T or-responding to this edge. Note that: (w) = [i2I[J (vi) (e(w;w0)) = [i2I[J (e(vi; v0i)) e(v0i j vi) = e(w0 j w) 8i 2 I [ Jand sin e the subtrees in T( ) rooted in ea hvi 2 fvigi2I are identi al, we also have: ( j (vi)) = ( j (vj)) ( ; (e(vi; v0i)) j (vi)) = ( ; (e(vj ; v0j)) j (vj))for i; j 2 I[ ( j (vi)) is the sum of the probabilities of all the (vi; vleaf ) subpaths in T( ), and ( ; (e(vi; v0i)) j (vi)) is the sum of the probabili-ties of all the (vi; e(vi; v0i); v0i; vleaf ) subpaths in T( )℄So:̂e(w0 j w) = ( (e(w;w0)) j ; (w))= ( ; (w); (e(w;w0))) ( ; (w))= ( ;Si2I[J [ (vi); (e(vi; v0i))℄) ( ;Si2I[J (vi))(an expression evaluated on T )sin e (vi) \\ (e(vj ; v0j)) = for i 6= j= Pi2I[J ( ; (vi); (e(vi; v0i)))Pi2I[J ( ; (vi))But \\ (vi) = for vi 2 fvigi2J , so this equals:Pi2I ( ; (vi); (e(vi; v0i)))Pi2I ( ; (vi))= Pi2I ( ; (e(vi; v0i)) j (vi)) ( (vi))Pi2I ( j (vi)) ( (vi))= ( ; (e(vj ; v0j)) j (vj)) Pi2I ( (vi)) ( j (vj)) Pi2I ( (vi))for any vj 2 fvigi2I= ( ; (e(vj ; v0j)) j (vj)) ( j (vj))for any vj 2 fvigi2ITurning our attention to the terms in the algorithm,we laim that (w) = ( j (vi)) and e(w0 j w) = ( ; (e(vi; v0i)) j (vi)) (vi 2 fvigi2I) for all w;e(w;w0) 2 C , where fvigi2I is the set of verti es inT( ) orresponding to w. We prove this by indu tion:\nStep 1.Consider positions w 2W ( 1). Then: (w) =Xe e(w1 j w) =Xe e(w1 j w)=Xe e(vleaf j vi) in T( )for any vi 2 fvigi2I= ( j (vi))Step 2.Suppose w is su h that all of its outgoing edges termi-nate in positions fw0g for whi h (w0) = ( j (v0i)). Then: (w) =Xe e(w0 j w) =Xe e(w0 j w) (w0)=Xe e(v0i j vi) ( j (v0i))for any vi 2 fvigi2I=Xe ( (e(vi; v0i)) j (vi)) ( j (v0i))But (v0i) = (e(vi; v0i)) (vi) in a tree, so thisequals: Xe ( (e(vi; v0i)); (v0i) j (vi)) ( j (vi); (e(vi; v0i)); (v0i))=Xe ( ; (e(vi; v0i)); (v0i) j (vi))=Xe ( ; (e(vi; v0i)) j (vi))= ( ; (vi) j (vi)) = ( j (vi))Hen e: e(w0 j w) = e(w0 j w) (w0)= e(v0i j vi) ( j (v0i))for any vi 2 fvigi2I= ( (e(vi; v0i)) j (vi)) ( j (v0i))= : : : = ( ; (e(vi; v0i)) j (vi))We now ombine our two results to give:̂e(w0 j w) = ( ; (e(vj ; v0j)) j (vj)) ( j (vj))= e(w0 j w) (w) A knowledgementsThis work has been partly funded by the EPSRC as\npart of the proje t Chain Event Graphs: Semanti sand Inferen e.Referen es[1℄ P. E. Anderson and J. Q. Smith. Conditional in-dependen e and Chain Event Graphs. Arti ialIntelligen e, 172:42{68, 2008.[2℄ C. Boutilier, N. Friedman, M. Goldszmidt, andD. Koller. Context-spe i independen e inBayesian Networks. In Pro eedings of the 12thConferen e on Un ertainty in Arti ial Intelli-gen e, pages 115{123, Portland, Oregon, 1996.[3℄ R. G. Cowell and A. P. Dawid. Fast retra tion ofeviden e in a probabilisti expert system. Statis-ti s and Computing, 2:37{40, 1992.[4℄ S. Fren h and D. R. Insua. Statisti al De isionTheory. Arnold, 2000.[5℄ D. M Allester, M. Collins, and F. Periera. Casefa tor diagrams for stru tured probabilisti mod-eling. In Pro eedings of the 20th Conferen e onUn ertainty in Arti ial Intelligen e, pages 382{391, 2004.[6℄ D. Poole and N. L. Zhang. Exploiting ontextualindependen e in probabilisti inferen e. Jour-nal of Arti ial Intelligen e Resear h, 18:263{313,2003.[7℄ E. M. Ri omagno and J. Q. Smith. The ausalmanipulation and Bayesian estimation of ChainEvent Graphs. Resear h Report 05-16, CRiSM,2005.[8℄ E. M. Ri omagno and J. Q. Smith. The geometryof ausal probability trees that are algebrai ally onstrained. In L. Pronzato and A. Zhigljavsky,editors, Optimal Design and Related Areas in Op-timization and Statisti s, hapter 6, pages 131{151. Springer-Verlag, 2007.[9℄ A. Salmeron, A. Cano, and S. Moral. Importan esampling in Bayesian Networks using probabilitytrees. Computational Statisti s and Data Analy-sis, 34:387{413, 2000.[10℄ G. Shafer. The Art of Causal Conje ture. MITPress, 1996.[11℄ P. A. Thwaites. Chain Event Graphs: Theory andappli ation. PhD thesis, University of Warwi k,2008.[12℄ P. A. Thwaites and J. Q. Smith. Evaluating ausale e ts using Chain Event Graphs. In Pro eedingsof the 3rd European Workshop on Probabilisti Graphi al Models, pages 291{300, Prague, 2006."
    } ],
    "references" : [ ],
    "referenceMentions" : [ ],
    "year" : 2008,
    "abstractText" : null,
    "creator" : "dvips(k) 5.86 Copyright 1999 Radical Eye Software"
  }
}