{
  "name" : "1705.05414.pdf",
  "metadata" : {
    "source" : "CRF",
    "title" : "Key-Value Retrieval Networks for Task-Oriented Dialogue",
    "authors" : [ "Mihail Eric", "Christopher D. Manning" ],
    "emails" : [ "meric@cs.stanford.edu,", "manning@stanford.edu" ],
    "sections" : [ {
      "heading" : "1 Introduction",
      "text" : "With the success of new speech-based humancomputer interfaces, there is a great need for effective task-oriented dialogue agents that can handle everyday tasks such as scheduling events and booking hotels. Current commercial dialogue agents are often brittle pattern-matching systems which are unable to maintain the kind of flexible conversations that people desire. Neural dialogue agents present one of the most promising avenues for leveraging dialogue corpora to build statistical models directly from data by using powerful distributed representations (Bordes and Weston, 2016; Wen et al., 2016b; Dhingra et al., 2016).\nWhile this work has been somewhat successful, these task-oriented neural dialogue models suffer from a number of problems: 1) They struggle to effectively reason over and incorporate knowledge base information while still preserving their endto-end trainability and 2) They often require explicitly modelling user dialogues with belief trackers and dialogue state information, which necessitates additional data annotation and also breaks differentiability.\nTo address some of the modelling issues in previous neural dialogue agents, we introduce a new architecture called the Key-Value Retrieval Network. This model augments existing recurrent network architectures with an attention-based key-value retrieval mechanism over the entries of a knowledge base, which is inspired by recent work on key-value memory networks (Miller et al., 2016). By doing so, it is able to learn how to extract useful information from a knowledge base directly from data in an end-to-end fashion, with-\nar X\niv :1\n70 5.\n05 41\n4v 1\n[ cs\n.C L\n] 1\n5 M\nay 2\n01 7\nout the need for explicit training of belief or intent trackers as is done in traditional task-oriented dialogue systems. The architecture has no dependence on the specifics of the data domain, learning how to appropriately incorporate world knowledge into its dialogue utterances via attention over the key-value entries of the underlying knowledge base.\nIn addition, we introduce and make publicly available a new corpus of 3,031 dialogues spanning three different domain types in the incar personal assistant space: calendar scheduling, weather information retrieval, and point-ofinterest navigation. The dialogues are grounded through knowledge bases. This makes them ideal for building dialogue architectures that seamlessly reason over world knowledge. The multi-domain nature of the dialogues in the corpus also makes this dataset an apt test bed for generalizability of modelling architectures.1\nThe main contributions of our work are therefore two-fold: 1) We introduce the Key-Value Retrieval Network, a highly performant neural taskoriented dialogue agent that is able to smoothly incorporate information from underlying knowledge bases through a novel key-value retrieval mechanism. Unlike other dialogue agents which only rely on prior dialogue history for generation (Kannan et al., 2016; Eric and Manning, 2017), our architecture is able to access and use database-style information, while still retaining the text generation advantages of recent neural models. By doing so, our model outperforms a competitive rulebased system and other baseline neural models on a number of automatic metrics as well as human evaluation. 2) We release a new publicly-available dialogue corpus across three distinct domains in the in-car personal assistant space that we hope will help further work on task-oriented dialogue agents."
    }, {
      "heading" : "2 Key-Value Retrieval Networks",
      "text" : "While recent neural dialogue models have explicitly modelled dialogue state through belief and user intent trackers (Wen et al., 2016b; Dhingra et al., 2016; Henderson et al., 2014), we choose instead to rely on learned neural representations for implicit modelling of dialogue state, forming a truly end-to-end trainable system. Our model starts with an encoder-decoder sequence architec-\n1The data will be made available at a later date.\nture and is further augmented with an attentionbased retrieval mechanism that effectively reasons over a key-value representation of the underlying knowledge base. We describe each component of our model in the subsequent sections."
    }, {
      "heading" : "2.1 Encoder",
      "text" : "Given a dialogue between a user (u) and a system (s), we represent the dialogue utterances as {(u1, s1), (u2, s2), . . . , (uk, sk)} where k denotes the number of turns in the dialogue. At the ith turn of the dialogue, we encode the aggregated dialogue context composed of the tokens of (u1, s1, . . . , si−1, ui). Letting x1, . . . , xm denote these tokens, we first embed these tokens using a trained embedding function φemb that maps each token to a fixed-dimensional vector. These mappings are fed into the encoder to produce contextsensitive hidden representations h1, . . . , hm, by repeatedly applying the recurrence:\nhi = LSTM(φemb(xi), hi−1). (1)\nwhere the recurrence uses a long-short-term memory unit, as described by (Hochreiter and Schmidhuber, 1997)."
    }, {
      "heading" : "2.2 Decoder",
      "text" : "The vanilla sequence-to-sequence decoder predicts the tokens of the ith system response si by first computing decoder hidden states via the recurrent unit. We denote h̃1, . . . , h̃n as the hidden states of the decoder and y1, . . . , yn as the output tokens. We extend this decoder with an attentionbased model (Bahdanau et al., 2015; Luong et al., 2015a), where, at every time step t of the decoding, an attention score ati is computed for each hidden state hi of the encoder, using the attention mechanism of (Vinyals et al., 2015). Formally this attention can be described by the following equations:\nuti = w T tanh(W2 tanh(W1[hi, h̃t]))) (2) ati = Softmax(u t i) (3)\nh̃′t = m∑ i=1 atihi (4) ot = U [h̃t, h̃ ′ t] (5) yt = Softmax(ot) (6)\nwhere U , W1, W2, and w are trainable parameters of the model and ot represents the logits over the\ntokens of the output vocabulary V . In (2) above, the attention logit on hi is computed via a twolayer MLP function with a tanh nonlinearity at the intermediate layers. During training, the next token yt is predicted so as to maximize the loglikelihood of the correct output sequence given the input sequence."
    }, {
      "heading" : "2.3 Key-Value Knowledge Base Retrieval",
      "text" : "Recently, some neural task-oriented dialogue agents that query underlying knowledge bases (KBs) and extract relevant entities either do the following: 1) create and execute well-formatted API calls to the KB, operations which require intermediate supervision in the form of training slot trackers and which break differentiability (Wen et al., 2016b), or 2) softly attend to the KB and combine this probability distribution with belief trackers as state input for a reinforcement learning policy (Dhingra et al., 2016). We choose to build off the latter approach as it fits nicely into the end-to-end trainable framework of sequenceto-sequence modelling, though we are in a supervised learning setting and we do away with explicit representations of belief trackers or dialogue state.\nFor storing the KB of a given dialogue, we take inspiration from the work of (Miller et al., 2016) which found that a key-value structured memory allowed for efficient machine reading of documents. We store every entry of our KB using a (subject, relation, object) representation. In our representation a KB entry from the dialogue in Figure 1 such as (event=dinner, time=8pm, date=the 13th, party=Ana, agenda=“-”) would be normalized into four separate triples of the form (dinner, time, 8pm). Every KB has at most 230 normalized triples. This formalism is similar to a neo-Davidsonian or RDF-style representation of events.\nRecent literature has shown that incorporating a copying mechanism into neural architectures improves performance on various sequenceto-sequence tasks (Jia and Liang, 2016; Gu et al., 2016; Ling et al., 2016; Gulcehre et al., 2016; Eric and Manning, 2017). We build off this intuition in the following way: at every timestep of decoding, we take the decoder hidden state and compute an attention score with the key of each normalized KB entry. For our purposes, the key of an entry corresponds to the sum of the word embeddings\nof the subject (meeting) and relation (time). The attention logits then become the logits of the value for that KB entry. For our KB attentions, we replace the embedding of the value with a canonicalized token representation. For example, the value 5pm is replaced with the canonicalized representation meeting time. At runtime, if we decode this canonicalized representation token, we convert it into the actual value of the KB entry (5pm in our running example) through a KB lookup. Note that this means we are expanding our original output vocabulary to |V | + n where n is the number of separate canonical key representation KB entries.\nIn particular, let kj denote the word embedding of the key of our j th normalized KB entry. We can now formalize the decoding for our KB attentionbased retrieval. Assume that we have m distinct triples in our KB and that we are in the tth timestep of decoding:\nutj = r T tanh(W ′2 tanh(W ′ 1[kj , h̃t]))) (7) ot = U [h̃t, h̃ ′ t] + v̄ t (8) yt = Softmax(ot) (9)\nwhere r, W ′1, and W ′ 2 are trainable parameters. In (8) above, v̄t is a sparse vector with length |V | + n. Within v̄t, the entry for the value embedding vj corresponding to the key kj is equal to the logit score utj on kj . Hence, the m entries of v̄t corresponding to the values in the KB are non-zero, whereas the remaining entries corresponding to the original vocabulary tokens are 0. This sparse vector contains our aggregated KB logit scores which we combine with the original logits to get a modified ot. We then select the argmax token as input to the next timestep. This description seeks to capture the intuition that in response to the query What time is my meeting, we want the model to put a high attention weight on the key representation for the (meeting, time, 5pm) KB triple, which should then lead the model to favor outputting the value token at the given timestep. We provide a visualization of the KeyValue Retrieval Network in Figure 2."
    }, {
      "heading" : "3 A Multi-Turn, Multi-Domain Dialogue Dataset",
      "text" : "In an effort to further work in multi-domain dialogue agents, we built a corpus of multi-turn dialogues in three distinct domains: calendar scheduling, weather information retrieval, and\npoint-of-interest navigation. While these domains are different, they are all relevant to the overarching theme of tasks that users would expect of a sophisticated in-car personal assistant."
    }, {
      "heading" : "3.1 Data Collection",
      "text" : "The data for the multi-turn dialogues was collected using a Wizard-of-Oz scheme inspired by that of (Wen et al., 2016b). In our scheme, users had two potential modes they could play: Driver and Car Assistant. In the Driver mode, users were presented with a task that listed certain information they were trying to extract from the Car Assistant as well as the dialogue history exchanged between Driver and Car Assistant up to that point. An example task presented could be: You want to find what the temperature is like in San Mateo over the next two days. The Driver was then only responsible for contributing a single line of dialogue that appropriately continued the discourse given the prior dialogue history and the task definition.\nTasks were randomly specified by selecting values (5pm, Saturday, San Francisco, etc.) for three to five slots (time, date, location, etc.), depending on the domain type. Values specified for the slots were chosen according to a uniform dis-\ntribution from a per-domain candidate set.\nIn the Car Assistant mode, users were presented with the dialogue history exchanged up to that point in the running dialogue and a private knowledge base known only to the Car Assistant with information that could be useful for satisfying the Driver query. Examples of knowledge bases could include a calendar of event information, a collection of weekly forecasts for nearby cities, or a collection of nearby points-of-interest with relevant information. The Car Assistant was then responsible for using this private information to provide a single utterance that progressed the user-directed dialogues. The Car Assistant was also asked to fill in dialogue state information for mentioned slots and values in the dialogue history up to that point.\nEach private knowledge base had six to seven distinct rows and five to seven attribute types. The private knowledge bases used were generated by uniformly selecting a value for a given attribute type, where each attribute type had a variable number of candidate values. Some knowledge bases intentionally lacked attributes to encourage diversity in discourse.\nDuring data collection, some of the dialogues in the calendar scheduling domain did not explicitly require the use of a KB. For example, in\na task such as Set a meeting reminder at 3pm, we hoped to encourage dialogues that required the Car Assistant to execute a task while asking for Driver clarification on underspecified information. Roughly half of the scheduling dialogues fell into this category.\nWhile specifying the attribute types and values in each task presented to the Driver allowed us to ground the subject of each dialogue with our desired entities, it would occasionally result in more mechanical discourse exchanges. To encourage more naturalistic, unbiased utterances, we had users record themselves saying commands in response to underspecified visual depictions of an action a car assistant could perform. These commands were transcribed and then inserted as the first exchange in a given dialogue on behalf of the Driver. Roughly ∼1,500 of the dialogues employed this transcribed audio command firstutterance technique.\n241 unique workers from Amazon Mechanical Turk were anonymously recruited to use the interface we built over a period of about six days. Data statistics are provided in Table 1 and slot types and values are provided in Table 2. A screenshot of the user-facing interfaces for the data collection, as well as a visual used to prompt user recorded commands, are provided in the supplementary material."
    }, {
      "heading" : "4 Related Work",
      "text" : "Task-oriented agents for spoken dialogue systems have been the subject of extensive research ef-\nfort. One line of work by (Young et al., 2013) has tackled the problem using partially observable Markov decision processes and reinforcement learning with carefully designed action spaces, though the number of distinct action states makes this approach often brittle and computationally intractable.\nThe recent successes of neural architectures on a number of traditional natural language processing subtasks (Bahdanau et al., 2015; Sutskever et al., 2014; Vinyals et al., 2015) have motivated investigation into dialogue agents that can effectively make use of distributed neural representations for dialogue state management, belief tracking, and response generation. Recent work by (Wen et al., 2016b) has built systems with modularly-connected representation, belief state, and generation components. These models learn to explicitly represent user intent through intermediate supervision, which breaks end-to-end trainability. Other work by (Bordes and Weston, 2016; Liu and Perez, 2016) stores dialogue context in a memory module and repeatedly queries and reasons about this context to select an adequate system response from a set of all candidate responses.\nAnother line of recent work has developed taskoriented models which are amenable to both supervised learning and reinforcement learning and are able to incorporate domain-specific knowledge via explicitly-provided features and model-output restrictions (Williams et al., 2017). Our model contrasts with these works in that training is done in a strictly supervised fashion via a per utterance token generative process, and the model does not need dialogue state trackers, relying instead on latent neural embeddings for accurate system response generation.\nResearch in task-oriented dialogue often struggles with a lack of standard, publicly available datasets. Several classical corpora have consisted of moderately-sized collections of dialogues related to travel-booking (Hemphill et al., 1990; Bennett and Rudnicky, 2002). Another wellknown corpus is derived from a series of competitions on the task of dialogue-state tracking\n(Williams et al., 2013). While the competitions were designed to test systems for state tracking, recent work has chosen to repurpose this data by only using the transcripts of dialogues without state annotation for developing systems (Bordes and Weston, 2016; Williams et al., 2017). More recently, Maluuba has released a dataset of hotel and travel-booking dialogues collected in a Wizard-ofOz Scheme with elaborate semantic frames annotated (Asri et al., 2017). This dataset aims to encourage research in non-linear decision-making processes that are present in task-oriented dialogues."
    }, {
      "heading" : "5 Experiments",
      "text" : ""
    }, {
      "heading" : "5.1 Details",
      "text" : "For our experiments, we divided the dialogues into train/validation/test sets using a 0.8/0.1/0.1 data split and ensured that each domain type was equally represented in each of the splits.\nTo reduce lexical variability, in a pre-processing step, we map the variant surface expression of entities to a canonical form using named entity recognition and linking. For example, the surface form 20 Main Street is mapped to Pizza My Heart address. During inference, our model outputs the canonical forms of the entities, and so we realize their surface forms by running the system output through an inverse lexicon. The inverse lexicon converts the entities back to their surface forms by sampling from a multinomial distribution with parameters of the distribution equal to the frequency count of a given surface form for an entity as observed in the training and validation data."
    }, {
      "heading" : "5.2 Hyperparameters",
      "text" : "We trained using a cross-entropy loss and the Adam optimizer (Kingma and Ba, 2015) with learning rates sampled from the interval [10−4, 10−3]. We applied dropout (Hinton et al., 2012) as a regularizer to the input and output of the LSTM. We also added an l2 regularization penalty on the weights of the model. We identified hyperparameters by random search, evaluating on the held-out validation subset of the data. Dropout keep rates were sampled from [0.8, 0.9] and the l2 coefficient was sampled from [3 · 10−6, 10−5]. We used word embeddings, hidden layer, and cell sizes with size 200. We applied gradient clipping with a clip-value of 10 to avoid gradient explosions during training. The attention, output param-\neters, word embeddings, and LSTM weights were randomly initialized from a uniform unit-scaled distribution in the style of (Sussillo and Abbott, 2015). We also added a bias of 1 to the LSTM cell forget gate in the style of (Pham et al., 2014)."
    }, {
      "heading" : "5.3 Baseline Models",
      "text" : "We provide several baseline models for comparing performance of the Key-Value Retrieval Network:\n• Rule-Based Model: This model is a traditional heuristic system with modular dialogue state trackers, KB query, and natural language generation components. It first does an extensive domain-dependent keyword search in the user utterances to detect intent. The user utterances are also provided to a lexicon to extract any entities mentioned. Collectively, this information forms the dialogue state up to a given point in the dialogue. This dialogue state is used to query the KB as appropriate, and the returned KB values are used to fill in predefined template system responses.\n• Copy-Augmented Sequence-to-Sequence Network: This model is derived from the work of (Eric and Manning, 2017). It augments a sequence-to-sequence architecture with encoder attention, with an additional attention-based hard-copy mechanism over the KB entities mentioned in the encoder context. This model does not explicitly incorporate information from the underlying KB and instead relies solely on dialogue history for system response generation. Unlike the best performing model of (Eric and Manning, 2017), we do not enhance the inputs to the encoder with additional entity type features, as we found that the model performed worse on our data with this added mechanism. We choose this model for comparison as it is also end-to-end trainable and implicitly models dialogue state through learned neural representations. It has also been shown to be a competitive task-oriented dialogue baseline. We refer to this model as Copy Net in the results tables."
    }, {
      "heading" : "5.4 Automatic Evaluation",
      "text" : ""
    }, {
      "heading" : "5.4.1 Metrics",
      "text" : "Though prior work has shown that automatic evaluation metrics often correlate poorly with human\nassessments of dialogue agents (Liu et al., 2016), we report a number of automatic metrics in Table 3. These metrics are provided for coarse-grained evaluation of dialogue response quality:\n• BLEU: We use the BLEU metric, commonly employed in evaluating machine translation systems (Papineni et al., 2002), which has also been used in past literature for evaluating dialogue systems (Ritter et al., 2011; Li et al., 2016). We calculate average BLEU score over all responses generated by the system, and primarily report these scores to gauge our model’s ability to accurately generate the language patterns seen in our data.\n• Entity F1: Each human Turker’s Car Assistant response in the test data defines a gold set of entities. To compute an entity F1, we micro-average over the entire set of system dialogue responses. This metric evaluates the model’s ability to generate relevant entities from the underlying knowledge base and to capture the semantics of the user-initiated dialogue flow. Given that our test set contains dialogues from all three domains, we compute a per-domain entity F1 as well as an aggregated dataset entity F1."
    }, {
      "heading" : "5.4.2 Results",
      "text" : "We see that of our baseline models, Copy Net has the lowest aggregate entity F1 performance. Though it has the highest model entity F1 for the weather domain dialogues, it performs very poorly in the other domains, indicating its inability to generalize well to multiple dialogue domains and to accurately integrate relevant entities into its responses. Copy Net does, however, have the second highest BLEU score, which is not surprising given that the model is a powerful extension to the sequence-to-sequence modelling class, which\nis known to have very robust language modelling capabilities.\nOur rule-based model has the lowest BLEU score, which is a consequence of the fact that the naturalness of the system output is very limited by the number of diverse and distinct response templates we manually provided. This is a common issue with heuristic dialogue agents. However, the rule-based system has a very competitive aggregate entity F1. This is because it was designed to accurately parse the semantics of user utterances and query the underlying KB of the dialogue.\nAs precursors to our key-value retrieval net, we first report results of a model that does not compute an attention over the KB (referred to as Attn. Seq2Seq) and show that without computing attention over the KB, the model performs poorly in entity F1 as its output is agnostic to the world state represented in the KB. Note that this model is effectively a sequence-to-sequence model with encoder attention. If we include an attention over the KB but do not compute an encoder attention (referred to as KV Retrieval Net no enc. attn.), the entity F1 increases drastically, showing that the model is able to incorporate relevant entities from the KB. Finally, we combine these two attention mechanisms to get our final key-value retrieval net. Our proposed key-value retrieval net has the highest modelling performance in BLEU, aggregate entity F1, and entity F1 for the scheduling and navigation domains. It outperforms the rule-based aggregate entity F1 by 4.2% and outperforms the Copy Net BLEU score by 2.2 points as well as its entity F1 by 11%.\nWe also report human performance on the provided metrics. These scores were computed by taking the dialogues of the test set and having a second distinct batch of Amazon Mechanical Turk workers provide system responses given prior dialogue context. This, in effect, functions as an\ninterannotator agreement score and sets a human upper bound on model performance. We see that there is a sizable gap between human performance on entity F1 and that of our key-value retrieval net (∼ 12.7%), though our model is on par with human performance in BLEU score."
    }, {
      "heading" : "5.5 Human Evaluation",
      "text" : "We randomly generated 120 distinct scenarios across the three dialogue domains, where a scenario is defined by an underlying KB as well as a user goal for the dialogue (e.g. find the nearest gas station, avoiding heavy traffic). We then paired Amazon Mechanical Turkers with one of our systems in a real-time chat environment, where each Turker played the role of the Driver. We evaluated the rule-based model, Copy Net, and key-value retrieval network on each of the 120 scenarios. We also paired a Turker with another Turker for each of the scenarios, in order to get evaluations of human performance. At the end of the chat, the Turker was asked to judge the quality of their partner according to fluency, cooperativeness, and humanlikeness on a scale from 1 to 5. The average scores per pairing are reported in Table 4.\nWe see that the key-value retrieval network outperforms the baseline models on all of the metrics, with especially sizeable performance gains over the Copy Net which is the only other recurrent neural model evaluated. We also see that human performance on this assessment sets the upper bound on scores, as expected. Examples of dialogues conducted between our model and Turkers are included in Figure 3. Particularly noteworthy is our model’s ability to seamlessly integrate world information from the underlying KBs in the respective dialogues, while still producing very naturalistic utterances. The model is able to do this effectively across multiple domains."
    }, {
      "heading" : "6 Conclusion and Future Work",
      "text" : "In this work, we have presented a novel neural task-oriented dialogue model that is able to sustain grounded discourse across a variety of domains by retrieving world knowledge represented\nin knowledge bases. It smoothly incorporates this world knowledge into natural-sounding system responses in an end-to-end trainable fashion, without the need to explicitly model dialogue state. Our model outperforms competitive heuristic and neural baselines on both automatic and human evaluation metrics. In addition, we have introduced a publicly available dialogue dataset across three domains in the in-car personal assistant space that we hope will help the data scarcity issue present in task-oriented dialogue research.\nFuture work will address closing the margin between the Key-Value Retrieval Network and human performance on the various metrics. This will include developing new methods for robust handling of joint KB attributes as well as usage of the KB that requires more pragmatic understanding of the world via notions such as temporal reasoning."
    } ],
    "references" : [ {
      "title" : "Frames: A corpus for adding memory to goal-oriented dialogue systems",
      "author" : [ "L. El Asri", "H. Schulz", "S. Sharma", "J. Zumer", "J. Harris", "E. Fine", "R. Mehrotra", "K. Suleman." ],
      "venue" : "http://www.maluuba.com/publications/ .",
      "citeRegEx" : "Asri et al\\.,? 2017",
      "shortCiteRegEx" : "Asri et al\\.",
      "year" : 2017
    }, {
      "title" : "Neural machine translation by jointly learning to align and translate",
      "author" : [ "Dzimitry Bahdanau", "Kyunghyun Cho", "Yoshua Bengio." ],
      "venue" : "International Conference on Learning Representations (ICLR2015).",
      "citeRegEx" : "Bahdanau et al\\.,? 2015",
      "shortCiteRegEx" : "Bahdanau et al\\.",
      "year" : 2015
    }, {
      "title" : "The carnegie mellon communicator corpus",
      "author" : [ "Christina Bennett", "Alexander I. Rudnicky." ],
      "venue" : "ICSLP.",
      "citeRegEx" : "Bennett and Rudnicky.,? 2002",
      "shortCiteRegEx" : "Bennett and Rudnicky.",
      "year" : 2002
    }, {
      "title" : "Learning end-to-end goal-oriented dialog",
      "author" : [ "Antoine Bordes", "Jason Weston." ],
      "venue" : "arXiv preprint arXiv:1605.07683 .",
      "citeRegEx" : "Bordes and Weston.,? 2016",
      "shortCiteRegEx" : "Bordes and Weston.",
      "year" : 2016
    }, {
      "title" : "End-to-end reinforcement learning of dialogue agents for information access",
      "author" : [ "Bhuwan Dhingra", "Lihong Li", "Xiujun Li", "Jianfeng Gao", "Yun-Nung Chen", "Faisal Ahmed", "Li Deng." ],
      "venue" : "arXiv preprint arXiv:1609.00777 .",
      "citeRegEx" : "Dhingra et al\\.,? 2016",
      "shortCiteRegEx" : "Dhingra et al\\.",
      "year" : 2016
    }, {
      "title" : "A copyaugmented sequence-to-sequence architecture gives good performance on task-oriented dialogue",
      "author" : [ "Mihail Eric", "Christopher Manning." ],
      "venue" : "Proceedings of the 15th Conference of the European Chapter of the Association for Computa-",
      "citeRegEx" : "Eric and Manning.,? 2017",
      "shortCiteRegEx" : "Eric and Manning.",
      "year" : 2017
    }, {
      "title" : "Incorporating copying mechanism in sequence-to-sequence learning",
      "author" : [ "Jiatao Gu", "Zhengdong Lu", "Hang Li", "Victor O.K. Li." ],
      "venue" : "Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics (Volume",
      "citeRegEx" : "Gu et al\\.,? 2016",
      "shortCiteRegEx" : "Gu et al\\.",
      "year" : 2016
    }, {
      "title" : "Pointing the unknown words",
      "author" : [ "Caglar Gulcehre", "Sungjin Ahn", "Ramesh Nallapati", "Bowen Zhou", "Yoshua Bengio." ],
      "venue" : "Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics (Volume",
      "citeRegEx" : "Gulcehre et al\\.,? 2016",
      "shortCiteRegEx" : "Gulcehre et al\\.",
      "year" : 2016
    }, {
      "title" : "The atis spoken language systems pilot corpus",
      "author" : [ "C.T. Hemphill", "J.J. Godfrey", "G.R. Doddington." ],
      "venue" : "Proceedings of the DARPA speech and natural language workshop.",
      "citeRegEx" : "Hemphill et al\\.,? 1990",
      "shortCiteRegEx" : "Hemphill et al\\.",
      "year" : 1990
    }, {
      "title" : "Word-based dialog state tracking with recurrent neural networks",
      "author" : [ "Matthew Henderson", "Blaise Thomson", "Steve Young." ],
      "venue" : "Proceedings of the SIGDIAL 2014 Conference.",
      "citeRegEx" : "Henderson et al\\.,? 2014",
      "shortCiteRegEx" : "Henderson et al\\.",
      "year" : 2014
    }, {
      "title" : "Improving neural networks by preventing co-adaptation of feature detectors",
      "author" : [ "Geoffrey E. Hinton", "Nitish Srivastava", "Alex Krizhevsky", "Ilya Sutskever", "Ruslan R. Salakhutdinov." ],
      "venue" : "arXiv preprint arXiv:1207.0580 .",
      "citeRegEx" : "Hinton et al\\.,? 2012",
      "shortCiteRegEx" : "Hinton et al\\.",
      "year" : 2012
    }, {
      "title" : "Long short-term memory",
      "author" : [ "Sepp Hochreiter", "Jurgen Schmidhuber." ],
      "venue" : "Neural Computation pages 1735–1780.",
      "citeRegEx" : "Hochreiter and Schmidhuber.,? 1997",
      "shortCiteRegEx" : "Hochreiter and Schmidhuber.",
      "year" : 1997
    }, {
      "title" : "Data recombination for neural semantic parsing",
      "author" : [ "Robin Jia", "Percy Liang." ],
      "venue" : "Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers). Association for Computa-",
      "citeRegEx" : "Jia and Liang.,? 2016",
      "shortCiteRegEx" : "Jia and Liang.",
      "year" : 2016
    }, {
      "title" : "Smart reply: Automated response suggestion for email",
      "author" : [ "Anjuli Kannan", "Karol Kurach", "Sujith Ravi", "Tobias Kaufman", "Balint Miklos", "Greg Corrado", "Andrew Tomkins", "Laszlo Lukacs", "Marina Ganea", "Peter Young", "Vivek Ramavajjala" ],
      "venue" : null,
      "citeRegEx" : "Kannan et al\\.,? \\Q2016\\E",
      "shortCiteRegEx" : "Kannan et al\\.",
      "year" : 2016
    }, {
      "title" : "Adam: a method for stochastic optimization",
      "author" : [ "Diederik Kingma", "Jimmy Ba." ],
      "venue" : "International Conference on Learning Representations (ICLR2015).",
      "citeRegEx" : "Kingma and Ba.,? 2015",
      "shortCiteRegEx" : "Kingma and Ba.",
      "year" : 2015
    }, {
      "title" : "A diversity-promoting objective function for neural conversation models",
      "author" : [ "Jiwei Li", "Michel Galley", "Chris Brockett", "Jianfeng Gao", "Bill Dolan." ],
      "venue" : "Proceedings of the 2016 Conference of the North American Chapter of the Association",
      "citeRegEx" : "Li et al\\.,? 2016",
      "shortCiteRegEx" : "Li et al\\.",
      "year" : 2016
    }, {
      "title" : "Latent predictor networks for code generation",
      "author" : [ "Wang Ling", "Phil Blunsom", "Edward Grefenstette", "Karl Moritz Hermann", "Tomáš Kočiský", "Fumin Wang", "Andrew Senior." ],
      "venue" : "Proceedings of the 54th Annual Meeting of the As-",
      "citeRegEx" : "Ling et al\\.,? 2016",
      "shortCiteRegEx" : "Ling et al\\.",
      "year" : 2016
    }, {
      "title" : "How not to evaluate your dialogue system: An empirical study of unsupervised evaluation metrics for dialogue response generation",
      "author" : [ "Chia-Wei Liu", "Ryan Lowe", "Iulian Serban", "Mike Noseworthy", "Laurent Charlin", "Joelle Pineau." ],
      "venue" : "Proceedings of",
      "citeRegEx" : "Liu et al\\.,? 2016",
      "shortCiteRegEx" : "Liu et al\\.",
      "year" : 2016
    }, {
      "title" : "Gated endto-end memory networks",
      "author" : [ "Fei Liu", "Julien Perez." ],
      "venue" : "arXiv preprint arXiv:1610.04211 .",
      "citeRegEx" : "Liu and Perez.,? 2016",
      "shortCiteRegEx" : "Liu and Perez.",
      "year" : 2016
    }, {
      "title" : "Effective approaches to attentionbased neural machine translation",
      "author" : [ "Minh-Thang Luong", "Hieu Pham", "Christopher D. Manning." ],
      "venue" : "Empirical Methods in Natural Language Processing pages 1412– 1421.",
      "citeRegEx" : "Luong et al\\.,? 2015a",
      "shortCiteRegEx" : "Luong et al\\.",
      "year" : 2015
    }, {
      "title" : "Key-value memory networks for directly reading documents",
      "author" : [ "Alexander Miller", "Adam Fisch", "Jesse Dodge", "AmirHossein Karimi", "Antoine Bordes", "Jason Weston." ],
      "venue" : "Proceedings of the 2016 Conference on Empirical Methods in Natu-",
      "citeRegEx" : "Miller et al\\.,? 2016",
      "shortCiteRegEx" : "Miller et al\\.",
      "year" : 2016
    }, {
      "title" : "Bleu: a method for automatic evaluation of machine translation",
      "author" : [ "Kishore Papineni", "Salim Roukos", "Todd Ward", "Wei-Jing Zhu." ],
      "venue" : "Proceedings of 40th Annual Meeting of the Association for Computational Linguis-",
      "citeRegEx" : "Papineni et al\\.,? 2002",
      "shortCiteRegEx" : "Papineni et al\\.",
      "year" : 2002
    }, {
      "title" : "Dropout improves recurrent neural networks for handwriting recognition",
      "author" : [ "Vu Pham", "Theodore Bluche", "Christopher Kermorvant", "Jerome Louradour." ],
      "venue" : "arXiv preprint arXiv:1312.4569v2 .",
      "citeRegEx" : "Pham et al\\.,? 2014",
      "shortCiteRegEx" : "Pham et al\\.",
      "year" : 2014
    }, {
      "title" : "Data-driven response generation in social media",
      "author" : [ "Alan Ritter", "Colin Cherry", "William B. Dolan." ],
      "venue" : "Empirical Methods in Natural Language Processing pages 583–593.",
      "citeRegEx" : "Ritter et al\\.,? 2011",
      "shortCiteRegEx" : "Ritter et al\\.",
      "year" : 2011
    }, {
      "title" : "Random walk initialization for training very deep feed forward networks",
      "author" : [ "David Sussillo", "L.F. Abbott." ],
      "venue" : "arXiv preprint arXiv:1412.6558 .",
      "citeRegEx" : "Sussillo and Abbott.,? 2015",
      "shortCiteRegEx" : "Sussillo and Abbott.",
      "year" : 2015
    }, {
      "title" : "Sequence to sequence learning with neural networks",
      "author" : [ "Ilya Sutskever", "Oriol Vinyals", "Quoc V Le." ],
      "venue" : "Z. Ghahramani, M. Welling, C. Cortes, N. D. Lawrence, and K. Q. Weinberger, editors, Advances in Neural Information Processing Sys-",
      "citeRegEx" : "Sutskever et al\\.,? 2014",
      "shortCiteRegEx" : "Sutskever et al\\.",
      "year" : 2014
    }, {
      "title" : "Grammar as a foreign language",
      "author" : [ "Oriol Vinyals", "Ł ukasz Kaiser", "Terry Koo", "Slav Petrov", "Ilya Sutskever", "Geoffrey Hinton." ],
      "venue" : "C. Cortes, N. D. Lawrence, D. D. Lee, M. Sugiyama, and R. Garnett, editors, Advances in Neural Information Processing",
      "citeRegEx" : "Vinyals et al\\.,? 2015",
      "shortCiteRegEx" : "Vinyals et al\\.",
      "year" : 2015
    }, {
      "title" : "A network-based end-to-end trainable task-oriented dialogue system",
      "author" : [ "Tsung-Hsien Wen", "David Vandyke", "Milica Gasic", "Nikola Mrksic", "Lina. M. Rojas-Barahona", "Pei-Hao Su", "Stefan Ultes", "Steve Young." ],
      "venue" : "arXiv preprint arXiv:1604.04562 .",
      "citeRegEx" : "Wen et al\\.,? 2016b",
      "shortCiteRegEx" : "Wen et al\\.",
      "year" : 2016
    }, {
      "title" : "Hybrid code networks: practical",
      "author" : [ "Jason D. Williams", "Kavosh Asadi", "Geoffrey Zweig" ],
      "venue" : null,
      "citeRegEx" : "Williams et al\\.,? \\Q2017\\E",
      "shortCiteRegEx" : "Williams et al\\.",
      "year" : 2017
    }, {
      "title" : "The dialog state tracking challenge",
      "author" : [ "Jason D. Williams", "Antoine Raux", "Deepak Ramachadran", "Alan Black." ],
      "venue" : "Proceedings of the SIGDIAL. Metz, France.",
      "citeRegEx" : "Williams et al\\.,? 2013",
      "shortCiteRegEx" : "Williams et al\\.",
      "year" : 2013
    }, {
      "title" : "POMDP-based statistical spoken dialog systems: a review",
      "author" : [ "Steve Young", "Milica Gasic", "Blaise Thomson", "Jason D. Williams." ],
      "venue" : "Proceedings of the IEEE 28(1):114–133.",
      "citeRegEx" : "Young et al\\.,? 2013",
      "shortCiteRegEx" : "Young et al\\.",
      "year" : 2013
    } ],
    "referenceMentions" : [ {
      "referenceID" : 3,
      "context" : "Neural dialogue agents present one of the most promising avenues for leveraging dialogue corpora to build statistical models directly from data by using powerful distributed representations (Bordes and Weston, 2016; Wen et al., 2016b; Dhingra et al., 2016).",
      "startOffset" : 190,
      "endOffset" : 256
    }, {
      "referenceID" : 27,
      "context" : "Neural dialogue agents present one of the most promising avenues for leveraging dialogue corpora to build statistical models directly from data by using powerful distributed representations (Bordes and Weston, 2016; Wen et al., 2016b; Dhingra et al., 2016).",
      "startOffset" : 190,
      "endOffset" : 256
    }, {
      "referenceID" : 4,
      "context" : "Neural dialogue agents present one of the most promising avenues for leveraging dialogue corpora to build statistical models directly from data by using powerful distributed representations (Bordes and Weston, 2016; Wen et al., 2016b; Dhingra et al., 2016).",
      "startOffset" : 190,
      "endOffset" : 256
    }, {
      "referenceID" : 20,
      "context" : "rent network architectures with an attention-based key-value retrieval mechanism over the entries of a knowledge base, which is inspired by recent work on key-value memory networks (Miller et al., 2016).",
      "startOffset" : 181,
      "endOffset" : 202
    }, {
      "referenceID" : 13,
      "context" : "Unlike other dialogue agents which only rely on prior dialogue history for generation (Kannan et al., 2016; Eric and Manning, 2017), our architecture is able to access and use database-style information, while still retaining the text generation advantages of recent neural models.",
      "startOffset" : 86,
      "endOffset" : 131
    }, {
      "referenceID" : 5,
      "context" : "Unlike other dialogue agents which only rely on prior dialogue history for generation (Kannan et al., 2016; Eric and Manning, 2017), our architecture is able to access and use database-style information, while still retaining the text generation advantages of recent neural models.",
      "startOffset" : 86,
      "endOffset" : 131
    }, {
      "referenceID" : 27,
      "context" : "user intent trackers (Wen et al., 2016b; Dhingra et al., 2016; Henderson et al., 2014), we choose instead to rely on learned neural representations for implicit modelling of dialogue state, forming a truly end-to-end trainable system.",
      "startOffset" : 21,
      "endOffset" : 86
    }, {
      "referenceID" : 4,
      "context" : "user intent trackers (Wen et al., 2016b; Dhingra et al., 2016; Henderson et al., 2014), we choose instead to rely on learned neural representations for implicit modelling of dialogue state, forming a truly end-to-end trainable system.",
      "startOffset" : 21,
      "endOffset" : 86
    }, {
      "referenceID" : 9,
      "context" : "user intent trackers (Wen et al., 2016b; Dhingra et al., 2016; Henderson et al., 2014), we choose instead to rely on learned neural representations for implicit modelling of dialogue state, forming a truly end-to-end trainable system.",
      "startOffset" : 21,
      "endOffset" : 86
    }, {
      "referenceID" : 11,
      "context" : "ory unit, as described by (Hochreiter and Schmidhuber, 1997).",
      "startOffset" : 26,
      "endOffset" : 60
    }, {
      "referenceID" : 1,
      "context" : "We extend this decoder with an attentionbased model (Bahdanau et al., 2015; Luong et al., 2015a), where, at every time step t of the decoding, an attention score ai is computed for each hidden state hi of the encoder, using the attention mechanism of (Vinyals et al.",
      "startOffset" : 52,
      "endOffset" : 96
    }, {
      "referenceID" : 19,
      "context" : "We extend this decoder with an attentionbased model (Bahdanau et al., 2015; Luong et al., 2015a), where, at every time step t of the decoding, an attention score ai is computed for each hidden state hi of the encoder, using the attention mechanism of (Vinyals et al.",
      "startOffset" : 52,
      "endOffset" : 96
    }, {
      "referenceID" : 26,
      "context" : ", 2015a), where, at every time step t of the decoding, an attention score ai is computed for each hidden state hi of the encoder, using the attention mechanism of (Vinyals et al., 2015).",
      "startOffset" : 163,
      "endOffset" : 185
    }, {
      "referenceID" : 4,
      "context" : ", 2016b), or 2) softly attend to the KB and combine this probability distribution with belief trackers as state input for a reinforcement learning policy (Dhingra et al., 2016).",
      "startOffset" : 154,
      "endOffset" : 176
    }, {
      "referenceID" : 20,
      "context" : "For storing the KB of a given dialogue, we take inspiration from the work of (Miller et al., 2016) which found that a key-value structured memory allowed for efficient machine reading of documents.",
      "startOffset" : 77,
      "endOffset" : 98
    }, {
      "referenceID" : 12,
      "context" : "Recent literature has shown that incorporating a copying mechanism into neural architectures improves performance on various sequenceto-sequence tasks (Jia and Liang, 2016; Gu et al., 2016; Ling et al., 2016; Gulcehre et al., 2016; Eric and Manning, 2017).",
      "startOffset" : 151,
      "endOffset" : 255
    }, {
      "referenceID" : 6,
      "context" : "Recent literature has shown that incorporating a copying mechanism into neural architectures improves performance on various sequenceto-sequence tasks (Jia and Liang, 2016; Gu et al., 2016; Ling et al., 2016; Gulcehre et al., 2016; Eric and Manning, 2017).",
      "startOffset" : 151,
      "endOffset" : 255
    }, {
      "referenceID" : 16,
      "context" : "Recent literature has shown that incorporating a copying mechanism into neural architectures improves performance on various sequenceto-sequence tasks (Jia and Liang, 2016; Gu et al., 2016; Ling et al., 2016; Gulcehre et al., 2016; Eric and Manning, 2017).",
      "startOffset" : 151,
      "endOffset" : 255
    }, {
      "referenceID" : 7,
      "context" : "Recent literature has shown that incorporating a copying mechanism into neural architectures improves performance on various sequenceto-sequence tasks (Jia and Liang, 2016; Gu et al., 2016; Ling et al., 2016; Gulcehre et al., 2016; Eric and Manning, 2017).",
      "startOffset" : 151,
      "endOffset" : 255
    }, {
      "referenceID" : 5,
      "context" : "Recent literature has shown that incorporating a copying mechanism into neural architectures improves performance on various sequenceto-sequence tasks (Jia and Liang, 2016; Gu et al., 2016; Ling et al., 2016; Gulcehre et al., 2016; Eric and Manning, 2017).",
      "startOffset" : 151,
      "endOffset" : 255
    }, {
      "referenceID" : 27,
      "context" : "The data for the multi-turn dialogues was collected using a Wizard-of-Oz scheme inspired by that of (Wen et al., 2016b).",
      "startOffset" : 100,
      "endOffset" : 119
    }, {
      "referenceID" : 30,
      "context" : "One line of work by (Young et al., 2013) has tackled the problem using partially observable Markov decision processes and reinforcement",
      "startOffset" : 20,
      "endOffset" : 40
    }, {
      "referenceID" : 1,
      "context" : "The recent successes of neural architectures on a number of traditional natural language processing subtasks (Bahdanau et al., 2015; Sutskever et al., 2014; Vinyals et al., 2015) have motivated investigation into dialogue agents that can",
      "startOffset" : 109,
      "endOffset" : 178
    }, {
      "referenceID" : 25,
      "context" : "The recent successes of neural architectures on a number of traditional natural language processing subtasks (Bahdanau et al., 2015; Sutskever et al., 2014; Vinyals et al., 2015) have motivated investigation into dialogue agents that can",
      "startOffset" : 109,
      "endOffset" : 178
    }, {
      "referenceID" : 26,
      "context" : "The recent successes of neural architectures on a number of traditional natural language processing subtasks (Bahdanau et al., 2015; Sutskever et al., 2014; Vinyals et al., 2015) have motivated investigation into dialogue agents that can",
      "startOffset" : 109,
      "endOffset" : 178
    }, {
      "referenceID" : 27,
      "context" : "Recent work by (Wen et al., 2016b) has built systems with modularly-connected representation, belief state,",
      "startOffset" : 15,
      "endOffset" : 34
    }, {
      "referenceID" : 3,
      "context" : "Other work by (Bordes and Weston, 2016; Liu and Perez, 2016) stores dialogue context in a",
      "startOffset" : 14,
      "endOffset" : 60
    }, {
      "referenceID" : 18,
      "context" : "Other work by (Bordes and Weston, 2016; Liu and Perez, 2016) stores dialogue context in a",
      "startOffset" : 14,
      "endOffset" : 60
    }, {
      "referenceID" : 28,
      "context" : "oriented models which are amenable to both supervised learning and reinforcement learning and are able to incorporate domain-specific knowledge via explicitly-provided features and model-output restrictions (Williams et al., 2017).",
      "startOffset" : 207,
      "endOffset" : 230
    }, {
      "referenceID" : 8,
      "context" : "Several classical corpora have consisted of moderately-sized collections of dialogues related to travel-booking (Hemphill et al., 1990; Bennett and Rudnicky, 2002).",
      "startOffset" : 112,
      "endOffset" : 163
    }, {
      "referenceID" : 2,
      "context" : "Several classical corpora have consisted of moderately-sized collections of dialogues related to travel-booking (Hemphill et al., 1990; Bennett and Rudnicky, 2002).",
      "startOffset" : 112,
      "endOffset" : 163
    }, {
      "referenceID" : 29,
      "context" : "(Williams et al., 2013).",
      "startOffset" : 0,
      "endOffset" : 23
    }, {
      "referenceID" : 3,
      "context" : "were designed to test systems for state tracking, recent work has chosen to repurpose this data by only using the transcripts of dialogues without state annotation for developing systems (Bordes and Weston, 2016; Williams et al., 2017).",
      "startOffset" : 187,
      "endOffset" : 235
    }, {
      "referenceID" : 28,
      "context" : "were designed to test systems for state tracking, recent work has chosen to repurpose this data by only using the transcripts of dialogues without state annotation for developing systems (Bordes and Weston, 2016; Williams et al., 2017).",
      "startOffset" : 187,
      "endOffset" : 235
    }, {
      "referenceID" : 0,
      "context" : "travel-booking dialogues collected in a Wizard-ofOz Scheme with elaborate semantic frames annotated (Asri et al., 2017).",
      "startOffset" : 100,
      "endOffset" : 119
    }, {
      "referenceID" : 14,
      "context" : "We trained using a cross-entropy loss and the Adam optimizer (Kingma and Ba, 2015) with learning rates sampled from the interval [10−4, 10−3].",
      "startOffset" : 61,
      "endOffset" : 82
    }, {
      "referenceID" : 10,
      "context" : "We applied dropout (Hinton et al., 2012) as a regularizer to the input and output of the LSTM.",
      "startOffset" : 19,
      "endOffset" : 40
    }, {
      "referenceID" : 24,
      "context" : "distribution in the style of (Sussillo and Abbott, 2015).",
      "startOffset" : 29,
      "endOffset" : 56
    }, {
      "referenceID" : 22,
      "context" : "We also added a bias of 1 to the LSTM cell forget gate in the style of (Pham et al., 2014).",
      "startOffset" : 71,
      "endOffset" : 90
    }, {
      "referenceID" : 5,
      "context" : "• Copy-Augmented Sequence-to-Sequence Network: This model is derived from the work of (Eric and Manning, 2017).",
      "startOffset" : 86,
      "endOffset" : 110
    }, {
      "referenceID" : 5,
      "context" : "Unlike the best performing model of (Eric and Manning, 2017), we do not enhance the inputs to the encoder with additional entity type features, as we found that the model performed worse on our data with this",
      "startOffset" : 36,
      "endOffset" : 60
    }, {
      "referenceID" : 17,
      "context" : "assessments of dialogue agents (Liu et al., 2016), we report a number of automatic metrics in Table 3.",
      "startOffset" : 31,
      "endOffset" : 49
    }, {
      "referenceID" : 21,
      "context" : "• BLEU: We use the BLEU metric, commonly employed in evaluating machine translation systems (Papineni et al., 2002), which has also been used in past literature for evaluating dialogue systems (Ritter et al.",
      "startOffset" : 92,
      "endOffset" : 115
    } ],
    "year" : 2017,
    "abstractText" : "Neural task-oriented dialogue systems often struggle to smoothly interface with a knowledge base. In this work, we seek to address this problem by proposing a new neural dialogue agent that is able to effectively sustain grounded, multi-domain discourse through a novel key-value retrieval mechanism. The model is end-to-end differentiable and does not need to explicitly model dialogue state or belief trackers. We also release a new dataset of 3,031 dialogues that are grounded through underlying knowledge bases and span three distinct tasks in the in-car personal assistant space: calendar scheduling, weather information retrieval, and point-of-interest navigation. Our architecture is simultaneously trained on data from all domains and significantly outperforms a competitive rulebased system and other existing neural dialogue architectures on the provided domains according to both automatic and human evaluation metrics.",
    "creator" : "LaTeX with hyperref package"
  }
}